==== spawn @ 2026-02-08T07:15:25.847Z ====
cmd: codex "exec" "--cd" "/Users/johnlindquist/dev/script-kit-gpui" "--model" "gpt-5.3-codex" "-c" "model_reasoning_effort=\"xhigh\"" "-c" "model_auto_compact_token_limit=120000" "-c" "developer_instructions=\"You are Codex implementer agent \\\"codex-footer-button-style\\\".\\n\\n## Coordination\\nThis repo runs parallel agents in ONE working tree. Before editing any file, you MUST claim it.\\nCommands (run via shell):\\n  - View roster: ~/.claude/bin/swarm.ts status\\n  - Claim files (blocks until free): ~/.claude/bin/swarm.ts claim --wait --id codex-footer-button-style path/to/file\\n  - Release: ~/.claude/bin/swarm.ts release --id codex-footer-button-style path/to/file\\n  - Update status/notes: ~/.claude/bin/swarm.ts update --id codex-footer-button-style --status in_progress --notes \\\"...\\\"\\nRules:\\n  - Never edit a file you haven't claimed.\\n  - Keep claims tight (claim only what you're actively changing).\\n  - If blocked, set status=blocked and say what you're waiting on.\\n  - When finished, set status=done and release claims.\\n\\n## Development practices (this code is maintained by AI agents)\\n  - Log state transitions with enough context to diagnose failures from logs alone.\\n  - Structured errors: include what was attempted, what failed, and current state.\\n  - Name things for grepability — unique identifiers agents can find on the first search.\\n  - Every behavior change gets a test. Untested code is invisible to the next agent.\\n  - Test names describe the scenario: test_X_does_Y_when_Z.\\n  - Keep functions small and single-purpose. 500-line functions burn agent context.\\n  - Use types to encode constraints (enums > strings for errors).\\n\\n## CRITICAL: Parallel-safe verification\\n  - Other agents are modifying other files RIGHT NOW. Full test suites WILL show their failures.\\n  - ONLY run tests that cover YOUR changed files. Scope every test/check command:\\n    Rust: cargo test -p your-crate -- module::test_name | JS: npx jest your/file.test.ts\\n  - Do NOT run: cargo test (unscoped), cargo check (whole workspace), npm test (unscoped).\\n  - If a scoped test fails, it's YOUR bug — fix it. If tests outside your scope fail, ignore them.\\n\\n## Git commit discipline\\n  - NEVER commit unverified work. Run tests/lints/type-checks FIRST. If it fails, fix it before committing.\\n  - A commit is a declaration: \\\"this works and here's the proof.\\\"\\n  - Commit FREQUENTLY — after each meaningful unit of VERIFIED work, not just at the end.\\n  - A \\\"unit\\\" = one logical change that passes verification (new function, bug fix, refactor, test added).\\n  - NEVER batch an entire task into one giant commit. Small commits are searchable; big ones aren't.\\n  - Commit message format:\\n      Line 1: <type>(<scope>): <what changed> (imperative, max 72 chars)\\n      Line 3+: WHY this change was made, WHAT was verified, and HOW to test it.\\n    Types: feat, fix, refactor, test, docs, chore\\n    Example:\\n      feat(auth): add refresh token rotation\\n      \\n      Tokens now rotate on each refresh call to prevent replay attacks.\\n      The old token is invalidated immediately on rotation.\\n      \\n      Verified: cargo test --lib -- auth::refresh (4 tests pass)\\n      Verified: manual smoke test via curl — token rotates, old token returns 401\\n  - The \\\"Verified:\\\" lines are REQUIRED. Future agents will read git log to understand\\n    what was tested and how to re-verify. This is the most valuable part of the message.\\n  - In your final message, list all commits you made with their hashes.\\n\\n## Time budget\\nYou have approximately 10 minutes. If your task is too broad to complete in time:\\n(1) Commit any verified progress.\\n(2) Run: ~/.claude/bin/swarm.ts update --id YOUR_ID --status needs_split --notes 'suggest: 1) sub-task-desc scope:files 2) sub-task-desc scope:files'.\\n(3) Exit cleanly. The dispatcher will read your suggestions and spawn narrower workers.\"" "--output-last-message" "/Users/johnlindquist/dev/script-kit-gpui/.ai/logs/codex-footer-button-style.final.md" "--yolo" "You are agent codex-footer-button-style.\n\nCurrent parallel-agent roster (read this first):\n```\nSWARM SNAPSHOT @ 2026-02-08T07:15:25.844Z\n- codex-footer-button-style [starting] scope=src/prompts/chat/render_core.rs,src/prompts/chat/prompt.rs task=In the script generation ChatPrompt footer (src/prompts/chat/render_core.rs), the Save/Run/Save and Run buttons don't m…\n```\n\nYour assignment:\n- Task: In the script generation ChatPrompt footer (src/prompts/chat/render_core.rs), the Save/Run/Save and Run buttons don't match the footer style. Looking at the screenshot: the footer has styled buttons like 'Continue in Chat ⌘↵' and 'Actions ⌘K' with accent-colored text. The Save/Run/Save and Run buttons currently use a different bg/hover style. FIX: 1) Make Save/Run/Save and Run use the SAME style as the existing footer buttons (accent-colored text, no background, just text with optional keyboard shortcut hint). Use the render_footer_button helper or match its style. 2) Move 'Save and Run' to REPLACE 'Continue in Chat' in its position (right side of footer). 'Save and Run' should be the primary action button where 'Continue in Chat' normally sits. Keep Save and Run as separate smaller buttons on the left side near the model name. 3) When script_generation_mode is true, HIDE the 'Continue in Chat' button and show 'Save and Run' in its place. Run cargo check.\n- Scope: src/prompts/chat/render_core.rs,src/prompts/chat/prompt.rs\n\nOperating constraints:\n- Single working tree (no worktrees, no patches).\n- You MUST claim files before editing (~/.claude/bin/swarm.ts claim --wait ...).\n\nDeliverables:\n- Make the code changes required by the task.\n- Run the most relevant tests/linters.\n- In your FINAL message, include: changed files, how to test, and any risks/known gaps."

OpenAI Codex v0.98.0 (research preview)
--------
workdir: /Users/johnlindquist/dev/script-kit-gpui
model: gpt-5.3-codex
provider: openai
approval: never
sandbox: danger-full-access
reasoning effort: xhigh
reasoning summaries: auto
session id: 019c3c1a-fa1c-7350-833d-660116bbfb4d
--------
user
You are agent codex-footer-button-style.

Current parallel-agent roster (read this first):
```
SWARM SNAPSHOT @ 2026-02-08T07:15:25.844Z
- codex-footer-button-style [starting] scope=src/prompts/chat/render_core.rs,src/prompts/chat/prompt.rs task=In the script generation ChatPrompt footer (src/prompts/chat/render_core.rs), the Save/Run/Save and Run buttons don't m…
```

Your assignment:
- Task: In the script generation ChatPrompt footer (src/prompts/chat/render_core.rs), the Save/Run/Save and Run buttons don't match the footer style. Looking at the screenshot: the footer has styled buttons like 'Continue in Chat ⌘↵' and 'Actions ⌘K' with accent-colored text. The Save/Run/Save and Run buttons currently use a different bg/hover style. FIX: 1) Make Save/Run/Save and Run use the SAME style as the existing footer buttons (accent-colored text, no background, just text with optional keyboard shortcut hint). Use the render_footer_button helper or match its style. 2) Move 'Save and Run' to REPLACE 'Continue in Chat' in its position (right side of footer). 'Save and Run' should be the primary action button where 'Continue in Chat' normally sits. Keep Save and Run as separate smaller buttons on the left side near the model name. 3) When script_generation_mode is true, HIDE the 'Continue in Chat' button and show 'Save and Run' in its place. Run cargo check.
- Scope: src/prompts/chat/render_core.rs,src/prompts/chat/prompt.rs

Operating constraints:
- Single working tree (no worktrees, no patches).
- You MUST claim files before editing (~/.claude/bin/swarm.ts claim --wait ...).

Deliverables:
- Make the code changes required by the task.
- Run the most relevant tests/linters.
- In your FINAL message, include: changed files, how to test, and any risks/known gaps.
warning: Under-development features enabled: responses_websockets. Under-development features are incomplete and may behave unpredictably. To suppress this warning, set `suppress_unstable_features_warning = true` in /Users/johnlindquist/.codex/config.toml.
mcp: deepwiki starting
mcp: deepwiki ready
mcp startup: ready: deepwiki

thinking
**Resolving cargo check conflict**
codex
I’m taking the footer styling task for script-generation mode and will first sync swarm state, claim `src/prompts/chat/render_core.rs` and `src/prompts/chat/prompt.rs`, then inspect the current footer button rendering paths before editing.
exec
/bin/zsh -lc '~/.claude/bin/swarm.ts status' in /Users/johnlindquist/dev/script-kit-gpui succeeded in 51ms:
Repo: /Users/johnlindquist/dev/script-kit-gpui
Updated: 2026-02-08T07:15:46.302Z

Active agents (1):
codex-footer-button-style [in_progress] codex/gpt-5.3-codex/exec
  task: In the script generation ChatPrompt footer (src/prompts/chat/render_core.rs), the Save/Run/Save and Run buttons don't m…
  scope: src/prompts/chat/render_core.rs,src/prompts/chat/prompt.rs
  claims: (none)
  notes: spawned codex (exec)

Inactive agents (269):
- codex-accessibility [done] done. exit=0. final=.ai/logs/codex-accessibility.final.md. See final message file.
- codex-action-labels [failed] failed. exit=1. final=.ai/logs/codex-action-labels.final.md.
- codex-actions-audit [failed] failed. exit=1. final=.ai/logs/codex-actions-audit.final.md. See final message file.
- codex-actions-consistency [failed] failed. exit=1. final=.ai/logs/codex-actions-consistency.final.md.
- codex-actions-dialog [done] done. exit=0. final=.ai/logs/codex-actions-dialog.final.md. See final message file.
- codex-actions-feedback [failed] failed. exit=1. final=.ai/logs/codex-actions-feedback.final.md.
- codex-actions-feedback-v2 [done] done. exit=0. final=.ai/logs/codex-actions-feedback-v2.final.md. See final message file.
- codex-actions-ux [done] done. exit=0. final=.ai/logs/codex-actions-ux.final.md. See final message file.
- codex-agents-md [done] done. exit=0. final=.ai/logs/codex-agents-md.final.md. See final message file.
exec
/bin/zsh -lc '~/.claude/bin/swarm.ts update --id codex-footer-button-style --status in_progress --notes "Inspecting footer button rendering for script_generation_mode and preparing style/placement fix"' in /Users/johnlindquist/dev/script-kit-gpui succeeded in 123ms:
Updated: codex-footer-button-style
exec
/bin/zsh -lc '~/.claude/bin/swarm.ts claim --wait --id codex-footer-button-style src/prompts/chat/render_core.rs' in /Users/johnlindquist/dev/script-kit-gpui succeeded in 51ms:
Claimed for codex-footer-button-style: src/prompts/chat/render_core.rs
exec
/bin/zsh -lc '~/.claude/bin/swarm.ts claim --wait --id codex-footer-button-style src/prompts/chat/prompt.rs' in /Users/johnlindquist/dev/script-kit-gpui succeeded in 52ms:
Claimed for codex-footer-button-style: src/prompts/chat/prompt.rs

thinking
**Deciding skill usage**
codex
I’ve claimed both target files. Next I’m loading the `gpui-patterns` skill briefly, then I’ll inspect footer rendering in `render_core.rs` to align Save/Run button style and placement with the existing footer helper.
exec
/bin/zsh -lc 'cat /Users/johnlindquist/.claude/skills/gpui-patterns/SKILL.md' in /Users/johnlindquist/dev/script-kit-gpui exited 1 in 51ms:
cat: /Users/johnlindquist/.claude/skills/gpui-patterns/SKILL.md: No such file or directory

thinking
**Noticing missing skill fallback**
exec
/bin/zsh -lc "sed -n '1,260p' src/prompts/chat/render_core.rs" in /Users/johnlindquist/dev/script-kit-gpuiexec
/bin/zsh -lc 'rg -n "render_footer_button|Continue in Chat|Save and Run|script_generation_mode|Actions" src/prompts/chat/render_core.rs src/prompts/chat/prompt.rs' in /Users/johnlindquist/dev/script-kit-gpui succeeded in 52ms:
use super::*;

impl ChatPrompt {
    fn render_footer_button(
        &self,
        id: &'static str,
        label: &'static str,
        shortcut: &'static str,
        accent_color: u32,
        muted_color: u32,
    ) -> AnyElement {
        div()
            .id(id)
            .flex()
            .flex_row()
            .items_center()
            .gap(px(6.0))
            .px(px(8.0))
            .py(px(2.0))
            .rounded(px(4.0))
 succeeded in 51ms:
src/prompts/chat/prompt.rs:53:    pub(super) script_generation_mode: bool,
src/prompts/chat/prompt.rs:62:    pub(super) on_show_actions: Option<ChatShowActionsCallback>,
src/prompts/chat/prompt.rs:130:            script_generation_mode: false,
src/prompts/chat/prompt.rs:145:    pub fn set_on_show_actions(&mut self, callback: ChatShowActionsCallback) {
src/prompts/chat/prompt.rs:326:    pub fn with_script_generation_mode(mut self, enabled: bool) -> Self {
src/prompts/chat/prompt.rs:327:        self.script_generation_mode = enabled;
src/prompts/chat/prompt.rs:481:        if !self.script_generation_mode {
src/prompts/chat/prompt.rs:508:            self.script_generation_mode,
src/prompts/chat/render_core.rs:4:    fn render_footer_button(
src/prompts/chat/render_core.rs:56:            .child(self.render_footer_button(
src/prompts/chat/render_core.rs:58:                "Continue in Chat",
src/prompts/chat/render_core.rs:64:            .child(self.render_footer_button(
src/prompts/chat/render_core.rs:66:                "Actions",
src/prompts/chat/render_core.rs:172:                    "Save and Run",
src/prompts/chat/render_core.rs:306:            // Note: Actions menu keyboard navigation is handled by ActionsDialog window
src/prompts/chat/render_core.rs:323:                ChatInputKeyAction::ToggleActions => this.toggle_actions_menu(cx),
src/prompts/chat/render_core.rs:563:            // Footer with model selector, Continue in Chat, and Actions
src/prompts/chat/render_core.rs:565:            // Note: Actions menu is now handled by parent via on_show_actions callback
src/prompts/chat/render_core.rs:566:            // The parent opens the standard ActionsDialog window

thinking
**Inspecting script generation influence**
codex
I found the current mismatch: script-generation buttons are custom background pills in `render_script_generation_footer_actions`, while the normal footer uses `render_footer_button`. I’m now checking `prompt.rs` and the footer handlers so I can swap placement and visibility without breaking action routing.
exec
/bin/zsh -lc "sed -n '420,620p' src/prompts/chat/prompt.rs" in /Users/johnlindquist/dev/script-kit-gpuiexec
/bin/zsh -lc "sed -n '240,420p' src/prompts/chat/render_core.rs" in /Users/johnlindquist/dev/script-kit-gpui succeeded in 52ms:

    /// Whether the setup card is showing (no providers configured)
    pub fn needs_setup(&self) -> bool {
        self.needs_setup
    }

    /// Handle a key event in setup mode from an external interceptor.
    /// Returns true if the key was handled (caller should stop propagation).
    pub fn handle_setup_key(&mut self, key: &str, shift: bool, cx: &mut Context<Self>) -> bool {
        if !self.needs_setup {
            return false;
        }
        let (next_index, action, changed) =
            resolve_setup_card_key(key, shift, self.setup_focus_index);
        let handled = changed || !matches!(action, SetupCardAction::None);

        if changed {
            self.setup_focus_index = next_index;
            cx.notify();
        }
 succeeded in 52ms:

        // Process needs_initial_response on first render (used for scriptlets with pre-populated messages)
        // Skip if in setup mode or loading providers, requires built-in AI to be enabled
        if !self.needs_setup
            && !self.loading_providers
            && self.needs_initial_response
            && self.has_builtin_ai()
        {
            self.needs_initial_response = false;
            logging::log(
                "CHAT",
                "Processing needs_initial_response - auto-responding to initial messages",
            );
            self.handle_initial_response(cx);
        }

        self.ensure_conversation_turns_cache();
        let colors = &self.prompt_colors;

        let needs_setup = self.needs_setup;

thinking
**Inspecting footer click handlers**
exec
/bin/zsh -lc "nl -ba src/prompts/chat/prompt.rs | sed -n '440,540p'" in /Users/johnlindquist/dev/script-kit-gpui succeeded in 51ms:
   440	
   441	        match action {
   442	            SetupCardAction::ActivateConfigure => {
   443	                if let Some(ref callback) = self.on_configure {
   444	                    callback();
   445	                }
   446	            }
   447	            SetupCardAction::ActivateClaudeCode => {
   448	                if let Some(ref callback) = self.on_claude_code {
   449	                    callback();
   450	                }
   451	            }
   452	            SetupCardAction::Escape => self.handle_escape(cx),
   453	            SetupCardAction::None => {}
   454	        }
   455	
   456	        handled
   457	    }
   458	
   459	    /// Check if built-in AI mode is enabled

thinking
**Inspecting test presence**
exec
/bin/zsh -lc "sed -n '620,980p' src/prompts/chat/render_core.rs" in /Users/johnlindquist/dev/script-kit-gpui succeeded in 51ms:


thinking
**Evaluating file length**
exec
/bin/zsh -lc 'wc -l src/prompts/chat/render_core.rs src/prompts/chat/prompt.rs' in /Users/johnlindquist/dev/script-kit-gpui succeeded in 51ms:
     569 src/prompts/chat/render_core.rs
     513 src/prompts/chat/prompt.rs
    1082 total

thinking
**Inspecting footer rendering area**
exec
/bin/zsh -lc "nl -ba src/prompts/chat/render_core.rs | sed -n '500,569p'" in /Users/johnlindquist/dev/script-kit-gpui succeeded in 51ms:
   500	                    el.child(
   501	                        div()
   502	                            .id("chat-scroll-to-latest-pill")
   503	                            .absolute()
   504	                            .bottom(px(12.0))
   505	                            .left_0()
   506	                            .right_0()
   507	                            .flex()
   508	                            .justify_center()
   509	                            .child(
   510	                                div()
   511	                                    .id("chat-scroll-to-latest-button")
   512	                                    .px(px(10.0))
   513	                                    .py(px(5.0))
   514	                                    .rounded_full()
   515	                                    .bg(rgba((colors.quote_border << 8) | 0xCC))
   516	                                    .text_color(rgb(colors.text_primary))
   517	                                    .text_xs()
   518	                                    .cursor_pointer()
   519	                                    .hover(|d| d.bg(rgba((colors.quote_border << 8) | 0xFF)))

thinking
**Locating existing tests for UI logic**
codex
I confirmed the footer render path and where script-generation actions are injected. I’m now scanning for existing unit tests around script-generation gating so I can add/adjust targeted tests for the new “primary Save and Run replaces Continue in Chat” behavior.
exec
/bin/zsh -lc "sed -n '1,240p' src/prompts/chat/prompt.rs" in /Users/johnlindquist/dev/script-kit-gpuiexec
/bin/zsh -lc "rg -n \"should_show_script_generation_actions|script_generation_mode|render_footer|Continue in Chat|Save and Run|cfg\\(test\\)|mod tests\" src/prompts/chat -g\"*.rs\"" in /Users/johnlindquist/dev/script-kit-gpui succeeded in 52ms:
use super::*;
pub struct ChatPrompt {
    pub id: String,
    pub messages: Vec<ChatPromptMessage>,
    pub placeholder: Option<String>,
    pub hint: Option<String>,
    pub footer: Option<String>,
    pub model: Option<String>,
    pub models: Vec<ChatModel>,
    pub title: Option<String>,
    pub focus_handle: FocusHandle,
    pub input: TextInputState,
    pub on_submit: ChatSubmitCallback,
    pub on_escape: Option<ChatEscapeCallback>,
    pub on_continue: Option<ChatContinueCallback>,
    pub on_retry: Option<ChatRetryCallback>,
    pub theme: Arc<theme::Theme>,
    pub turns_list_state: ListState,
    pub(super) prompt_colors: theme::PromptColors,
    pub(super) conversation_turns_cache: Arc<Vec<ConversationTurn>>,
 succeeded in 51ms:
src/prompts/chat/tests.rs:2:#[cfg(test)]
src/prompts/chat/tests.rs:4:mod tests {
src/prompts/chat/tests.rs:12:        should_show_script_generation_actions, ChatInputKeyAction, ChatScrollDirection,
src/prompts/chat/tests.rs:158:    fn should_show_script_generation_actions_only_when_draft_is_ready() {
src/prompts/chat/tests.rs:160:            should_show_script_generation_actions(true, false, true),
src/prompts/chat/tests.rs:164:            !should_show_script_generation_actions(false, false, true),
src/prompts/chat/tests.rs:168:            !should_show_script_generation_actions(true, true, true),
src/prompts/chat/tests.rs:172:            !should_show_script_generation_actions(true, false, false),
src/prompts/chat/tests.rs:430:#[cfg(test)]
src/prompts/chat/render_core.rs:4:    fn render_footer_button(
src/prompts/chat/render_core.rs:27:    fn render_footer(&self, cx: &mut Context<Self>) -> impl IntoElement {
src/prompts/chat/render_core.rs:56:            .child(self.render_footer_button(
src/prompts/chat/render_core.rs:58:                "Continue in Chat",
src/prompts/chat/render_core.rs:64:            .child(self.render_footer_button(
src/prompts/chat/render_core.rs:124:        let show_actions = self.should_show_script_generation_actions();
src/prompts/chat/render_core.rs:172:                    "Save and Run",
src/prompts/chat/render_core.rs:563:            // Footer with model selector, Continue in Chat, and Actions
src/prompts/chat/render_core.rs:564:            .child(self.render_footer(cx))
src/prompts/chat/prompt.rs:53:    pub(super) script_generation_mode: bool,
src/prompts/chat/prompt.rs:130:            script_generation_mode: false,

thinking
**Assessing test locations and scope**
exec
/bin/zsh -lc "sed -n '1,240p' src/prompts/chat/types.rs" in /Users/johnlindquist/dev/script-kit-gpuiexec
/bin/zsh -lc "sed -n '120,260p' src/prompts/chat/tests.rs" in /Users/johnlindquist/dev/script-kit-gpui succeeded in 51ms:
            resolve_chat_input_key_action("backspace", true, false),
            ChatInputKeyAction::ClearConversation
        );
        assert_eq!(
            resolve_chat_input_key_action("v", true, false),
            ChatInputKeyAction::Paste
        );
        assert_eq!(
            resolve_chat_input_key_action("backspace", false, false),
            ChatInputKeyAction::DelegateToInput
        );
        assert_eq!(
            resolve_chat_input_key_action("x", true, false),
            ChatInputKeyAction::Ignore
        );
        assert_eq!(
            resolve_chat_input_key_action("a", false, false),
            ChatInputKeyAction::DelegateToInput
        );
    }
 succeeded in 51ms:
use super::*;
/// Available AI models for the chat
#[derive(Clone, Debug, PartialEq)]
pub struct ChatModel {
    pub id: String,
    pub name: String,
    pub provider: String,
}

impl ChatModel {
    pub fn new(
        id: impl Into<String>,
        name: impl Into<String>,
        provider: impl Into<String>,
    ) -> Self {
        Self {
            id: id.into(),
            name: name.into(),
            provider: provider.into(),
        }

thinking
**Analyzing footer button styling and placement**
exec
/bin/zsh -lc 'rg -n "handle_script_generation_action|No draft|script generation" src/prompts/chat/actions.rs src/prompts/chat -g"*.rs"' in /Users/johnlindquist/dev/script-kit-gpui succeeded in 52ms:
src/prompts/chat/actions.rs:132:    pub(super) fn handle_script_generation_action(
src/prompts/chat/tests.rs:165:            "Script actions should stay hidden when script generation mode is disabled"
src/prompts/chat/tests.rs:189:            "Legacy standalone script generation action row should be removed"
src/prompts/chat/tests.rs:193:            "Footer should include script generation controls next to existing footer actions"
src/prompts/chat/tests.rs:197:            "Main render tree should no longer insert script generation controls as a separate row"
src/prompts/chat/render_core.rs:162:                        this.handle_script_generation_action(action, cx);
src/prompts/chat/prompt.rs:325:    /// Enable script generation mode, which shows Save/Run actions after responses complete.
src/prompts/chat/actions.rs:132:    pub(super) fn handle_script_generation_action(
exec
/bin/zsh -lc "sed -n '108,220p' src/prompts/chat/actions.rs" in /Users/johnlindquist/dev/script-kit-gpui succeeded in 52ms:
        }

        // Close this prompt by calling the escape callback
        if let Some(ref callback) = self.on_escape {
            callback(self.id.clone());
        }
    }

    pub fn handle_copy_last_response(&mut self, cx: &mut Context<Self>) {
        // Find the last assistant message
        if let Some(last_assistant) = self.messages.iter().rev().find(|m| !m.is_user()) {
            let content = last_assistant.get_content().to_string();
            self.last_copied_response = Some(content.clone());
            logging::log("CHAT", &format!("Copied response: {} chars", content.len()));
            // Copy to clipboard via cx
            cx.write_to_clipboard(gpui::ClipboardItem::new_string(content));
        }
    }

    pub(super) fn handle_clear(&mut self, cx: &mut Context<Self>) {


thinking
**Planning footer button restructuring**
thinking
**Refactoring footer button rendering with optional shortcut**
codex
I’ve isolated the changes: I’m editing `render_core.rs` to (1) restyle Save/Run/Save and Run using the footer text-button style, (2) move Save/Run near the model on the left, and (3) replace Continue with a primary Save and Run button when `script_generation_mode` is enabled.
file update
M /Users/johnlindquist/dev/script-kit-gpui/src/prompts/chat/render_core.rs
@@ -7,3 +7,3 @@
         label: &'static str,
-        shortcut: &'static str,
+        shortcut: Option<&'static str>,
         accent_color: u32,
@@ -22,3 +22,5 @@
             .child(div().text_xs().text_color(rgb(accent_color)).child(label))
-            .child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            .when_some(shortcut, |d, shortcut| {
+                d.child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            })
             .into_any_element()
@@ -26,2 +28,32 @@
 
+    fn render_script_generation_footer_button(
+        &self,
+        id: &'static str,
+        label: &'static str,
+        shortcut: Option<&'static str>,
+        action: ScriptGenerationAction,
+        accent_color: u32,
+        muted_color: u32,
+        cx: &mut Context<Self>,
+    ) -> AnyElement {
+        div()
+            .id(id)
+            .flex()
+            .flex_row()
+            .items_center()
+            .gap(px(6.0))
+            .px(px(8.0))
+            .py(px(2.0))
+            .rounded(px(4.0))
+            .cursor_pointer()
+            .child(div().text_xs().text_color(rgb(accent_color)).child(label))
+            .when_some(shortcut, |d, shortcut| {
+                d.child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            })
+            .on_click(cx.listener(move |this, _event, _window, cx| {
+                this.handle_script_generation_action(action, cx);
+            }))
+            .into_any_element()
+    }
+
     fn render_footer(&self, cx: &mut Context<Self>) -> impl IntoElement {
@@ -42,7 +74,53 @@
 
-        let mut right_side = div().flex().flex_row().items_center().min_w(px(0.));
+        let mut left_side = div()
+            .flex()
+            .flex_row()
+            .items_center()
+            .gap(px(8.0))
+            .flex_1()
+            .min_w(px(0.0))
+            .overflow_hidden()
+            .child(
+                svg()
+                    .external_path(crate::utils::get_logo_path())
+                    .size(px(16.0))
+                    .ml(px(2.0))
+                    .text_color(rgb(footer_colors.accent)),
+            )
+            .child(
+                div()
+                    .max_w(px(420.0))
+                    .overflow_hidden()
+                    .text_ellipsis()
+                    .whitespace_nowrap()
+                    .text_xs()
+                    .text_color(rgb(footer_colors.accent))
+                    .child(model_text),
+            );
+
         if let Some(script_actions) = self.render_script_generation_footer_actions(cx) {
-            right_side = right_side.child(script_actions).child(divider());
+            left_side = left_side.child(divider()).child(script_actions);
         }
 
+        let mut right_side = div().flex().flex_row().items_center().min_w(px(0.));
+        let primary_button = if self.script_generation_mode {
+            self.render_script_generation_footer_button(
+                "chat-footer-primary-button",
+                "Save and Run",
+                None,
+                ScriptGenerationAction::SaveAndRun,
+                footer_colors.accent,
+                footer_colors.text_muted,
+                cx,
+            )
+        } else {
+            self.render_footer_button(
+                "chat-footer-primary-button",
+                "Continue in Chat",
+                Some("⌘↵"),
+                footer_colors.accent,
+                footer_colors.text_muted,
+            )
+        };
+
         right_side = right_side
@@ -55,9 +133,3 @@
             .child(divider())
-            .child(self.render_footer_button(
-                "chat-footer-primary-button",
-                "Continue in Chat",
-                "⌘↵",
-                footer_colors.accent,
-                footer_colors.text_muted,
-            ))
+            .child(primary_button)
             .child(divider())
@@ -66,3 +138,3 @@
                 "Actions",
-                "⌘K",
+                Some("⌘K"),
                 footer_colors.accent,
@@ -89,29 +161,3 @@
             .bg(footer_bg)
-            .child(
-                div()
-                    .flex()
-                    .flex_row()
-                    .items_center()
-                    .gap(px(8.0))
-                    .flex_1()
-                    .min_w(px(0.0))
-                    .overflow_hidden()
-                    .child(
-                        svg()
-                            .external_path(crate::utils::get_logo_path())
-                            .size(px(16.0))
-                            .ml(px(2.0))
-                            .text_color(rgb(footer_colors.accent)),
-                    )
-                    .child(
-                        div()
-                            .max_w(px(420.0))
-                            .overflow_hidden()
-                            .text_ellipsis()
-                            .whitespace_nowrap()
-                            .text_xs()
-                            .text_color(rgb(footer_colors.accent))
-                            .child(model_text),
-                    ),
-            )
+            .child(left_side)
             .child(right_side)
@@ -130,6 +176,4 @@
 
-        let colors = &self.prompt_colors;
         let theme_colors = &self.theme.colors;
-        let button_bg = theme::hover_overlay_bg(&self.theme, 0x24);
-        let button_hover_bg = theme::hover_overlay_bg(&self.theme, 0x36);
+        let footer_colors = PromptFooterColors::from_theme(&self.theme);
 
@@ -140,3 +184,3 @@
             .items_center()
-            .gap(px(6.0))
+            .gap(px(2.0))
             .min_w(px(0.0));
@@ -144,31 +188,29 @@
         if show_actions {
-            let button = |id: &'static str,
-                          label: &'static str,
-                          action: ScriptGenerationAction|
-             -> AnyElement {
-                div()
-                    .id(format!("chat-script-generation-{}", id))
-                    .px(px(8.0))
-                    .py(px(2.0))
-                    .rounded(px(6.0))
-                    .bg(button_bg)
-                    .cursor_pointer()
-                    .hover(move |d| d.bg(button_hover_bg))
-                    .text_xs()
-                    .font_weight(gpui::FontWeight::MEDIUM)
-                    .text_color(rgb(colors.text_primary))
-                    .child(label)
-                    .on_click(cx.listener(move |this, _event, _window, cx| {
-                        this.handle_script_generation_action(action, cx);
-                    }))
-                    .into_any_element()
-            };
-
             action_container = action_container
-                .child(button("save", "Save", ScriptGenerationAction::Save))
-                .child(button("run", "Run", ScriptGenerationAction::Run))
-                .child(button(
-                    "save-and-run",
+                .child(self.render_script_generation_footer_button(
+                    "chat-script-generation-save",
+                    "Save",
+                    None,
+                    ScriptGenerationAction::Save,
+                    footer_colors.accent,
+                    footer_colors.text_muted,
+                    cx,
+                ))
+                .child(self.render_script_generation_footer_button(
+                    "chat-script-generation-run",
+                    "Run",
+                    None,
+                    ScriptGenerationAction::Run,
+                    footer_colors.accent,
+                    footer_colors.text_muted,
+                    cx,
+                ))
+                .child(self.render_script_generation_footer_button(
+                    "chat-script-generation-save-and-run",
                     "Save and Run",
                     ScriptGenerationAction::SaveAndRun,
+                    None,
+                    footer_colors.accent,
+                    footer_colors.text_muted,
+                    cx,
                 ));
apply_patch(auto_approved=true) exited 0 in 48ms:
Success. Updated the following files:
M src/prompts/chat/render_core.rs
file update:
diff --git a/src/prompts/chat/render_core.rs b/src/prompts/chat/render_core.rs
index 59f504a9b2cf341109463f106d0bc4b8979101f9..9d162e766ac91a9005377d8a095ea1805bdccae1
--- a/src/prompts/chat/render_core.rs
+++ b/src/prompts/chat/render_core.rs
@@ -5,7 +5,7 @@
         &self,
         id: &'static str,
         label: &'static str,
-        shortcut: &'static str,
+        shortcut: Option<&'static str>,
         accent_color: u32,
         muted_color: u32,
     ) -> AnyElement {
@@ -20,10 +20,42 @@
             .rounded(px(4.0))
             .cursor_default()
             .child(div().text_xs().text_color(rgb(accent_color)).child(label))
-            .child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            .when_some(shortcut, |d, shortcut| {
+                d.child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            })
             .into_any_element()
     }
 
+    fn render_script_generation_footer_button(
+        &self,
+        id: &'static str,
+        label: &'static str,
+        shortcut: Option<&'static str>,
+        action: ScriptGenerationAction,
+        accent_color: u32,
+        muted_color: u32,
+        cx: &mut Context<Self>,
+    ) -> AnyElement {
+        div()
+            .id(id)
+            .flex()
+            .flex_row()
+            .items_center()
+            .gap(px(6.0))
+            .px(px(8.0))
+            .py(px(2.0))
+            .rounded(px(4.0))
+            .cursor_pointer()
+            .child(div().text_xs().text_color(rgb(accent_color)).child(label))
+            .when_some(shortcut, |d, shortcut| {
+                d.child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            })
+            .on_click(cx.listener(move |this, _event, _window, cx| {
+                this.handle_script_generation_action(action, cx);
+            }))
+            .into_any_element()
+    }
+
     fn render_footer(&self, cx: &mut Context<Self>) -> impl IntoElement {
         let footer_colors = PromptFooterColors::from_theme(&self.theme);
         let footer_bg = rgba(crate::components::prompt_footer::footer_surface_rgba(
@@ -40,11 +72,57 @@
                 .into_any_element()
         };
 
-        let mut right_side = div().flex().flex_row().items_center().min_w(px(0.));
+        let mut left_side = div()
+            .flex()
+            .flex_row()
+            .items_center()
+            .gap(px(8.0))
+            .flex_1()
+            .min_w(px(0.0))
+            .overflow_hidden()
+            .child(
+                svg()
+                    .external_path(crate::utils::get_logo_path())
+                    .size(px(16.0))
+                    .ml(px(2.0))
+                    .text_color(rgb(footer_colors.accent)),
+            )
+            .child(
+                div()
+                    .max_w(px(420.0))
+                    .overflow_hidden()
+                    .text_ellipsis()
+                    .whitespace_nowrap()
+                    .text_xs()
+                    .text_color(rgb(footer_colors.accent))
+                    .child(model_text),
+            );
+
         if let Some(script_actions) = self.render_script_generation_footer_actions(cx) {
-            right_side = right_side.child(script_actions).child(divider());
+            left_side = left_side.child(divider()).child(script_actions);
         }
 
+        let mut right_side = div().flex().flex_row().items_center().min_w(px(0.));
+        let primary_button = if self.script_generation_mode {
+            self.render_script_generation_footer_button(
+                "chat-footer-primary-button",
+                "Save and Run",
+                None,
+                ScriptGenerationAction::SaveAndRun,
+                footer_colors.accent,
+                footer_colors.text_muted,
+                cx,
+            )
+        } else {
+            self.render_footer_button(
+                "chat-footer-primary-button",
+                "Continue in Chat",
+                Some("⌘↵"),
+                footer_colors.accent,
+                footer_colors.text_muted,
+            )
+        };
+
         right_side = right_side
             .child(
                 div()
@@ -53,18 +131,12 @@
                     .child("Shift+Enter newline"),
             )
             .child(divider())
-            .child(self.render_footer_button(
-                "chat-footer-primary-button",
-                "Continue in Chat",
-                "⌘↵",
-                footer_colors.accent,
-                footer_colors.text_muted,
-            ))
+            .child(primary_button)
             .child(divider())
             .child(self.render_footer_button(
                 "chat-footer-secondary-button",
                 "Actions",
-                "⌘K",
+                Some("⌘K"),
                 footer_colors.accent,
                 footer_colors.text_muted,
             ));
@@ -87,33 +159,7 @@
             .border_t_1()
             .border_color(rgba((footer_colors.border << 8) | 0x50))
             .bg(footer_bg)
-            .child(
-                div()
-                    .flex()
-                    .flex_row()
-                    .items_center()
-                    .gap(px(8.0))
-                    .flex_1()
-                    .min_w(px(0.0))
-                    .overflow_hidden()
-                    .child(
-                        svg()
-                            .external_path(crate::utils::get_logo_path())
-                            .size(px(16.0))
-                            .ml(px(2.0))
-                            .text_color(rgb(footer_colors.accent)),
-                    )
-                    .child(
-                        div()
-                            .max_w(px(420.0))
-                            .overflow_hidden()
-                            .text_ellipsis()
-                            .whitespace_nowrap()
-                            .text_xs()
-                            .text_color(rgb(footer_colors.accent))
-                            .child(model_text),
-                    ),
-            )
+            .child(left_side)
             .child(right_side)
     }
 
@@ -128,49 +174,45 @@
             return None;
         }
 
-        let colors = &self.prompt_colors;
         let theme_colors = &self.theme.colors;
-        let button_bg = theme::hover_overlay_bg(&self.theme, 0x24);
-        let button_hover_bg = theme::hover_overlay_bg(&self.theme, 0x36);
+        let footer_colors = PromptFooterColors::from_theme(&self.theme);
 
         let mut action_container = div()
             .id("chat-script-generation-footer-actions")
             .flex()
             .flex_row()
             .items_center()
-            .gap(px(6.0))
+            .gap(px(2.0))
             .min_w(px(0.0));
 
         if show_actions {
-            let button = |id: &'static str,
-                          label: &'static str,
-                          action: ScriptGenerationAction|
-             -> AnyElement {
-                div()
-                    .id(format!("chat-script-generation-{}", id))
-                    .px(px(8.0))
-                    .py(px(2.0))
-                    .rounded(px(6.0))
-                    .bg(button_bg)
-                    .cursor_pointer()
-                    .hover(move |d| d.bg(button_hover_bg))
-                    .text_xs()
-                    .font_weight(gpui::FontWeight::MEDIUM)
-                    .text_color(rgb(colors.text_primary))
-                    .child(label)
-                    .on_click(cx.listener(move |this, _event, _window, cx| {
-                        this.handle_script_generation_action(action, cx);
-                    }))
-                    .into_any_element()
-            };
-
             action_container = action_container
-                .child(button("save", "Save", ScriptGenerationAction::Save))
-                .child(button("run", "Run", ScriptGenerationAction::Run))
-                .child(button(
-                    "save-and-run",
+                .child(self.render_script_generation_footer_button(
+                    "chat-script-generation-save",
+                    "Save",
+                    None,
+                    ScriptGenerationAction::Save,
+                    footer_colors.accent,
+                    footer_colors.text_muted,
+                    cx,
+                ))
+                .child(self.render_script_generation_footer_button(
+                    "chat-script-generation-run",
+                    "Run",
+                    None,
+                    ScriptGenerationAction::Run,
+                    footer_colors.accent,
+                    footer_colors.text_muted,
+                    cx,
+                ))
+                .child(self.render_script_generation_footer_button(
+                    "chat-script-generation-save-and-run",
                     "Save and Run",
                     ScriptGenerationAction::SaveAndRun,
+                    None,
+                    footer_colors.accent,
+                    footer_colors.text_muted,
+                    cx,
                 ));
         }
 

file update:
diff --git a/src/prompts/chat/render_core.rs b/src/prompts/chat/render_core.rs
index 59f504a9b2cf341109463f106d0bc4b8979101f9..9d162e766ac91a9005377d8a095ea1805bdccae1
--- a/src/prompts/chat/render_core.rs
+++ b/src/prompts/chat/render_core.rs
@@ -5,7 +5,7 @@
         &self,
         id: &'static str,
         label: &'static str,
-        shortcut: &'static str,
+        shortcut: Option<&'static str>,
         accent_color: u32,
         muted_color: u32,
     ) -> AnyElement {
@@ -20,10 +20,42 @@
             .rounded(px(4.0))
             .cursor_default()
             .child(div().text_xs().text_color(rgb(accent_color)).child(label))
-            .child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            .when_some(shortcut, |d, shortcut| {
+                d.child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            })
             .into_any_element()
     }
 
+    fn render_script_generation_footer_button(
+        &self,
+        id: &'static str,
+        label: &'static str,
+        shortcut: Option<&'static str>,
+        action: ScriptGenerationAction,
+        accent_color: u32,
+        muted_color: u32,
+        cx: &mut Context<Self>,
+    ) -> AnyElement {
+        div()
+            .id(id)
+            .flex()
+            .flex_row()
+            .items_center()
+            .gap(px(6.0))
+            .px(px(8.0))
+            .py(px(2.0))
+            .rounded(px(4.0))
+            .cursor_pointer()
+            .child(div().text_xs().text_color(rgb(accent_color)).child(label))
+            .when_some(shortcut, |d, shortcut| {
+                d.child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            })
+            .on_click(cx.listener(move |this, _event, _window, cx| {
+                this.handle_script_generation_action(action, cx);
+            }))
+            .into_any_element()
+    }
+
     fn render_footer(&self, cx: &mut Context<Self>) -> impl IntoElement {
         let footer_colors = PromptFooterColors::from_theme(&self.theme);
         let footer_bg = rgba(crate::components::prompt_footer::footer_surface_rgba(
@@ -40,11 +72,57 @@
                 .into_any_element()
         };
 
-        let mut right_side = div().flex().flex_row().items_center().min_w(px(0.));
+        let mut left_side = div()
+            .flex()
+            .flex_row()
+            .items_center()
+            .gap(px(8.0))
+            .flex_1()
+            .min_w(px(0.0))
+            .overflow_hidden()
+            .child(
+                svg()
+                    .external_path(crate::utils::get_logo_path())
+                    .size(px(16.0))
+                    .ml(px(2.0))
+                    .text_color(rgb(footer_colors.accent)),
+            )
+            .child(
+                div()
+                    .max_w(px(420.0))
+                    .overflow_hidden()
+                    .text_ellipsis()
+                    .whitespace_nowrap()
+                    .text_xs()
+                    .text_color(rgb(footer_colors.accent))
+                    .child(model_text),
+            );
+
         if let Some(script_actions) = self.render_script_generation_footer_actions(cx) {
-            right_side = right_side.child(script_actions).child(divider());
+            left_side = left_side.child(divider()).child(script_actions);
         }
 
+        let mut right_side = div().flex().flex_row().items_center().min_w(px(0.));
+        let primary_button = if self.script_generation_mode {
+            self.render_script_generation_footer_button(
+                "chat-footer-primary-button",
+                "Save and Run",
+                None,
+                ScriptGenerationAction::SaveAndRun,
+                footer_colors.accent,
+                footer_colors.text_muted,
+                cx,
+            )
+        } else {
+            self.render_footer_button(
+                "chat-footer-primary-button",
+                "Continue in Chat",
+                Some("⌘↵"),
+                footer_colors.accent,
+                footer_colors.text_muted,
+            )
+        };
+
         right_side = right_side
             .child(
                 div()
@@ -53,18 +131,12 @@
                     .child("Shift+Enter newline"),
             )
             .child(divider())
-            .child(self.render_footer_button(
-                "chat-footer-primary-button",
-                "Continue in Chat",
-                "⌘↵",
-                footer_colors.accent,
-                footer_colors.text_muted,
-            ))
+            .child(primary_button)
             .child(divider())
             .child(self.render_footer_button(
                 "chat-footer-secondary-button",
                 "Actions",
-                "⌘K",
+                Some("⌘K"),
                 footer_colors.accent,
                 footer_colors.text_muted,
             ));
@@ -87,33 +159,7 @@
             .border_t_1()
             .border_color(rgba((footer_colors.border << 8) | 0x50))
             .bg(footer_bg)
-            .child(
-                div()
-                    .flex()
-                    .flex_row()
-                    .items_center()
-                    .gap(px(8.0))
-                    .flex_1()
-                    .min_w(px(0.0))
-                    .overflow_hidden()
-                    .child(
-                        svg()
-                            .external_path(crate::utils::get_logo_path())
-                            .size(px(16.0))
-                            .ml(px(2.0))
-                            .text_color(rgb(footer_colors.accent)),
-                    )
-                    .child(
-                        div()
-                            .max_w(px(420.0))
-                            .overflow_hidden()
-                            .text_ellipsis()
-                            .whitespace_nowrap()
-                            .text_xs()
-                            .text_color(rgb(footer_colors.accent))
-                            .child(model_text),
-                    ),
-            )
+            .child(left_side)
             .child(right_side)
     }
 
@@ -128,49 +174,45 @@
             return None;
         }
 
-        let colors = &self.prompt_colors;
         let theme_colors = &self.theme.colors;
-        let button_bg = theme::hover_overlay_bg(&self.theme, 0x24);
-        let button_hover_bg = theme::hover_overlay_bg(&self.theme, 0x36);
+        let footer_colors = PromptFooterColors::from_theme(&self.theme);
 
         let mut action_container = div()
             .id("chat-script-generation-footer-actions")
             .flex()
             .flex_row()
             .items_center()
-            .gap(px(6.0))
+            .gap(px(2.0))
             .min_w(px(0.0));
 
         if show_actions {
-            let button = |id: &'static str,
-                          label: &'static str,
-                          action: ScriptGenerationAction|
-             -> AnyElement {
-                div()
-                    .id(format!("chat-script-generation-{}", id))
-                    .px(px(8.0))
-                    .py(px(2.0))
-                    .rounded(px(6.0))
-                    .bg(button_bg)
-                    .cursor_pointer()
-                    .hover(move |d| d.bg(button_hover_bg))
-                    .text_xs()
-                    .font_weight(gpui::FontWeight::MEDIUM)
-                    .text_color(rgb(colors.text_primary))
-                    .child(label)
-                    .on_click(cx.listener(move |this, _event, _window, cx| {
-                        this.handle_script_generation_action(action, cx);
-                    }))
-                    .into_any_element()
-            };
-
             action_container = action_container
-                .child(button("save", "Save", ScriptGenerationAction::Save))
-                .child(button("run", "Run", ScriptGenerationAction::Run))
-                .child(button(
-                    "save-and-run",
+                .child(self.render_script_generation_footer_button(
+                    "chat-script-generation-save",
+                    "Save",
+                    None,
+                    ScriptGenerationAction::Save,
+                    footer_colors.accent,
+                    footer_colors.text_muted,
+                    cx,
+                ))
+                .child(self.render_script_generation_footer_button(
+                    "chat-script-generation-run",
+                    "Run",
+                    None,
+                    ScriptGenerationAction::Run,
+                    footer_colors.accent,
+                    footer_colors.text_muted,
+                    cx,
+                ))
+                .child(self.render_script_generation_footer_button(
+                    "chat-script-generation-save-and-run",
                     "Save and Run",
                     ScriptGenerationAction::SaveAndRun,
+                    None,
+                    footer_colors.accent,
+                    footer_colors.text_muted,
+                    cx,
                 ));
         }
 


thinking
**Inspecting argument order in patch**
exec
/bin/zsh -lc "nl -ba src/prompts/chat/render_core.rs | sed -n '1,240p'" in /Users/johnlindquist/dev/script-kit-gpui succeeded in 51ms:
     1	use super::*;
     2	
     3	impl ChatPrompt {
     4	    fn render_footer_button(
     5	        &self,
     6	        id: &'static str,
     7	        label: &'static str,
     8	        shortcut: Option<&'static str>,
     9	        accent_color: u32,
    10	        muted_color: u32,
    11	    ) -> AnyElement {
    12	        div()
    13	            .id(id)
    14	            .flex()
    15	            .flex_row()
    16	            .items_center()
    17	            .gap(px(6.0))
    18	            .px(px(8.0))
    19	            .py(px(2.0))
    20	            .rounded(px(4.0))
file update:
diff --git a/src/prompts/chat/render_core.rs b/src/prompts/chat/render_core.rs
index 59f504a9b2cf341109463f106d0bc4b8979101f9..9d162e766ac91a9005377d8a095ea1805bdccae1
--- a/src/prompts/chat/render_core.rs
+++ b/src/prompts/chat/render_core.rs
@@ -5,7 +5,7 @@
         &self,
         id: &'static str,
         label: &'static str,
-        shortcut: &'static str,
+        shortcut: Option<&'static str>,
         accent_color: u32,
         muted_color: u32,
     ) -> AnyElement {
@@ -20,10 +20,42 @@
             .rounded(px(4.0))
             .cursor_default()
             .child(div().text_xs().text_color(rgb(accent_color)).child(label))
-            .child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            .when_some(shortcut, |d, shortcut| {
+                d.child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            })
             .into_any_element()
     }
 
+    fn render_script_generation_footer_button(
+        &self,
+        id: &'static str,
+        label: &'static str,
+        shortcut: Option<&'static str>,
+        action: ScriptGenerationAction,
+        accent_color: u32,
+        muted_color: u32,
+        cx: &mut Context<Self>,
+    ) -> AnyElement {
+        div()
+            .id(id)
+            .flex()
+            .flex_row()
+            .items_center()
+            .gap(px(6.0))
+            .px(px(8.0))
+            .py(px(2.0))
+            .rounded(px(4.0))
+            .cursor_pointer()
+            .child(div().text_xs().text_color(rgb(accent_color)).child(label))
+            .when_some(shortcut, |d, shortcut| {
+                d.child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            })
+            .on_click(cx.listener(move |this, _event, _window, cx| {
+                this.handle_script_generation_action(action, cx);
+            }))
+            .into_any_element()
+    }
+
     fn render_footer(&self, cx: &mut Context<Self>) -> impl IntoElement {
         let footer_colors = PromptFooterColors::from_theme(&self.theme);
         let footer_bg = rgba(crate::components::prompt_footer::footer_surface_rgba(
@@ -40,11 +72,57 @@
                 .into_any_element()
         };
 
-        let mut right_side = div().flex().flex_row().items_center().min_w(px(0.));
+        let mut left_side = div()
+            .flex()
+            .flex_row()
+            .items_center()
+            .gap(px(8.0))
+            .flex_1()
+            .min_w(px(0.0))
+            .overflow_hidden()
+            .child(
+                svg()
+                    .external_path(crate::utils::get_logo_path())
+                    .size(px(16.0))
+                    .ml(px(2.0))
+                    .text_color(rgb(footer_colors.accent)),
+            )
+            .child(
+                div()
+                    .max_w(px(420.0))
+                    .overflow_hidden()
+                    .text_ellipsis()
+                    .whitespace_nowrap()
+                    .text_xs()
+                    .text_color(rgb(footer_colors.accent))
+                    .child(model_text),
+            );
+
         if let Some(script_actions) = self.render_script_generation_footer_actions(cx) {
-            right_side = right_side.child(script_actions).child(divider());
+            left_side = left_side.child(divider()).child(script_actions);
         }
 
+        let mut right_side = div().flex().flex_row().items_center().min_w(px(0.));
+        let primary_button = if self.script_generation_mode {
+            self.render_script_generation_footer_button(
+                "chat-footer-primary-button",
+                "Save and Run",
+                None,
+                ScriptGenerationAction::SaveAndRun,
+                footer_colors.accent,
+                footer_colors.text_muted,
+                cx,
+            )
+        } else {
+            self.render_footer_button(
+                "chat-footer-primary-button",
+                "Continue in Chat",
+                Some("⌘↵"),
+                footer_colors.accent,
+                footer_colors.text_muted,
+            )
+        };
+
         right_side = right_side
             .child(
                 div()
@@ -53,18 +131,12 @@
                     .child("Shift+Enter newline"),
             )
             .child(divider())
-            .child(self.render_footer_button(
-                "chat-footer-primary-button",
-                "Continue in Chat",
-                "⌘↵",
-                footer_colors.accent,
-                footer_colors.text_muted,
-            ))
+            .child(primary_button)
             .child(divider())
             .child(self.render_footer_button(
                 "chat-footer-secondary-button",
                 "Actions",
-                "⌘K",
+                Some("⌘K"),
                 footer_colors.accent,
                 footer_colors.text_muted,
             ));
@@ -87,33 +159,7 @@
             .border_t_1()
             .border_color(rgba((footer_colors.border << 8) | 0x50))
             .bg(footer_bg)
-            .child(
-                div()
-                    .flex()
-                    .flex_row()
-                    .items_center()
-                    .gap(px(8.0))
-                    .flex_1()
-                    .min_w(px(0.0))
-                    .overflow_hidden()
-                    .child(
-                        svg()
-                            .external_path(crate::utils::get_logo_path())
-                            .size(px(16.0))
-                            .ml(px(2.0))
-                            .text_color(rgb(footer_colors.accent)),
-                    )
-                    .child(
-                        div()
-                            .max_w(px(420.0))
-                            .overflow_hidden()
-                            .text_ellipsis()
-                            .whitespace_nowrap()
-                            .text_xs()
-                            .text_color(rgb(footer_colors.accent))
-                            .child(model_text),
-                    ),
-            )
+            .child(left_side)
             .child(right_side)
     }
 
@@ -128,49 +174,45 @@
             return None;
         }
 
-        let colors = &self.prompt_colors;
         let theme_colors = &self.theme.colors;
-        let button_bg = theme::hover_overlay_bg(&self.theme, 0x24);
-        let button_hover_bg = theme::hover_overlay_bg(&self.theme, 0x36);
+        let footer_colors = PromptFooterColors::from_theme(&self.theme);
 
         let mut action_container = div()
             .id("chat-script-generation-footer-actions")
             .flex()
             .flex_row()
             .items_center()
-            .gap(px(6.0))
+            .gap(px(2.0))
             .min_w(px(0.0));
 
         if show_actions {
-            let button = |id: &'static str,
-                          label: &'static str,
-                          action: ScriptGenerationAction|
-             -> AnyElement {
-                div()
-                    .id(format!("chat-script-generation-{}", id))
-                    .px(px(8.0))
-                    .py(px(2.0))
-                    .rounded(px(6.0))
-                    .bg(button_bg)
-                    .cursor_pointer()
-                    .hover(move |d| d.bg(button_hover_bg))
-                    .text_xs()
-                    .font_weight(gpui::FontWeight::MEDIUM)
-                    .text_color(rgb(colors.text_primary))
-                    .child(label)
-                    .on_click(cx.listener(move |this, _event, _window, cx| {
-                        this.handle_script_generation_action(action, cx);
-                    }))
-                    .into_any_element()
-            };
-
             action_container = action_container
-                .child(button("save", "Save", ScriptGenerationAction::Save))
-                .child(button("run", "Run", ScriptGenerationAction::Run))
-                .child(button(
-                    "save-and-run",
+                .child(self.render_script_generation_footer_button(
+                    "chat-script-generation-save",
+                    "Save",
+                    None,
+                    ScriptGenerationAction::Save,
+                    footer_colors.accent,
+                    footer_colors.text_muted,
+                    cx,
+                ))
+                .child(self.render_script_generation_footer_button(
+                    "chat-script-generation-run",
+                    "Run",
+                    None,
+                    ScriptGenerationAction::Run,
+                    footer_colors.accent,
+                    footer_colors.text_muted,
+                    cx,
+                ))
+                .child(self.render_script_generation_footer_button(
+                    "chat-script-generation-save-and-run",
                     "Save and Run",
                     ScriptGenerationAction::SaveAndRun,
+                    None,
+                    footer_colors.accent,
+                    footer_colors.text_muted,
+                    cx,
                 ));
         }
 


thinking
**Fixing argument order and footer rendering**
file update
M /Users/johnlindquist/dev/script-kit-gpui/src/prompts/chat/render_core.rs
@@ -100,4 +100,6 @@
 
-        if let Some(script_actions) = self.render_script_generation_footer_actions(cx) {
-            left_side = left_side.child(divider()).child(script_actions);
+        if self.script_generation_mode {
+            if let Some(script_actions) = self.render_script_generation_footer_actions(cx) {
+                left_side = left_side.child(divider()).child(script_actions);
+            }
         }
@@ -207,11 +209,3 @@
                 ))
-                .child(self.render_script_generation_footer_button(
-                    "chat-script-generation-save-and-run",
-                    "Save and Run",
-                    ScriptGenerationAction::SaveAndRun,
-                    None,
-                    footer_colors.accent,
-                    footer_colors.text_muted,
-                    cx,
-                ));
+                .child(div().text_xs().text_color(rgb(footer_colors.text_muted)).child("|"));
         }
apply_patch(auto_approved=true) exited 0 in 13ms:
Success. Updated the following files:
M src/prompts/chat/render_core.rs
file update:
diff --git a/src/prompts/chat/render_core.rs b/src/prompts/chat/render_core.rs
index 59f504a9b2cf341109463f106d0bc4b8979101f9..7209fefc116e7a5487110b0c25f4dece7ff9c5c4
--- a/src/prompts/chat/render_core.rs
+++ b/src/prompts/chat/render_core.rs
@@ -5,7 +5,7 @@
         &self,
         id: &'static str,
         label: &'static str,
-        shortcut: &'static str,
+        shortcut: Option<&'static str>,
         accent_color: u32,
         muted_color: u32,
     ) -> AnyElement {
@@ -20,7 +20,39 @@
             .rounded(px(4.0))
             .cursor_default()
             .child(div().text_xs().text_color(rgb(accent_color)).child(label))
-            .child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            .when_some(shortcut, |d, shortcut| {
+                d.child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            })
+            .into_any_element()
+    }
+
+    fn render_script_generation_footer_button(
+        &self,
+        id: &'static str,
+        label: &'static str,
+        shortcut: Option<&'static str>,
+        action: ScriptGenerationAction,
+        accent_color: u32,
+        muted_color: u32,
+        cx: &mut Context<Self>,
+    ) -> AnyElement {
+        div()
+            .id(id)
+            .flex()
+            .flex_row()
+            .items_center()
+            .gap(px(6.0))
+            .px(px(8.0))
+            .py(px(2.0))
+            .rounded(px(4.0))
+            .cursor_pointer()
+            .child(div().text_xs().text_color(rgb(accent_color)).child(label))
+            .when_some(shortcut, |d, shortcut| {
+                d.child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            })
+            .on_click(cx.listener(move |this, _event, _window, cx| {
+                this.handle_script_generation_action(action, cx);
+            }))
             .into_any_element()
     }
 
@@ -40,11 +72,59 @@
                 .into_any_element()
         };
 
-        let mut right_side = div().flex().flex_row().items_center().min_w(px(0.));
-        if let Some(script_actions) = self.render_script_generation_footer_actions(cx) {
-            right_side = right_side.child(script_actions).child(divider());
+        let mut left_side = div()
+            .flex()
+            .flex_row()
+            .items_center()
+            .gap(px(8.0))
+            .flex_1()
+            .min_w(px(0.0))
+            .overflow_hidden()
+            .child(
+                svg()
+                    .external_path(crate::utils::get_logo_path())
+                    .size(px(16.0))
+                    .ml(px(2.0))
+                    .text_color(rgb(footer_colors.accent)),
+            )
+            .child(
+                div()
+                    .max_w(px(420.0))
+                    .overflow_hidden()
+                    .text_ellipsis()
+                    .whitespace_nowrap()
+                    .text_xs()
+                    .text_color(rgb(footer_colors.accent))
+                    .child(model_text),
+            );
+
+        if self.script_generation_mode {
+            if let Some(script_actions) = self.render_script_generation_footer_actions(cx) {
+                left_side = left_side.child(divider()).child(script_actions);
+            }
         }
 
+        let mut right_side = div().flex().flex_row().items_center().min_w(px(0.));
+        let primary_button = if self.script_generation_mode {
+            self.render_script_generation_footer_button(
+                "chat-footer-primary-button",
+                "Save and Run",
+                None,
+                ScriptGenerationAction::SaveAndRun,
+                footer_colors.accent,
+                footer_colors.text_muted,
+                cx,
+            )
+        } else {
+            self.render_footer_button(
+                "chat-footer-primary-button",
+                "Continue in Chat",
+                Some("⌘↵"),
+                footer_colors.accent,
+                footer_colors.text_muted,
+            )
+        };
+
         right_side = right_side
             .child(
                 div()
@@ -53,18 +133,12 @@
                     .child("Shift+Enter newline"),
             )
             .child(divider())
-            .child(self.render_footer_button(
-                "chat-footer-primary-button",
-                "Continue in Chat",
-                "⌘↵",
-                footer_colors.accent,
-                footer_colors.text_muted,
-            ))
+            .child(primary_button)
             .child(divider())
             .child(self.render_footer_button(
                 "chat-footer-secondary-button",
                 "Actions",
-                "⌘K",
+                Some("⌘K"),
                 footer_colors.accent,
                 footer_colors.text_muted,
             ));
@@ -87,33 +161,7 @@
             .border_t_1()
             .border_color(rgba((footer_colors.border << 8) | 0x50))
             .bg(footer_bg)
-            .child(
-                div()
-                    .flex()
-                    .flex_row()
-                    .items_center()
-                    .gap(px(8.0))
-                    .flex_1()
-                    .min_w(px(0.0))
-                    .overflow_hidden()
-                    .child(
-                        svg()
-                            .external_path(crate::utils::get_logo_path())
-                            .size(px(16.0))
-                            .ml(px(2.0))
-                            .text_color(rgb(footer_colors.accent)),
-                    )
-                    .child(
-                        div()
-                            .max_w(px(420.0))
-                            .overflow_hidden()
-                            .text_ellipsis()
-                            .whitespace_nowrap()
-                            .text_xs()
-                            .text_color(rgb(footer_colors.accent))
-                            .child(model_text),
-                    ),
-            )
+            .child(left_side)
             .child(right_side)
     }
 
@@ -128,50 +176,38 @@
             return None;
         }
 
-        let colors = &self.prompt_colors;
         let theme_colors = &self.theme.colors;
-        let button_bg = theme::hover_overlay_bg(&self.theme, 0x24);
-        let button_hover_bg = theme::hover_overlay_bg(&self.theme, 0x36);
+        let footer_colors = PromptFooterColors::from_theme(&self.theme);
 
         let mut action_container = div()
             .id("chat-script-generation-footer-actions")
             .flex()
             .flex_row()
             .items_center()
-            .gap(px(6.0))
+            .gap(px(2.0))
             .min_w(px(0.0));
 
         if show_actions {
-            let button = |id: &'static str,
-                          label: &'static str,
-                          action: ScriptGenerationAction|
-             -> AnyElement {
-                div()
-                    .id(format!("chat-script-generation-{}", id))
-                    .px(px(8.0))
-                    .py(px(2.0))
-                    .rounded(px(6.0))
-                    .bg(button_bg)
-                    .cursor_pointer()
-                    .hover(move |d| d.bg(button_hover_bg))
-                    .text_xs()
-                    .font_weight(gpui::FontWeight::MEDIUM)
-                    .text_color(rgb(colors.text_primary))
-                    .child(label)
-                    .on_click(cx.listener(move |this, _event, _window, cx| {
-                        this.handle_script_generation_action(action, cx);
-                    }))
-                    .into_any_element()
-            };
-
             action_container = action_container
-                .child(button("save", "Save", ScriptGenerationAction::Save))
-                .child(button("run", "Run", ScriptGenerationAction::Run))
-                .child(button(
-                    "save-and-run",
-                    "Save and Run",
-                    ScriptGenerationAction::SaveAndRun,
-                ));
+                .child(self.render_script_generation_footer_button(
+                    "chat-script-generation-save",
+                    "Save",
+                    None,
+                    ScriptGenerationAction::Save,
+                    footer_colors.accent,
+                    footer_colors.text_muted,
+                    cx,
+                ))
+                .child(self.render_script_generation_footer_button(
+                    "chat-script-generation-run",
+                    "Run",
+                    None,
+                    ScriptGenerationAction::Run,
+                    footer_colors.accent,
+                    footer_colors.text_muted,
+                    cx,
+                ))
+                .child(div().text_xs().text_color(rgb(footer_colors.text_muted)).child("|"));
         }
 
         if let Some(status) = status_message {

file update:
diff --git a/src/prompts/chat/render_core.rs b/src/prompts/chat/render_core.rs
index 59f504a9b2cf341109463f106d0bc4b8979101f9..7209fefc116e7a5487110b0c25f4dece7ff9c5c4
--- a/src/prompts/chat/render_core.rs
+++ b/src/prompts/chat/render_core.rs
@@ -5,7 +5,7 @@
         &self,
         id: &'static str,
         label: &'static str,
-        shortcut: &'static str,
+        shortcut: Option<&'static str>,
         accent_color: u32,
         muted_color: u32,
     ) -> AnyElement {
@@ -20,7 +20,39 @@
             .rounded(px(4.0))
             .cursor_default()
             .child(div().text_xs().text_color(rgb(accent_color)).child(label))
-            .child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            .when_some(shortcut, |d, shortcut| {
+                d.child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            })
+            .into_any_element()
+    }
+
+    fn render_script_generation_footer_button(
+        &self,
+        id: &'static str,
+        label: &'static str,
+        shortcut: Option<&'static str>,
+        action: ScriptGenerationAction,
+        accent_color: u32,
+        muted_color: u32,
+        cx: &mut Context<Self>,
+    ) -> AnyElement {
+        div()
+            .id(id)
+            .flex()
+            .flex_row()
+            .items_center()
+            .gap(px(6.0))
+            .px(px(8.0))
+            .py(px(2.0))
+            .rounded(px(4.0))
+            .cursor_pointer()
+            .child(div().text_xs().text_color(rgb(accent_color)).child(label))
+            .when_some(shortcut, |d, shortcut| {
+                d.child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            })
+            .on_click(cx.listener(move |this, _event, _window, cx| {
+                this.handle_script_generation_action(action, cx);
+            }))
             .into_any_element()
     }
 
@@ -40,11 +72,59 @@
                 .into_any_element()
         };
 
-        let mut right_side = div().flex().flex_row().items_center().min_w(px(0.));
-        if let Some(script_actions) = self.render_script_generation_footer_actions(cx) {
-            right_side = right_side.child(script_actions).child(divider());
+        let mut left_side = div()
+            .flex()
+            .flex_row()
+            .items_center()
+            .gap(px(8.0))
+            .flex_1()
+            .min_w(px(0.0))
+            .overflow_hidden()
+            .child(
+                svg()
+                    .external_path(crate::utils::get_logo_path())
+                    .size(px(16.0))
+                    .ml(px(2.0))
+                    .text_color(rgb(footer_colors.accent)),
+            )
+            .child(
+                div()
+                    .max_w(px(420.0))
+                    .overflow_hidden()
+                    .text_ellipsis()
+                    .whitespace_nowrap()
+                    .text_xs()
+                    .text_color(rgb(footer_colors.accent))
+                    .child(model_text),
+            );
+
+        if self.script_generation_mode {
+            if let Some(script_actions) = self.render_script_generation_footer_actions(cx) {
+                left_side = left_side.child(divider()).child(script_actions);
+            }
         }
 
+        let mut right_side = div().flex().flex_row().items_center().min_w(px(0.));
+        let primary_button = if self.script_generation_mode {
+            self.render_script_generation_footer_button(
+                "chat-footer-primary-button",
+                "Save and Run",
+                None,
+                ScriptGenerationAction::SaveAndRun,
+                footer_colors.accent,
+                footer_colors.text_muted,
+                cx,
+            )
+        } else {
+            self.render_footer_button(
+                "chat-footer-primary-button",
+                "Continue in Chat",
+                Some("⌘↵"),
+                footer_colors.accent,
+                footer_colors.text_muted,
+            )
+        };
+
         right_side = right_side
             .child(
                 div()
@@ -53,18 +133,12 @@
                     .child("Shift+Enter newline"),
             )
             .child(divider())
-            .child(self.render_footer_button(
-                "chat-footer-primary-button",
-                "Continue in Chat",
-                "⌘↵",
-                footer_colors.accent,
-                footer_colors.text_muted,
-            ))
+            .child(primary_button)
             .child(divider())
             .child(self.render_footer_button(
                 "chat-footer-secondary-button",
                 "Actions",
-                "⌘K",
+                Some("⌘K"),
                 footer_colors.accent,
                 footer_colors.text_muted,
             ));
@@ -87,33 +161,7 @@
             .border_t_1()
             .border_color(rgba((footer_colors.border << 8) | 0x50))
             .bg(footer_bg)
-            .child(
-                div()
-                    .flex()
-                    .flex_row()
-                    .items_center()
-                    .gap(px(8.0))
-                    .flex_1()
-                    .min_w(px(0.0))
-                    .overflow_hidden()
-                    .child(
-                        svg()
-                            .external_path(crate::utils::get_logo_path())
-                            .size(px(16.0))
-                            .ml(px(2.0))
-                            .text_color(rgb(footer_colors.accent)),
-                    )
-                    .child(
-                        div()
-                            .max_w(px(420.0))
-                            .overflow_hidden()
-                            .text_ellipsis()
-                            .whitespace_nowrap()
-                            .text_xs()
-                            .text_color(rgb(footer_colors.accent))
-                            .child(model_text),
-                    ),
-            )
+            .child(left_side)
             .child(right_side)
     }
 
@@ -128,50 +176,38 @@
             return None;
         }
 
-        let colors = &self.prompt_colors;
         let theme_colors = &self.theme.colors;
-        let button_bg = theme::hover_overlay_bg(&self.theme, 0x24);
-        let button_hover_bg = theme::hover_overlay_bg(&self.theme, 0x36);
+        let footer_colors = PromptFooterColors::from_theme(&self.theme);
 
         let mut action_container = div()
             .id("chat-script-generation-footer-actions")
             .flex()
             .flex_row()
             .items_center()
-            .gap(px(6.0))
+            .gap(px(2.0))
             .min_w(px(0.0));
 
         if show_actions {
-            let button = |id: &'static str,
-                          label: &'static str,
-                          action: ScriptGenerationAction|
-             -> AnyElement {
-                div()
-                    .id(format!("chat-script-generation-{}", id))
-                    .px(px(8.0))
-                    .py(px(2.0))
-                    .rounded(px(6.0))
-                    .bg(button_bg)
-                    .cursor_pointer()
-                    .hover(move |d| d.bg(button_hover_bg))
-                    .text_xs()
-                    .font_weight(gpui::FontWeight::MEDIUM)
-                    .text_color(rgb(colors.text_primary))
-                    .child(label)
-                    .on_click(cx.listener(move |this, _event, _window, cx| {
-                        this.handle_script_generation_action(action, cx);
-                    }))
-                    .into_any_element()
-            };
-
             action_container = action_container
-                .child(button("save", "Save", ScriptGenerationAction::Save))
-                .child(button("run", "Run", ScriptGenerationAction::Run))
-                .child(button(
-                    "save-and-run",
-                    "Save and Run",
-                    ScriptGenerationAction::SaveAndRun,
-                ));
+                .child(self.render_script_generation_footer_button(
+                    "chat-script-generation-save",
+                    "Save",
+                    None,
+                    ScriptGenerationAction::Save,
+                    footer_colors.accent,
+                    footer_colors.text_muted,
+                    cx,
+                ))
+                .child(self.render_script_generation_footer_button(
+                    "chat-script-generation-run",
+                    "Run",
+                    None,
+                    ScriptGenerationAction::Run,
+                    footer_colors.accent,
+                    footer_colors.text_muted,
+                    cx,
+                ))
+                .child(div().text_xs().text_color(rgb(footer_colors.text_muted)).child("|"));
         }
 
         if let Some(status) = status_message {


thinking
**Removing unnecessary separator**
file update
M /Users/johnlindquist/dev/script-kit-gpui/src/prompts/chat/render_core.rs
@@ -208,4 +208,3 @@
                     cx,
-                ))
-                .child(div().text_xs().text_color(rgb(footer_colors.text_muted)).child("|"));
+                ));
         }
apply_patch(auto_approved=true) exited 0 in 20ms:
Success. Updated the following files:
M src/prompts/chat/render_core.rs
file update:
diff --git a/src/prompts/chat/render_core.rs b/src/prompts/chat/render_core.rs
index 59f504a9b2cf341109463f106d0bc4b8979101f9..88414695ecec80c875f6009851a22e17b486e724
--- a/src/prompts/chat/render_core.rs
+++ b/src/prompts/chat/render_core.rs
@@ -5,7 +5,7 @@
         &self,
         id: &'static str,
         label: &'static str,
-        shortcut: &'static str,
+        shortcut: Option<&'static str>,
         accent_color: u32,
         muted_color: u32,
     ) -> AnyElement {
@@ -20,10 +20,42 @@
             .rounded(px(4.0))
             .cursor_default()
             .child(div().text_xs().text_color(rgb(accent_color)).child(label))
-            .child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            .when_some(shortcut, |d, shortcut| {
+                d.child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            })
             .into_any_element()
     }
 
+    fn render_script_generation_footer_button(
+        &self,
+        id: &'static str,
+        label: &'static str,
+        shortcut: Option<&'static str>,
+        action: ScriptGenerationAction,
+        accent_color: u32,
+        muted_color: u32,
+        cx: &mut Context<Self>,
+    ) -> AnyElement {
+        div()
+            .id(id)
+            .flex()
+            .flex_row()
+            .items_center()
+            .gap(px(6.0))
+            .px(px(8.0))
+            .py(px(2.0))
+            .rounded(px(4.0))
+            .cursor_pointer()
+            .child(div().text_xs().text_color(rgb(accent_color)).child(label))
+            .when_some(shortcut, |d, shortcut| {
+                d.child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            })
+            .on_click(cx.listener(move |this, _event, _window, cx| {
+                this.handle_script_generation_action(action, cx);
+            }))
+            .into_any_element()
+    }
+
     fn render_footer(&self, cx: &mut Context<Self>) -> impl IntoElement {
         let footer_colors = PromptFooterColors::from_theme(&self.theme);
         let footer_bg = rgba(crate::components::prompt_footer::footer_surface_rgba(
@@ -40,11 +72,59 @@
                 .into_any_element()
         };
 
-        let mut right_side = div().flex().flex_row().items_center().min_w(px(0.));
-        if let Some(script_actions) = self.render_script_generation_footer_actions(cx) {
-            right_side = right_side.child(script_actions).child(divider());
+        let mut left_side = div()
+            .flex()
+            .flex_row()
+            .items_center()
+            .gap(px(8.0))
+            .flex_1()
+            .min_w(px(0.0))
+            .overflow_hidden()
+            .child(
+                svg()
+                    .external_path(crate::utils::get_logo_path())
+                    .size(px(16.0))
+                    .ml(px(2.0))
+                    .text_color(rgb(footer_colors.accent)),
+            )
+            .child(
+                div()
+                    .max_w(px(420.0))
+                    .overflow_hidden()
+                    .text_ellipsis()
+                    .whitespace_nowrap()
+                    .text_xs()
+                    .text_color(rgb(footer_colors.accent))
+                    .child(model_text),
+            );
+
+        if self.script_generation_mode {
+            if let Some(script_actions) = self.render_script_generation_footer_actions(cx) {
+                left_side = left_side.child(divider()).child(script_actions);
+            }
         }
 
+        let mut right_side = div().flex().flex_row().items_center().min_w(px(0.));
+        let primary_button = if self.script_generation_mode {
+            self.render_script_generation_footer_button(
+                "chat-footer-primary-button",
+                "Save and Run",
+                None,
+                ScriptGenerationAction::SaveAndRun,
+                footer_colors.accent,
+                footer_colors.text_muted,
+                cx,
+            )
+        } else {
+            self.render_footer_button(
+                "chat-footer-primary-button",
+                "Continue in Chat",
+                Some("⌘↵"),
+                footer_colors.accent,
+                footer_colors.text_muted,
+            )
+        };
+
         right_side = right_side
             .child(
                 div()
@@ -53,18 +133,12 @@
                     .child("Shift+Enter newline"),
             )
             .child(divider())
-            .child(self.render_footer_button(
-                "chat-footer-primary-button",
-                "Continue in Chat",
-                "⌘↵",
-                footer_colors.accent,
-                footer_colors.text_muted,
-            ))
+            .child(primary_button)
             .child(divider())
             .child(self.render_footer_button(
                 "chat-footer-secondary-button",
                 "Actions",
-                "⌘K",
+                Some("⌘K"),
                 footer_colors.accent,
                 footer_colors.text_muted,
             ));
@@ -87,33 +161,7 @@
             .border_t_1()
             .border_color(rgba((footer_colors.border << 8) | 0x50))
             .bg(footer_bg)
-            .child(
-                div()
-                    .flex()
-                    .flex_row()
-                    .items_center()
-                    .gap(px(8.0))
-                    .flex_1()
-                    .min_w(px(0.0))
-                    .overflow_hidden()
-                    .child(
-                        svg()
-                            .external_path(crate::utils::get_logo_path())
-                            .size(px(16.0))
-                            .ml(px(2.0))
-                            .text_color(rgb(footer_colors.accent)),
-                    )
-                    .child(
-                        div()
-                            .max_w(px(420.0))
-                            .overflow_hidden()
-                            .text_ellipsis()
-                            .whitespace_nowrap()
-                            .text_xs()
-                            .text_color(rgb(footer_colors.accent))
-                            .child(model_text),
-                    ),
-            )
+            .child(left_side)
             .child(right_side)
     }
 
@@ -128,49 +176,36 @@
             return None;
         }
 
-        let colors = &self.prompt_colors;
         let theme_colors = &self.theme.colors;
-        let button_bg = theme::hover_overlay_bg(&self.theme, 0x24);
-        let button_hover_bg = theme::hover_overlay_bg(&self.theme, 0x36);
+        let footer_colors = PromptFooterColors::from_theme(&self.theme);
 
         let mut action_container = div()
             .id("chat-script-generation-footer-actions")
             .flex()
             .flex_row()
             .items_center()
-            .gap(px(6.0))
+            .gap(px(2.0))
             .min_w(px(0.0));
 
         if show_actions {
-            let button = |id: &'static str,
-                          label: &'static str,
-                          action: ScriptGenerationAction|
-             -> AnyElement {
-                div()
-                    .id(format!("chat-script-generation-{}", id))
-                    .px(px(8.0))
-                    .py(px(2.0))
-                    .rounded(px(6.0))
-                    .bg(button_bg)
-                    .cursor_pointer()
-                    .hover(move |d| d.bg(button_hover_bg))
-                    .text_xs()
-                    .font_weight(gpui::FontWeight::MEDIUM)
-                    .text_color(rgb(colors.text_primary))
-                    .child(label)
-                    .on_click(cx.listener(move |this, _event, _window, cx| {
-                        this.handle_script_generation_action(action, cx);
-                    }))
-                    .into_any_element()
-            };
-
             action_container = action_container
-                .child(button("save", "Save", ScriptGenerationAction::Save))
-                .child(button("run", "Run", ScriptGenerationAction::Run))
-                .child(button(
-                    "save-and-run",
-                    "Save and Run",
-                    ScriptGenerationAction::SaveAndRun,
+                .child(self.render_script_generation_footer_button(
+                    "chat-script-generation-save",
+                    "Save",
+                    None,
+                    ScriptGenerationAction::Save,
+                    footer_colors.accent,
+                    footer_colors.text_muted,
+                    cx,
+                ))
+                .child(self.render_script_generation_footer_button(
+                    "chat-script-generation-run",
+                    "Run",
+                    None,
+                    ScriptGenerationAction::Run,
+                    footer_colors.accent,
+                    footer_colors.text_muted,
+                    cx,
                 ));
         }
 

file update:
diff --git a/src/prompts/chat/render_core.rs b/src/prompts/chat/render_core.rs
index 59f504a9b2cf341109463f106d0bc4b8979101f9..88414695ecec80c875f6009851a22e17b486e724
--- a/src/prompts/chat/render_core.rs
+++ b/src/prompts/chat/render_core.rs
@@ -5,7 +5,7 @@
         &self,
         id: &'static str,
         label: &'static str,
-        shortcut: &'static str,
+        shortcut: Option<&'static str>,
         accent_color: u32,
         muted_color: u32,
     ) -> AnyElement {
@@ -20,10 +20,42 @@
             .rounded(px(4.0))
             .cursor_default()
             .child(div().text_xs().text_color(rgb(accent_color)).child(label))
-            .child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            .when_some(shortcut, |d, shortcut| {
+                d.child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            })
             .into_any_element()
     }
 
+    fn render_script_generation_footer_button(
+        &self,
+        id: &'static str,
+        label: &'static str,
+        shortcut: Option<&'static str>,
+        action: ScriptGenerationAction,
+        accent_color: u32,
+        muted_color: u32,
+        cx: &mut Context<Self>,
+    ) -> AnyElement {
+        div()
+            .id(id)
+            .flex()
+            .flex_row()
+            .items_center()
+            .gap(px(6.0))
+            .px(px(8.0))
+            .py(px(2.0))
+            .rounded(px(4.0))
+            .cursor_pointer()
+            .child(div().text_xs().text_color(rgb(accent_color)).child(label))
+            .when_some(shortcut, |d, shortcut| {
+                d.child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            })
+            .on_click(cx.listener(move |this, _event, _window, cx| {
+                this.handle_script_generation_action(action, cx);
+            }))
+            .into_any_element()
+    }
+
     fn render_footer(&self, cx: &mut Context<Self>) -> impl IntoElement {
         let footer_colors = PromptFooterColors::from_theme(&self.theme);
         let footer_bg = rgba(crate::components::prompt_footer::footer_surface_rgba(
@@ -40,11 +72,59 @@
                 .into_any_element()
         };
 
-        let mut right_side = div().flex().flex_row().items_center().min_w(px(0.));
-        if let Some(script_actions) = self.render_script_generation_footer_actions(cx) {
-            right_side = right_side.child(script_actions).child(divider());
+        let mut left_side = div()
+            .flex()
+            .flex_row()
+            .items_center()
+            .gap(px(8.0))
+            .flex_1()
+            .min_w(px(0.0))
+            .overflow_hidden()
+            .child(
+                svg()
+                    .external_path(crate::utils::get_logo_path())
+                    .size(px(16.0))
+                    .ml(px(2.0))
+                    .text_color(rgb(footer_colors.accent)),
+            )
+            .child(
+                div()
+                    .max_w(px(420.0))
+                    .overflow_hidden()
+                    .text_ellipsis()
+                    .whitespace_nowrap()
+                    .text_xs()
+                    .text_color(rgb(footer_colors.accent))
+                    .child(model_text),
+            );
+
+        if self.script_generation_mode {
+            if let Some(script_actions) = self.render_script_generation_footer_actions(cx) {
+                left_side = left_side.child(divider()).child(script_actions);
+            }
         }
 
+        let mut right_side = div().flex().flex_row().items_center().min_w(px(0.));
+        let primary_button = if self.script_generation_mode {
+            self.render_script_generation_footer_button(
+                "chat-footer-primary-button",
+                "Save and Run",
+                None,
+                ScriptGenerationAction::SaveAndRun,
+                footer_colors.accent,
+                footer_colors.text_muted,
+                cx,
+            )
+        } else {
+            self.render_footer_button(
+                "chat-footer-primary-button",
+                "Continue in Chat",
+                Some("⌘↵"),
+                footer_colors.accent,
+                footer_colors.text_muted,
+            )
+        };
+
         right_side = right_side
             .child(
                 div()
@@ -53,18 +133,12 @@
                     .child("Shift+Enter newline"),
             )
             .child(divider())
-            .child(self.render_footer_button(
-                "chat-footer-primary-button",
-                "Continue in Chat",
-                "⌘↵",
-                footer_colors.accent,
-                footer_colors.text_muted,
-            ))
+            .child(primary_button)
             .child(divider())
             .child(self.render_footer_button(
                 "chat-footer-secondary-button",
                 "Actions",
-                "⌘K",
+                Some("⌘K"),
                 footer_colors.accent,
                 footer_colors.text_muted,
             ));
@@ -87,33 +161,7 @@
             .border_t_1()
             .border_color(rgba((footer_colors.border << 8) | 0x50))
             .bg(footer_bg)
-            .child(
-                div()
-                    .flex()
-                    .flex_row()
-                    .items_center()
-                    .gap(px(8.0))
-                    .flex_1()
-                    .min_w(px(0.0))
-                    .overflow_hidden()
-                    .child(
-                        svg()
-                            .external_path(crate::utils::get_logo_path())
-                            .size(px(16.0))
-                            .ml(px(2.0))
-                            .text_color(rgb(footer_colors.accent)),
-                    )
-                    .child(
-                        div()
-                            .max_w(px(420.0))
-                            .overflow_hidden()
-                            .text_ellipsis()
-                            .whitespace_nowrap()
-                            .text_xs()
-                            .text_color(rgb(footer_colors.accent))
-                            .child(model_text),
-                    ),
-            )
+            .child(left_side)
             .child(right_side)
     }
 
@@ -128,49 +176,36 @@
             return None;
         }
 
-        let colors = &self.prompt_colors;
         let theme_colors = &self.theme.colors;
-        let button_bg = theme::hover_overlay_bg(&self.theme, 0x24);
-        let button_hover_bg = theme::hover_overlay_bg(&self.theme, 0x36);
+        let footer_colors = PromptFooterColors::from_theme(&self.theme);
 
         let mut action_container = div()
             .id("chat-script-generation-footer-actions")
             .flex()
             .flex_row()
             .items_center()
-            .gap(px(6.0))
+            .gap(px(2.0))
             .min_w(px(0.0));
 
         if show_actions {
-            let button = |id: &'static str,
-                          label: &'static str,
-                          action: ScriptGenerationAction|
-             -> AnyElement {
-                div()
-                    .id(format!("chat-script-generation-{}", id))
-                    .px(px(8.0))
-                    .py(px(2.0))
-                    .rounded(px(6.0))
-                    .bg(button_bg)
-                    .cursor_pointer()
-                    .hover(move |d| d.bg(button_hover_bg))
-                    .text_xs()
-                    .font_weight(gpui::FontWeight::MEDIUM)
-                    .text_color(rgb(colors.text_primary))
-                    .child(label)
-                    .on_click(cx.listener(move |this, _event, _window, cx| {
-                        this.handle_script_generation_action(action, cx);
-                    }))
-                    .into_any_element()
-            };
-
             action_container = action_container
-                .child(button("save", "Save", ScriptGenerationAction::Save))
-                .child(button("run", "Run", ScriptGenerationAction::Run))
-                .child(button(
-                    "save-and-run",
-                    "Save and Run",
-                    ScriptGenerationAction::SaveAndRun,
+                .child(self.render_script_generation_footer_button(
+                    "chat-script-generation-save",
+                    "Save",
+                    None,
+                    ScriptGenerationAction::Save,
+                    footer_colors.accent,
+                    footer_colors.text_muted,
+                    cx,
+                ))
+                .child(self.render_script_generation_footer_button(
+                    "chat-script-generation-run",
+                    "Run",
+                    None,
+                    ScriptGenerationAction::Run,
+                    footer_colors.accent,
+                    footer_colors.text_muted,
+                    cx,
                 ));
         }
 


thinking
**Inspecting conditional snippet**
exec
/bin/zsh -lc "nl -ba src/prompts/chat/render_core.rs | sed -n '166,235p'" in /Users/johnlindquist/dev/script-kit-gpui succeeded in 52ms:
   166	    }
   167	
   168	    fn render_script_generation_footer_actions(
   169	        &self,
   170	        cx: &mut Context<Self>,
   171	    ) -> Option<AnyElement> {
   172	        let show_actions = self.should_show_script_generation_actions();
   173	        let status_message = self.script_generation_status.clone();
   174	
   175	        if !show_actions && status_message.is_none() {
   176	            return None;
   177	        }
   178	
   179	        let theme_colors = &self.theme.colors;
   180	        let footer_colors = PromptFooterColors::from_theme(&self.theme);
   181	
   182	        let mut action_container = div()
   183	            .id("chat-script-generation-footer-actions")
   184	            .flex()
   185	            .flex_row()
file update:
diff --git a/src/prompts/chat/render_core.rs b/src/prompts/chat/render_core.rs
index 59f504a9b2cf341109463f106d0bc4b8979101f9..88414695ecec80c875f6009851a22e17b486e724
--- a/src/prompts/chat/render_core.rs
+++ b/src/prompts/chat/render_core.rs
@@ -5,7 +5,7 @@
         &self,
         id: &'static str,
         label: &'static str,
-        shortcut: &'static str,
+        shortcut: Option<&'static str>,
         accent_color: u32,
         muted_color: u32,
     ) -> AnyElement {
@@ -20,10 +20,42 @@
             .rounded(px(4.0))
             .cursor_default()
             .child(div().text_xs().text_color(rgb(accent_color)).child(label))
-            .child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            .when_some(shortcut, |d, shortcut| {
+                d.child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            })
             .into_any_element()
     }
 
+    fn render_script_generation_footer_button(
+        &self,
+        id: &'static str,
+        label: &'static str,
+        shortcut: Option<&'static str>,
+        action: ScriptGenerationAction,
+        accent_color: u32,
+        muted_color: u32,
+        cx: &mut Context<Self>,
+    ) -> AnyElement {
+        div()
+            .id(id)
+            .flex()
+            .flex_row()
+            .items_center()
+            .gap(px(6.0))
+            .px(px(8.0))
+            .py(px(2.0))
+            .rounded(px(4.0))
+            .cursor_pointer()
+            .child(div().text_xs().text_color(rgb(accent_color)).child(label))
+            .when_some(shortcut, |d, shortcut| {
+                d.child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            })
+            .on_click(cx.listener(move |this, _event, _window, cx| {
+                this.handle_script_generation_action(action, cx);
+            }))
+            .into_any_element()
+    }
+
     fn render_footer(&self, cx: &mut Context<Self>) -> impl IntoElement {
         let footer_colors = PromptFooterColors::from_theme(&self.theme);
         let footer_bg = rgba(crate::components::prompt_footer::footer_surface_rgba(
@@ -40,11 +72,59 @@
                 .into_any_element()
         };
 
-        let mut right_side = div().flex().flex_row().items_center().min_w(px(0.));
-        if let Some(script_actions) = self.render_script_generation_footer_actions(cx) {
-            right_side = right_side.child(script_actions).child(divider());
+        let mut left_side = div()
+            .flex()
+            .flex_row()
+            .items_center()
+            .gap(px(8.0))
+            .flex_1()
+            .min_w(px(0.0))
+            .overflow_hidden()
+            .child(
+                svg()
+                    .external_path(crate::utils::get_logo_path())
+                    .size(px(16.0))
+                    .ml(px(2.0))
+                    .text_color(rgb(footer_colors.accent)),
+            )
+            .child(
+                div()
+                    .max_w(px(420.0))
+                    .overflow_hidden()
+                    .text_ellipsis()
+                    .whitespace_nowrap()
+                    .text_xs()
+                    .text_color(rgb(footer_colors.accent))
+                    .child(model_text),
+            );
+
+        if self.script_generation_mode {
+            if let Some(script_actions) = self.render_script_generation_footer_actions(cx) {
+                left_side = left_side.child(divider()).child(script_actions);
+            }
         }
 
+        let mut right_side = div().flex().flex_row().items_center().min_w(px(0.));
+        let primary_button = if self.script_generation_mode {
+            self.render_script_generation_footer_button(
+                "chat-footer-primary-button",
+                "Save and Run",
+                None,
+                ScriptGenerationAction::SaveAndRun,
+                footer_colors.accent,
+                footer_colors.text_muted,
+                cx,
+            )
+        } else {
+            self.render_footer_button(
+                "chat-footer-primary-button",
+                "Continue in Chat",
+                Some("⌘↵"),
+                footer_colors.accent,
+                footer_colors.text_muted,
+            )
+        };
+
         right_side = right_side
             .child(
                 div()
@@ -53,18 +133,12 @@
                     .child("Shift+Enter newline"),
             )
             .child(divider())
-            .child(self.render_footer_button(
-                "chat-footer-primary-button",
-                "Continue in Chat",
-                "⌘↵",
-                footer_colors.accent,
-                footer_colors.text_muted,
-            ))
+            .child(primary_button)
             .child(divider())
             .child(self.render_footer_button(
                 "chat-footer-secondary-button",
                 "Actions",
-                "⌘K",
+                Some("⌘K"),
                 footer_colors.accent,
                 footer_colors.text_muted,
             ));
@@ -87,33 +161,7 @@
             .border_t_1()
             .border_color(rgba((footer_colors.border << 8) | 0x50))
             .bg(footer_bg)
-            .child(
-                div()
-                    .flex()
-                    .flex_row()
-                    .items_center()
-                    .gap(px(8.0))
-                    .flex_1()
-                    .min_w(px(0.0))
-                    .overflow_hidden()
-                    .child(
-                        svg()
-                            .external_path(crate::utils::get_logo_path())
-                            .size(px(16.0))
-                            .ml(px(2.0))
-                            .text_color(rgb(footer_colors.accent)),
-                    )
-                    .child(
-                        div()
-                            .max_w(px(420.0))
-                            .overflow_hidden()
-                            .text_ellipsis()
-                            .whitespace_nowrap()
-                            .text_xs()
-                            .text_color(rgb(footer_colors.accent))
-                            .child(model_text),
-                    ),
-            )
+            .child(left_side)
             .child(right_side)
     }
 
@@ -128,49 +176,36 @@
             return None;
         }
 
-        let colors = &self.prompt_colors;
         let theme_colors = &self.theme.colors;
-        let button_bg = theme::hover_overlay_bg(&self.theme, 0x24);
-        let button_hover_bg = theme::hover_overlay_bg(&self.theme, 0x36);
+        let footer_colors = PromptFooterColors::from_theme(&self.theme);
 
         let mut action_container = div()
             .id("chat-script-generation-footer-actions")
             .flex()
             .flex_row()
             .items_center()
-            .gap(px(6.0))
+            .gap(px(2.0))
             .min_w(px(0.0));
 
         if show_actions {
-            let button = |id: &'static str,
-                          label: &'static str,
-                          action: ScriptGenerationAction|
-             -> AnyElement {
-                div()
-                    .id(format!("chat-script-generation-{}", id))
-                    .px(px(8.0))
-                    .py(px(2.0))
-                    .rounded(px(6.0))
-                    .bg(button_bg)
-                    .cursor_pointer()
-                    .hover(move |d| d.bg(button_hover_bg))
-                    .text_xs()
-                    .font_weight(gpui::FontWeight::MEDIUM)
-                    .text_color(rgb(colors.text_primary))
-                    .child(label)
-                    .on_click(cx.listener(move |this, _event, _window, cx| {
-                        this.handle_script_generation_action(action, cx);
-                    }))
-                    .into_any_element()
-            };
-
             action_container = action_container
-                .child(button("save", "Save", ScriptGenerationAction::Save))
-                .child(button("run", "Run", ScriptGenerationAction::Run))
-                .child(button(
-                    "save-and-run",
-                    "Save and Run",
-                    ScriptGenerationAction::SaveAndRun,
+                .child(self.render_script_generation_footer_button(
+                    "chat-script-generation-save",
+                    "Save",
+                    None,
+                    ScriptGenerationAction::Save,
+                    footer_colors.accent,
+                    footer_colors.text_muted,
+                    cx,
+                ))
+                .child(self.render_script_generation_footer_button(
+                    "chat-script-generation-run",
+                    "Run",
+                    None,
+                    ScriptGenerationAction::Run,
+                    footer_colors.accent,
+                    footer_colors.text_muted,
+                    cx,
                 ));
         }
 


thinking
**Updating dynamic footer comment**
file update
M /Users/johnlindquist/dev/script-kit-gpui/src/prompts/chat/render_core.rs
@@ -597,3 +597,3 @@
             .child(messages_content)
-            // Footer with model selector, Continue in Chat, and Actions
+            // Footer with model selector and footer actions
             .child(self.render_footer(cx))
apply_patch(auto_approved=true) exited 0 in 13ms:
Success. Updated the following files:
M src/prompts/chat/render_core.rs
file update:
diff --git a/src/prompts/chat/render_core.rs b/src/prompts/chat/render_core.rs
index 59f504a9b2cf341109463f106d0bc4b8979101f9..dac1210f313c7cedabf3756d5012ab7dd260eb58
--- a/src/prompts/chat/render_core.rs
+++ b/src/prompts/chat/render_core.rs
@@ -5,7 +5,7 @@
         &self,
         id: &'static str,
         label: &'static str,
-        shortcut: &'static str,
+        shortcut: Option<&'static str>,
         accent_color: u32,
         muted_color: u32,
     ) -> AnyElement {
@@ -20,7 +20,39 @@
             .rounded(px(4.0))
             .cursor_default()
             .child(div().text_xs().text_color(rgb(accent_color)).child(label))
-            .child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            .when_some(shortcut, |d, shortcut| {
+                d.child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            })
+            .into_any_element()
+    }
+
+    fn render_script_generation_footer_button(
+        &self,
+        id: &'static str,
+        label: &'static str,
+        shortcut: Option<&'static str>,
+        action: ScriptGenerationAction,
+        accent_color: u32,
+        muted_color: u32,
+        cx: &mut Context<Self>,
+    ) -> AnyElement {
+        div()
+            .id(id)
+            .flex()
+            .flex_row()
+            .items_center()
+            .gap(px(6.0))
+            .px(px(8.0))
+            .py(px(2.0))
+            .rounded(px(4.0))
+            .cursor_pointer()
+            .child(div().text_xs().text_color(rgb(accent_color)).child(label))
+            .when_some(shortcut, |d, shortcut| {
+                d.child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            })
+            .on_click(cx.listener(move |this, _event, _window, cx| {
+                this.handle_script_generation_action(action, cx);
+            }))
             .into_any_element()
     }
 
@@ -40,11 +72,59 @@
                 .into_any_element()
         };
 
-        let mut right_side = div().flex().flex_row().items_center().min_w(px(0.));
-        if let Some(script_actions) = self.render_script_generation_footer_actions(cx) {
-            right_side = right_side.child(script_actions).child(divider());
+        let mut left_side = div()
+            .flex()
+            .flex_row()
+            .items_center()
+            .gap(px(8.0))
+            .flex_1()
+            .min_w(px(0.0))
+            .overflow_hidden()
+            .child(
+                svg()
+                    .external_path(crate::utils::get_logo_path())
+                    .size(px(16.0))
+                    .ml(px(2.0))
+                    .text_color(rgb(footer_colors.accent)),
+            )
+            .child(
+                div()
+                    .max_w(px(420.0))
+                    .overflow_hidden()
+                    .text_ellipsis()
+                    .whitespace_nowrap()
+                    .text_xs()
+                    .text_color(rgb(footer_colors.accent))
+                    .child(model_text),
+            );
+
+        if self.script_generation_mode {
+            if let Some(script_actions) = self.render_script_generation_footer_actions(cx) {
+                left_side = left_side.child(divider()).child(script_actions);
+            }
         }
 
+        let mut right_side = div().flex().flex_row().items_center().min_w(px(0.));
+        let primary_button = if self.script_generation_mode {
+            self.render_script_generation_footer_button(
+                "chat-footer-primary-button",
+                "Save and Run",
+                None,
+                ScriptGenerationAction::SaveAndRun,
+                footer_colors.accent,
+                footer_colors.text_muted,
+                cx,
+            )
+        } else {
+            self.render_footer_button(
+                "chat-footer-primary-button",
+                "Continue in Chat",
+                Some("⌘↵"),
+                footer_colors.accent,
+                footer_colors.text_muted,
+            )
+        };
+
         right_side = right_side
             .child(
                 div()
@@ -53,18 +133,12 @@
                     .child("Shift+Enter newline"),
             )
             .child(divider())
-            .child(self.render_footer_button(
-                "chat-footer-primary-button",
-                "Continue in Chat",
-                "⌘↵",
-                footer_colors.accent,
-                footer_colors.text_muted,
-            ))
+            .child(primary_button)
             .child(divider())
             .child(self.render_footer_button(
                 "chat-footer-secondary-button",
                 "Actions",
-                "⌘K",
+                Some("⌘K"),
                 footer_colors.accent,
                 footer_colors.text_muted,
             ));
@@ -87,33 +161,7 @@
             .border_t_1()
             .border_color(rgba((footer_colors.border << 8) | 0x50))
             .bg(footer_bg)
-            .child(
-                div()
-                    .flex()
-                    .flex_row()
-                    .items_center()
-                    .gap(px(8.0))
-                    .flex_1()
-                    .min_w(px(0.0))
-                    .overflow_hidden()
-                    .child(
-                        svg()
-                            .external_path(crate::utils::get_logo_path())
-                            .size(px(16.0))
-                            .ml(px(2.0))
-                            .text_color(rgb(footer_colors.accent)),
-                    )
-                    .child(
-                        div()
-                            .max_w(px(420.0))
-                            .overflow_hidden()
-                            .text_ellipsis()
-                            .whitespace_nowrap()
-                            .text_xs()
-                            .text_color(rgb(footer_colors.accent))
-                            .child(model_text),
-                    ),
-            )
+            .child(left_side)
             .child(right_side)
     }
 
@@ -128,49 +176,36 @@
             return None;
         }
 
-        let colors = &self.prompt_colors;
         let theme_colors = &self.theme.colors;
-        let button_bg = theme::hover_overlay_bg(&self.theme, 0x24);
-        let button_hover_bg = theme::hover_overlay_bg(&self.theme, 0x36);
+        let footer_colors = PromptFooterColors::from_theme(&self.theme);
 
         let mut action_container = div()
             .id("chat-script-generation-footer-actions")
             .flex()
             .flex_row()
             .items_center()
-            .gap(px(6.0))
+            .gap(px(2.0))
             .min_w(px(0.0));
 
         if show_actions {
-            let button = |id: &'static str,
-                          label: &'static str,
-                          action: ScriptGenerationAction|
-             -> AnyElement {
-                div()
-                    .id(format!("chat-script-generation-{}", id))
-                    .px(px(8.0))
-                    .py(px(2.0))
-                    .rounded(px(6.0))
-                    .bg(button_bg)
-                    .cursor_pointer()
-                    .hover(move |d| d.bg(button_hover_bg))
-                    .text_xs()
-                    .font_weight(gpui::FontWeight::MEDIUM)
-                    .text_color(rgb(colors.text_primary))
-                    .child(label)
-                    .on_click(cx.listener(move |this, _event, _window, cx| {
-                        this.handle_script_generation_action(action, cx);
-                    }))
-                    .into_any_element()
-            };
-
             action_container = action_container
-                .child(button("save", "Save", ScriptGenerationAction::Save))
-                .child(button("run", "Run", ScriptGenerationAction::Run))
-                .child(button(
-                    "save-and-run",
-                    "Save and Run",
-                    ScriptGenerationAction::SaveAndRun,
+                .child(self.render_script_generation_footer_button(
+                    "chat-script-generation-save",
+                    "Save",
+                    None,
+                    ScriptGenerationAction::Save,
+                    footer_colors.accent,
+                    footer_colors.text_muted,
+                    cx,
+                ))
+                .child(self.render_script_generation_footer_button(
+                    "chat-script-generation-run",
+                    "Run",
+                    None,
+                    ScriptGenerationAction::Run,
+                    footer_colors.accent,
+                    footer_colors.text_muted,
+                    cx,
                 ));
         }
 
@@ -560,7 +595,7 @@
             .child(input_area)
             // Scrollable message area
             .child(messages_content)
-            // Footer with model selector, Continue in Chat, and Actions
+            // Footer with model selector and footer actions
             .child(self.render_footer(cx))
             // Note: Actions menu is now handled by parent via on_show_actions callback
             // The parent opens the standard ActionsDialog window

file update:
diff --git a/src/prompts/chat/render_core.rs b/src/prompts/chat/render_core.rs
index 59f504a9b2cf341109463f106d0bc4b8979101f9..dac1210f313c7cedabf3756d5012ab7dd260eb58
--- a/src/prompts/chat/render_core.rs
+++ b/src/prompts/chat/render_core.rs
@@ -5,7 +5,7 @@
         &self,
         id: &'static str,
         label: &'static str,
-        shortcut: &'static str,
+        shortcut: Option<&'static str>,
         accent_color: u32,
         muted_color: u32,
     ) -> AnyElement {
@@ -20,7 +20,39 @@
             .rounded(px(4.0))
             .cursor_default()
             .child(div().text_xs().text_color(rgb(accent_color)).child(label))
-            .child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            .when_some(shortcut, |d, shortcut| {
+                d.child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            })
+            .into_any_element()
+    }
+
+    fn render_script_generation_footer_button(
+        &self,
+        id: &'static str,
+        label: &'static str,
+        shortcut: Option<&'static str>,
+        action: ScriptGenerationAction,
+        accent_color: u32,
+        muted_color: u32,
+        cx: &mut Context<Self>,
+    ) -> AnyElement {
+        div()
+            .id(id)
+            .flex()
+            .flex_row()
+            .items_center()
+            .gap(px(6.0))
+            .px(px(8.0))
+            .py(px(2.0))
+            .rounded(px(4.0))
+            .cursor_pointer()
+            .child(div().text_xs().text_color(rgb(accent_color)).child(label))
+            .when_some(shortcut, |d, shortcut| {
+                d.child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            })
+            .on_click(cx.listener(move |this, _event, _window, cx| {
+                this.handle_script_generation_action(action, cx);
+            }))
             .into_any_element()
     }
 
@@ -40,11 +72,59 @@
                 .into_any_element()
         };
 
-        let mut right_side = div().flex().flex_row().items_center().min_w(px(0.));
-        if let Some(script_actions) = self.render_script_generation_footer_actions(cx) {
-            right_side = right_side.child(script_actions).child(divider());
+        let mut left_side = div()
+            .flex()
+            .flex_row()
+            .items_center()
+            .gap(px(8.0))
+            .flex_1()
+            .min_w(px(0.0))
+            .overflow_hidden()
+            .child(
+                svg()
+                    .external_path(crate::utils::get_logo_path())
+                    .size(px(16.0))
+                    .ml(px(2.0))
+                    .text_color(rgb(footer_colors.accent)),
+            )
+            .child(
+                div()
+                    .max_w(px(420.0))
+                    .overflow_hidden()
+                    .text_ellipsis()
+                    .whitespace_nowrap()
+                    .text_xs()
+                    .text_color(rgb(footer_colors.accent))
+                    .child(model_text),
+            );
+
+        if self.script_generation_mode {
+            if let Some(script_actions) = self.render_script_generation_footer_actions(cx) {
+                left_side = left_side.child(divider()).child(script_actions);
+            }
         }
 
+        let mut right_side = div().flex().flex_row().items_center().min_w(px(0.));
+        let primary_button = if self.script_generation_mode {
+            self.render_script_generation_footer_button(
+                "chat-footer-primary-button",
+                "Save and Run",
+                None,
+                ScriptGenerationAction::SaveAndRun,
+                footer_colors.accent,
+                footer_colors.text_muted,
+                cx,
+            )
+        } else {
+            self.render_footer_button(
+                "chat-footer-primary-button",
+                "Continue in Chat",
+                Some("⌘↵"),
+                footer_colors.accent,
+                footer_colors.text_muted,
+            )
+        };
+
         right_side = right_side
             .child(
                 div()
@@ -53,18 +133,12 @@
                     .child("Shift+Enter newline"),
             )
             .child(divider())
-            .child(self.render_footer_button(
-                "chat-footer-primary-button",
-                "Continue in Chat",
-                "⌘↵",
-                footer_colors.accent,
-                footer_colors.text_muted,
-            ))
+            .child(primary_button)
             .child(divider())
             .child(self.render_footer_button(
                 "chat-footer-secondary-button",
                 "Actions",
-                "⌘K",
+                Some("⌘K"),
                 footer_colors.accent,
                 footer_colors.text_muted,
             ));
@@ -87,33 +161,7 @@
             .border_t_1()
             .border_color(rgba((footer_colors.border << 8) | 0x50))
             .bg(footer_bg)
-            .child(
-                div()
-                    .flex()
-                    .flex_row()
-                    .items_center()
-                    .gap(px(8.0))
-                    .flex_1()
-                    .min_w(px(0.0))
-                    .overflow_hidden()
-                    .child(
-                        svg()
-                            .external_path(crate::utils::get_logo_path())
-                            .size(px(16.0))
-                            .ml(px(2.0))
-                            .text_color(rgb(footer_colors.accent)),
-                    )
-                    .child(
-                        div()
-                            .max_w(px(420.0))
-                            .overflow_hidden()
-                            .text_ellipsis()
-                            .whitespace_nowrap()
-                            .text_xs()
-                            .text_color(rgb(footer_colors.accent))
-                            .child(model_text),
-                    ),
-            )
+            .child(left_side)
             .child(right_side)
     }
 
@@ -128,49 +176,36 @@
             return None;
         }
 
-        let colors = &self.prompt_colors;
         let theme_colors = &self.theme.colors;
-        let button_bg = theme::hover_overlay_bg(&self.theme, 0x24);
-        let button_hover_bg = theme::hover_overlay_bg(&self.theme, 0x36);
+        let footer_colors = PromptFooterColors::from_theme(&self.theme);
 
         let mut action_container = div()
             .id("chat-script-generation-footer-actions")
             .flex()
             .flex_row()
             .items_center()
-            .gap(px(6.0))
+            .gap(px(2.0))
             .min_w(px(0.0));
 
         if show_actions {
-            let button = |id: &'static str,
-                          label: &'static str,
-                          action: ScriptGenerationAction|
-             -> AnyElement {
-                div()
-                    .id(format!("chat-script-generation-{}", id))
-                    .px(px(8.0))
-                    .py(px(2.0))
-                    .rounded(px(6.0))
-                    .bg(button_bg)
-                    .cursor_pointer()
-                    .hover(move |d| d.bg(button_hover_bg))
-                    .text_xs()
-                    .font_weight(gpui::FontWeight::MEDIUM)
-                    .text_color(rgb(colors.text_primary))
-                    .child(label)
-                    .on_click(cx.listener(move |this, _event, _window, cx| {
-                        this.handle_script_generation_action(action, cx);
-                    }))
-                    .into_any_element()
-            };
-
             action_container = action_container
-                .child(button("save", "Save", ScriptGenerationAction::Save))
-                .child(button("run", "Run", ScriptGenerationAction::Run))
-                .child(button(
-                    "save-and-run",
-                    "Save and Run",
-                    ScriptGenerationAction::SaveAndRun,
+                .child(self.render_script_generation_footer_button(
+                    "chat-script-generation-save",
+                    "Save",
+                    None,
+                    ScriptGenerationAction::Save,
+                    footer_colors.accent,
+                    footer_colors.text_muted,
+                    cx,
+                ))
+                .child(self.render_script_generation_footer_button(
+                    "chat-script-generation-run",
+                    "Run",
+                    None,
+                    ScriptGenerationAction::Run,
+                    footer_colors.accent,
+                    footer_colors.text_muted,
+                    cx,
                 ));
         }
 
@@ -560,7 +595,7 @@
             .child(input_area)
             // Scrollable message area
             .child(messages_content)
-            // Footer with model selector, Continue in Chat, and Actions
+            // Footer with model selector and footer actions
             .child(self.render_footer(cx))
             // Note: Actions menu is now handled by parent via on_show_actions callback
             // The parent opens the standard ActionsDialog window


thinking
**Adding pattern-based unit tests**
codex
I’ve completed the behavior change in `render_core.rs`; before verification I’m adding focused unit tests in the same file to lock in the new primary-button replacement and secondary Save/Run-only footer behavior.
file update
M /Users/johnlindquist/dev/script-kit-gpui/src/prompts/chat/render_core.rs
@@ -604 +604,47 @@
 }
+
+#[cfg(test)]
+mod render_core_footer_tests {
+    use std::fs;
+
+    #[test]
+    fn test_script_generation_mode_replaces_continue_with_save_and_run_primary_button() {
+        let content = fs::read_to_string("src/prompts/chat/render_core.rs")
+            .expect("Failed to read src/prompts/chat/render_core.rs");
+        let normalized: String = content.chars().filter(|c| !c.is_whitespace()).collect();
+
+        assert!(
+            normalized.contains("letprimary_button=ifself.script_generation_mode{"),
+            "Footer primary action should branch on script_generation_mode"
+        );
+        assert!(
+            normalized.contains("\"chat-footer-primary-button\",\"SaveandRun\",None,ScriptGenerationAction::SaveAndRun,"),
+            "Script generation mode should render Save and Run as the primary footer action"
+        );
+        assert!(
+            normalized.contains(
+                "}else{self.render_footer_button(\"chat-footer-primary-button\",\"ContinueinChat\",Some(\"⌘↵\"),"
+            ),
+            "Non-script mode should keep Continue in Chat as the primary footer action"
+        );
+    }
+
+    #[test]
+    fn test_script_generation_secondary_footer_actions_render_save_and_run_only() {
+        let content = fs::read_to_string("src/prompts/chat/render_core.rs")
+            .expect("Failed to read src/prompts/chat/render_core.rs");
+
+        assert!(
+            content.contains("\"chat-script-generation-save\""),
+            "Script generation footer should render Save action"
+        );
+        assert!(
+            content.contains("\"chat-script-generation-run\""),
+            "Script generation footer should render Run action"
+        );
+        assert!(
+            !content.contains("\"chat-script-generation-save-and-run\""),
+            "Save and Run should only appear as the primary footer action slot"
+        );
+    }
+}
apply_patch(auto_approved=true) exited 0 in 13ms:
Success. Updated the following files:
M src/prompts/chat/render_core.rs
file update:
diff --git a/src/prompts/chat/render_core.rs b/src/prompts/chat/render_core.rs
index 59f504a9b2cf341109463f106d0bc4b8979101f9..4e91d2d0ed474e69c143cd50e58e0491df58450b
--- a/src/prompts/chat/render_core.rs
+++ b/src/prompts/chat/render_core.rs
@@ -5,7 +5,7 @@
         &self,
         id: &'static str,
         label: &'static str,
-        shortcut: &'static str,
+        shortcut: Option<&'static str>,
         accent_color: u32,
         muted_color: u32,
     ) -> AnyElement {
@@ -20,10 +20,42 @@
             .rounded(px(4.0))
             .cursor_default()
             .child(div().text_xs().text_color(rgb(accent_color)).child(label))
-            .child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            .when_some(shortcut, |d, shortcut| {
+                d.child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            })
             .into_any_element()
     }
 
+    fn render_script_generation_footer_button(
+        &self,
+        id: &'static str,
+        label: &'static str,
+        shortcut: Option<&'static str>,
+        action: ScriptGenerationAction,
+        accent_color: u32,
+        muted_color: u32,
+        cx: &mut Context<Self>,
+    ) -> AnyElement {
+        div()
+            .id(id)
+            .flex()
+            .flex_row()
+            .items_center()
+            .gap(px(6.0))
+            .px(px(8.0))
+            .py(px(2.0))
+            .rounded(px(4.0))
+            .cursor_pointer()
+            .child(div().text_xs().text_color(rgb(accent_color)).child(label))
+            .when_some(shortcut, |d, shortcut| {
+                d.child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            })
+            .on_click(cx.listener(move |this, _event, _window, cx| {
+                this.handle_script_generation_action(action, cx);
+            }))
+            .into_any_element()
+    }
+
     fn render_footer(&self, cx: &mut Context<Self>) -> impl IntoElement {
         let footer_colors = PromptFooterColors::from_theme(&self.theme);
         let footer_bg = rgba(crate::components::prompt_footer::footer_surface_rgba(
@@ -40,11 +72,59 @@
                 .into_any_element()
         };
 
-        let mut right_side = div().flex().flex_row().items_center().min_w(px(0.));
-        if let Some(script_actions) = self.render_script_generation_footer_actions(cx) {
-            right_side = right_side.child(script_actions).child(divider());
+        let mut left_side = div()
+            .flex()
+            .flex_row()
+            .items_center()
+            .gap(px(8.0))
+            .flex_1()
+            .min_w(px(0.0))
+            .overflow_hidden()
+            .child(
+                svg()
+                    .external_path(crate::utils::get_logo_path())
+                    .size(px(16.0))
+                    .ml(px(2.0))
+                    .text_color(rgb(footer_colors.accent)),
+            )
+            .child(
+                div()
+                    .max_w(px(420.0))
+                    .overflow_hidden()
+                    .text_ellipsis()
+                    .whitespace_nowrap()
+                    .text_xs()
+                    .text_color(rgb(footer_colors.accent))
+                    .child(model_text),
+            );
+
+        if self.script_generation_mode {
+            if let Some(script_actions) = self.render_script_generation_footer_actions(cx) {
+                left_side = left_side.child(divider()).child(script_actions);
+            }
         }
 
+        let mut right_side = div().flex().flex_row().items_center().min_w(px(0.));
+        let primary_button = if self.script_generation_mode {
+            self.render_script_generation_footer_button(
+                "chat-footer-primary-button",
+                "Save and Run",
+                None,
+                ScriptGenerationAction::SaveAndRun,
+                footer_colors.accent,
+                footer_colors.text_muted,
+                cx,
+            )
+        } else {
+            self.render_footer_button(
+                "chat-footer-primary-button",
+                "Continue in Chat",
+                Some("⌘↵"),
+                footer_colors.accent,
+                footer_colors.text_muted,
+            )
+        };
+
         right_side = right_side
             .child(
                 div()
@@ -53,18 +133,12 @@
                     .child("Shift+Enter newline"),
             )
             .child(divider())
-            .child(self.render_footer_button(
-                "chat-footer-primary-button",
-                "Continue in Chat",
-                "⌘↵",
-                footer_colors.accent,
-                footer_colors.text_muted,
-            ))
+            .child(primary_button)
             .child(divider())
             .child(self.render_footer_button(
                 "chat-footer-secondary-button",
                 "Actions",
-                "⌘K",
+                Some("⌘K"),
                 footer_colors.accent,
                 footer_colors.text_muted,
             ));
@@ -87,33 +161,7 @@
             .border_t_1()
             .border_color(rgba((footer_colors.border << 8) | 0x50))
             .bg(footer_bg)
-            .child(
-                div()
-                    .flex()
-                    .flex_row()
-                    .items_center()
-                    .gap(px(8.0))
-                    .flex_1()
-                    .min_w(px(0.0))
-                    .overflow_hidden()
-                    .child(
-                        svg()
-                            .external_path(crate::utils::get_logo_path())
-                            .size(px(16.0))
-                            .ml(px(2.0))
-                            .text_color(rgb(footer_colors.accent)),
-                    )
-                    .child(
-                        div()
-                            .max_w(px(420.0))
-                            .overflow_hidden()
-                            .text_ellipsis()
-                            .whitespace_nowrap()
-                            .text_xs()
-                            .text_color(rgb(footer_colors.accent))
-                            .child(model_text),
-                    ),
-            )
+            .child(left_side)
             .child(right_side)
     }
 
@@ -128,49 +176,36 @@
             return None;
         }
 
-        let colors = &self.prompt_colors;
         let theme_colors = &self.theme.colors;
-        let button_bg = theme::hover_overlay_bg(&self.theme, 0x24);
-        let button_hover_bg = theme::hover_overlay_bg(&self.theme, 0x36);
+        let footer_colors = PromptFooterColors::from_theme(&self.theme);
 
         let mut action_container = div()
             .id("chat-script-generation-footer-actions")
             .flex()
             .flex_row()
             .items_center()
-            .gap(px(6.0))
+            .gap(px(2.0))
             .min_w(px(0.0));
 
         if show_actions {
-            let button = |id: &'static str,
-                          label: &'static str,
-                          action: ScriptGenerationAction|
-             -> AnyElement {
-                div()
-                    .id(format!("chat-script-generation-{}", id))
-                    .px(px(8.0))
-                    .py(px(2.0))
-                    .rounded(px(6.0))
-                    .bg(button_bg)
-                    .cursor_pointer()
-                    .hover(move |d| d.bg(button_hover_bg))
-                    .text_xs()
-                    .font_weight(gpui::FontWeight::MEDIUM)
-                    .text_color(rgb(colors.text_primary))
-                    .child(label)
-                    .on_click(cx.listener(move |this, _event, _window, cx| {
-                        this.handle_script_generation_action(action, cx);
-                    }))
-                    .into_any_element()
-            };
-
             action_container = action_container
-                .child(button("save", "Save", ScriptGenerationAction::Save))
-                .child(button("run", "Run", ScriptGenerationAction::Run))
-                .child(button(
-                    "save-and-run",
-                    "Save and Run",
-                    ScriptGenerationAction::SaveAndRun,
+                .child(self.render_script_generation_footer_button(
+                    "chat-script-generation-save",
+                    "Save",
+                    None,
+                    ScriptGenerationAction::Save,
+                    footer_colors.accent,
+                    footer_colors.text_muted,
+                    cx,
+                ))
+                .child(self.render_script_generation_footer_button(
+                    "chat-script-generation-run",
+                    "Run",
+                    None,
+                    ScriptGenerationAction::Run,
+                    footer_colors.accent,
+                    footer_colors.text_muted,
+                    cx,
                 ));
         }
 
@@ -560,10 +595,56 @@
             .child(input_area)
             // Scrollable message area
             .child(messages_content)
-            // Footer with model selector, Continue in Chat, and Actions
+            // Footer with model selector and footer actions
             .child(self.render_footer(cx))
             // Note: Actions menu is now handled by parent via on_show_actions callback
             // The parent opens the standard ActionsDialog window
             .into_any_element()
     }
 }
+
+#[cfg(test)]
+mod render_core_footer_tests {
+    use std::fs;
+
+    #[test]
+    fn test_script_generation_mode_replaces_continue_with_save_and_run_primary_button() {
+        let content = fs::read_to_string("src/prompts/chat/render_core.rs")
+            .expect("Failed to read src/prompts/chat/render_core.rs");
+        let normalized: String = content.chars().filter(|c| !c.is_whitespace()).collect();
+
+        assert!(
+            normalized.contains("letprimary_button=ifself.script_generation_mode{"),
+            "Footer primary action should branch on script_generation_mode"
+        );
+        assert!(
+            normalized.contains("\"chat-footer-primary-button\",\"SaveandRun\",None,ScriptGenerationAction::SaveAndRun,"),
+            "Script generation mode should render Save and Run as the primary footer action"
+        );
+        assert!(
+            normalized.contains(
+                "}else{self.render_footer_button(\"chat-footer-primary-button\",\"ContinueinChat\",Some(\"⌘↵\"),"
+            ),
+            "Non-script mode should keep Continue in Chat as the primary footer action"
+        );
+    }
+
+    #[test]
+    fn test_script_generation_secondary_footer_actions_render_save_and_run_only() {
+        let content = fs::read_to_string("src/prompts/chat/render_core.rs")
+            .expect("Failed to read src/prompts/chat/render_core.rs");
+
+        assert!(
+            content.contains("\"chat-script-generation-save\""),
+            "Script generation footer should render Save action"
+        );
+        assert!(
+            content.contains("\"chat-script-generation-run\""),
+            "Script generation footer should render Run action"
+        );
+        assert!(
+            !content.contains("\"chat-script-generation-save-and-run\""),
+            "Save and Run should only appear as the primary footer action slot"
+        );
+    }
+}

file update:
diff --git a/src/prompts/chat/render_core.rs b/src/prompts/chat/render_core.rs
index 59f504a9b2cf341109463f106d0bc4b8979101f9..4e91d2d0ed474e69c143cd50e58e0491df58450b
--- a/src/prompts/chat/render_core.rs
+++ b/src/prompts/chat/render_core.rs
@@ -5,7 +5,7 @@
         &self,
         id: &'static str,
         label: &'static str,
-        shortcut: &'static str,
+        shortcut: Option<&'static str>,
         accent_color: u32,
         muted_color: u32,
     ) -> AnyElement {
@@ -20,10 +20,42 @@
             .rounded(px(4.0))
             .cursor_default()
             .child(div().text_xs().text_color(rgb(accent_color)).child(label))
-            .child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            .when_some(shortcut, |d, shortcut| {
+                d.child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            })
             .into_any_element()
     }
 
+    fn render_script_generation_footer_button(
+        &self,
+        id: &'static str,
+        label: &'static str,
+        shortcut: Option<&'static str>,
+        action: ScriptGenerationAction,
+        accent_color: u32,
+        muted_color: u32,
+        cx: &mut Context<Self>,
+    ) -> AnyElement {
+        div()
+            .id(id)
+            .flex()
+            .flex_row()
+            .items_center()
+            .gap(px(6.0))
+            .px(px(8.0))
+            .py(px(2.0))
+            .rounded(px(4.0))
+            .cursor_pointer()
+            .child(div().text_xs().text_color(rgb(accent_color)).child(label))
+            .when_some(shortcut, |d, shortcut| {
+                d.child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            })
+            .on_click(cx.listener(move |this, _event, _window, cx| {
+                this.handle_script_generation_action(action, cx);
+            }))
+            .into_any_element()
+    }
+
     fn render_footer(&self, cx: &mut Context<Self>) -> impl IntoElement {
         let footer_colors = PromptFooterColors::from_theme(&self.theme);
         let footer_bg = rgba(crate::components::prompt_footer::footer_surface_rgba(
@@ -40,11 +72,59 @@
                 .into_any_element()
         };
 
-        let mut right_side = div().flex().flex_row().items_center().min_w(px(0.));
-        if let Some(script_actions) = self.render_script_generation_footer_actions(cx) {
-            right_side = right_side.child(script_actions).child(divider());
+        let mut left_side = div()
+            .flex()
+            .flex_row()
+            .items_center()
+            .gap(px(8.0))
+            .flex_1()
+            .min_w(px(0.0))
+            .overflow_hidden()
+            .child(
+                svg()
+                    .external_path(crate::utils::get_logo_path())
+                    .size(px(16.0))
+                    .ml(px(2.0))
+                    .text_color(rgb(footer_colors.accent)),
+            )
+            .child(
+                div()
+                    .max_w(px(420.0))
+                    .overflow_hidden()
+                    .text_ellipsis()
+                    .whitespace_nowrap()
+                    .text_xs()
+                    .text_color(rgb(footer_colors.accent))
+                    .child(model_text),
+            );
+
+        if self.script_generation_mode {
+            if let Some(script_actions) = self.render_script_generation_footer_actions(cx) {
+                left_side = left_side.child(divider()).child(script_actions);
+            }
         }
 
+        let mut right_side = div().flex().flex_row().items_center().min_w(px(0.));
+        let primary_button = if self.script_generation_mode {
+            self.render_script_generation_footer_button(
+                "chat-footer-primary-button",
+                "Save and Run",
+                None,
+                ScriptGenerationAction::SaveAndRun,
+                footer_colors.accent,
+                footer_colors.text_muted,
+                cx,
+            )
+        } else {
+            self.render_footer_button(
+                "chat-footer-primary-button",
+                "Continue in Chat",
+                Some("⌘↵"),
+                footer_colors.accent,
+                footer_colors.text_muted,
+            )
+        };
+
         right_side = right_side
             .child(
                 div()
@@ -53,18 +133,12 @@
                     .child("Shift+Enter newline"),
             )
             .child(divider())
-            .child(self.render_footer_button(
-                "chat-footer-primary-button",
-                "Continue in Chat",
-                "⌘↵",
-                footer_colors.accent,
-                footer_colors.text_muted,
-            ))
+            .child(primary_button)
             .child(divider())
             .child(self.render_footer_button(
                 "chat-footer-secondary-button",
                 "Actions",
-                "⌘K",
+                Some("⌘K"),
                 footer_colors.accent,
                 footer_colors.text_muted,
             ));
@@ -87,33 +161,7 @@
             .border_t_1()
             .border_color(rgba((footer_colors.border << 8) | 0x50))
             .bg(footer_bg)
-            .child(
-                div()
-                    .flex()
-                    .flex_row()
-                    .items_center()
-                    .gap(px(8.0))
-                    .flex_1()
-                    .min_w(px(0.0))
-                    .overflow_hidden()
-                    .child(
-                        svg()
-                            .external_path(crate::utils::get_logo_path())
-                            .size(px(16.0))
-                            .ml(px(2.0))
-                            .text_color(rgb(footer_colors.accent)),
-                    )
-                    .child(
-                        div()
-                            .max_w(px(420.0))
-                            .overflow_hidden()
-                            .text_ellipsis()
-                            .whitespace_nowrap()
-                            .text_xs()
-                            .text_color(rgb(footer_colors.accent))
-                            .child(model_text),
-                    ),
-            )
+            .child(left_side)
             .child(right_side)
     }
 
@@ -128,49 +176,36 @@
             return None;
         }
 
-        let colors = &self.prompt_colors;
         let theme_colors = &self.theme.colors;
-        let button_bg = theme::hover_overlay_bg(&self.theme, 0x24);
-        let button_hover_bg = theme::hover_overlay_bg(&self.theme, 0x36);
+        let footer_colors = PromptFooterColors::from_theme(&self.theme);
 
         let mut action_container = div()
             .id("chat-script-generation-footer-actions")
             .flex()
             .flex_row()
             .items_center()
-            .gap(px(6.0))
+            .gap(px(2.0))
             .min_w(px(0.0));
 
         if show_actions {
-            let button = |id: &'static str,
-                          label: &'static str,
-                          action: ScriptGenerationAction|
-             -> AnyElement {
-                div()
-                    .id(format!("chat-script-generation-{}", id))
-                    .px(px(8.0))
-                    .py(px(2.0))
-                    .rounded(px(6.0))
-                    .bg(button_bg)
-                    .cursor_pointer()
-                    .hover(move |d| d.bg(button_hover_bg))
-                    .text_xs()
-                    .font_weight(gpui::FontWeight::MEDIUM)
-                    .text_color(rgb(colors.text_primary))
-                    .child(label)
-                    .on_click(cx.listener(move |this, _event, _window, cx| {
-                        this.handle_script_generation_action(action, cx);
-                    }))
-                    .into_any_element()
-            };
-
             action_container = action_container
-                .child(button("save", "Save", ScriptGenerationAction::Save))
-                .child(button("run", "Run", ScriptGenerationAction::Run))
-                .child(button(
-                    "save-and-run",
-                    "Save and Run",
-                    ScriptGenerationAction::SaveAndRun,
+                .child(self.render_script_generation_footer_button(
+                    "chat-script-generation-save",
+                    "Save",
+                    None,
+                    ScriptGenerationAction::Save,
+                    footer_colors.accent,
+                    footer_colors.text_muted,
+                    cx,
+                ))
+                .child(self.render_script_generation_footer_button(
+                    "chat-script-generation-run",
+                    "Run",
+                    None,
+                    ScriptGenerationAction::Run,
+                    footer_colors.accent,
+                    footer_colors.text_muted,
+                    cx,
                 ));
         }
 
@@ -560,10 +595,56 @@
             .child(input_area)
             // Scrollable message area
             .child(messages_content)
-            // Footer with model selector, Continue in Chat, and Actions
+            // Footer with model selector and footer actions
             .child(self.render_footer(cx))
             // Note: Actions menu is now handled by parent via on_show_actions callback
             // The parent opens the standard ActionsDialog window
             .into_any_element()
     }
 }
+
+#[cfg(test)]
+mod render_core_footer_tests {
+    use std::fs;
+
+    #[test]
+    fn test_script_generation_mode_replaces_continue_with_save_and_run_primary_button() {
+        let content = fs::read_to_string("src/prompts/chat/render_core.rs")
+            .expect("Failed to read src/prompts/chat/render_core.rs");
+        let normalized: String = content.chars().filter(|c| !c.is_whitespace()).collect();
+
+        assert!(
+            normalized.contains("letprimary_button=ifself.script_generation_mode{"),
+            "Footer primary action should branch on script_generation_mode"
+        );
+        assert!(
+            normalized.contains("\"chat-footer-primary-button\",\"SaveandRun\",None,ScriptGenerationAction::SaveAndRun,"),
+            "Script generation mode should render Save and Run as the primary footer action"
+        );
+        assert!(
+            normalized.contains(
+                "}else{self.render_footer_button(\"chat-footer-primary-button\",\"ContinueinChat\",Some(\"⌘↵\"),"
+            ),
+            "Non-script mode should keep Continue in Chat as the primary footer action"
+        );
+    }
+
+    #[test]
+    fn test_script_generation_secondary_footer_actions_render_save_and_run_only() {
+        let content = fs::read_to_string("src/prompts/chat/render_core.rs")
+            .expect("Failed to read src/prompts/chat/render_core.rs");
+
+        assert!(
+            content.contains("\"chat-script-generation-save\""),
+            "Script generation footer should render Save action"
+        );
+        assert!(
+            content.contains("\"chat-script-generation-run\""),
+            "Script generation footer should render Run action"
+        );
+        assert!(
+            !content.contains("\"chat-script-generation-save-and-run\""),
+            "Save and Run should only appear as the primary footer action slot"
+        );
+    }
+}


thinking
**Verifying package name for targeted checking**
exec
/bin/zsh -lc 'rg -n "''^name'"\\s*=\\s*\\\"\" Cargo.toml" in /Users/johnlindquist/dev/script-kit-gpui succeeded in 50ms:
2:name = "script-kit-gpui"
8:name = "script_kit_gpui"
12:name = "script-kit-gpui"
17:name = "smoke-test"
22:name = "storybook"
177:name = "Script Kit"
file update:
diff --git a/src/prompts/chat/render_core.rs b/src/prompts/chat/render_core.rs
index 59f504a9b2cf341109463f106d0bc4b8979101f9..4e91d2d0ed474e69c143cd50e58e0491df58450b
--- a/src/prompts/chat/render_core.rs
+++ b/src/prompts/chat/render_core.rs
@@ -5,7 +5,7 @@
         &self,
         id: &'static str,
         label: &'static str,
-        shortcut: &'static str,
+        shortcut: Option<&'static str>,
         accent_color: u32,
         muted_color: u32,
     ) -> AnyElement {
@@ -20,10 +20,42 @@
             .rounded(px(4.0))
             .cursor_default()
             .child(div().text_xs().text_color(rgb(accent_color)).child(label))
-            .child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            .when_some(shortcut, |d, shortcut| {
+                d.child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            })
             .into_any_element()
     }
 
+    fn render_script_generation_footer_button(
+        &self,
+        id: &'static str,
+        label: &'static str,
+        shortcut: Option<&'static str>,
+        action: ScriptGenerationAction,
+        accent_color: u32,
+        muted_color: u32,
+        cx: &mut Context<Self>,
+    ) -> AnyElement {
+        div()
+            .id(id)
+            .flex()
+            .flex_row()
+            .items_center()
+            .gap(px(6.0))
+            .px(px(8.0))
+            .py(px(2.0))
+            .rounded(px(4.0))
+            .cursor_pointer()
+            .child(div().text_xs().text_color(rgb(accent_color)).child(label))
+            .when_some(shortcut, |d, shortcut| {
+                d.child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            })
+            .on_click(cx.listener(move |this, _event, _window, cx| {
+                this.handle_script_generation_action(action, cx);
+            }))
+            .into_any_element()
+    }
+
     fn render_footer(&self, cx: &mut Context<Self>) -> impl IntoElement {
         let footer_colors = PromptFooterColors::from_theme(&self.theme);
         let footer_bg = rgba(crate::components::prompt_footer::footer_surface_rgba(
@@ -40,11 +72,59 @@
                 .into_any_element()
         };
 
-        let mut right_side = div().flex().flex_row().items_center().min_w(px(0.));
-        if let Some(script_actions) = self.render_script_generation_footer_actions(cx) {
-            right_side = right_side.child(script_actions).child(divider());
+        let mut left_side = div()
+            .flex()
+            .flex_row()
+            .items_center()
+            .gap(px(8.0))
+            .flex_1()
+            .min_w(px(0.0))
+            .overflow_hidden()
+            .child(
+                svg()
+                    .external_path(crate::utils::get_logo_path())
+                    .size(px(16.0))
+                    .ml(px(2.0))
+                    .text_color(rgb(footer_colors.accent)),
+            )
+            .child(
+                div()
+                    .max_w(px(420.0))
+                    .overflow_hidden()
+                    .text_ellipsis()
+                    .whitespace_nowrap()
+                    .text_xs()
+                    .text_color(rgb(footer_colors.accent))
+                    .child(model_text),
+            );
+
+        if self.script_generation_mode {
+            if let Some(script_actions) = self.render_script_generation_footer_actions(cx) {
+                left_side = left_side.child(divider()).child(script_actions);
+            }
         }
 
+        let mut right_side = div().flex().flex_row().items_center().min_w(px(0.));
+        let primary_button = if self.script_generation_mode {
+            self.render_script_generation_footer_button(
+                "chat-footer-primary-button",
+                "Save and Run",
+                None,
+                ScriptGenerationAction::SaveAndRun,
+                footer_colors.accent,
+                footer_colors.text_muted,
+                cx,
+            )
+        } else {
+            self.render_footer_button(
+                "chat-footer-primary-button",
+                "Continue in Chat",
+                Some("⌘↵"),
+                footer_colors.accent,
+                footer_colors.text_muted,
+            )
+        };
+
         right_side = right_side
             .child(
                 div()
@@ -53,18 +133,12 @@
                     .child("Shift+Enter newline"),
             )
             .child(divider())
-            .child(self.render_footer_button(
-                "chat-footer-primary-button",
-                "Continue in Chat",
-                "⌘↵",
-                footer_colors.accent,
-                footer_colors.text_muted,
-            ))
+            .child(primary_button)
             .child(divider())
             .child(self.render_footer_button(
                 "chat-footer-secondary-button",
                 "Actions",
-                "⌘K",
+                Some("⌘K"),
                 footer_colors.accent,
                 footer_colors.text_muted,
             ));
@@ -87,33 +161,7 @@
             .border_t_1()
             .border_color(rgba((footer_colors.border << 8) | 0x50))
             .bg(footer_bg)
-            .child(
-                div()
-                    .flex()
-                    .flex_row()
-                    .items_center()
-                    .gap(px(8.0))
-                    .flex_1()
-                    .min_w(px(0.0))
-                    .overflow_hidden()
-                    .child(
-                        svg()
-                            .external_path(crate::utils::get_logo_path())
-                            .size(px(16.0))
-                            .ml(px(2.0))
-                            .text_color(rgb(footer_colors.accent)),
-                    )
-                    .child(
-                        div()
-                            .max_w(px(420.0))
-                            .overflow_hidden()
-                            .text_ellipsis()
-                            .whitespace_nowrap()
-                            .text_xs()
-                            .text_color(rgb(footer_colors.accent))
-                            .child(model_text),
-                    ),
-            )
+            .child(left_side)
             .child(right_side)
     }
 
@@ -128,49 +176,36 @@
             return None;
         }
 
-        let colors = &self.prompt_colors;
         let theme_colors = &self.theme.colors;
-        let button_bg = theme::hover_overlay_bg(&self.theme, 0x24);
-        let button_hover_bg = theme::hover_overlay_bg(&self.theme, 0x36);
+        let footer_colors = PromptFooterColors::from_theme(&self.theme);
 
         let mut action_container = div()
             .id("chat-script-generation-footer-actions")
             .flex()
             .flex_row()
             .items_center()
-            .gap(px(6.0))
+            .gap(px(2.0))
             .min_w(px(0.0));
 
         if show_actions {
-            let button = |id: &'static str,
-                          label: &'static str,
-                          action: ScriptGenerationAction|
-             -> AnyElement {
-                div()
-                    .id(format!("chat-script-generation-{}", id))
-                    .px(px(8.0))
-                    .py(px(2.0))
-                    .rounded(px(6.0))
-                    .bg(button_bg)
-                    .cursor_pointer()
-                    .hover(move |d| d.bg(button_hover_bg))
-                    .text_xs()
-                    .font_weight(gpui::FontWeight::MEDIUM)
-                    .text_color(rgb(colors.text_primary))
-                    .child(label)
-                    .on_click(cx.listener(move |this, _event, _window, cx| {
-                        this.handle_script_generation_action(action, cx);
-                    }))
-                    .into_any_element()
-            };
-
             action_container = action_container
-                .child(button("save", "Save", ScriptGenerationAction::Save))
-                .child(button("run", "Run", ScriptGenerationAction::Run))
-                .child(button(
-                    "save-and-run",
-                    "Save and Run",
-                    ScriptGenerationAction::SaveAndRun,
+                .child(self.render_script_generation_footer_button(
+                    "chat-script-generation-save",
+                    "Save",
+                    None,
+                    ScriptGenerationAction::Save,
+                    footer_colors.accent,
+                    footer_colors.text_muted,
+                    cx,
+                ))
+                .child(self.render_script_generation_footer_button(
+                    "chat-script-generation-run",
+                    "Run",
+                    None,
+                    ScriptGenerationAction::Run,
+                    footer_colors.accent,
+                    footer_colors.text_muted,
+                    cx,
                 ));
         }
 
@@ -560,10 +595,56 @@
             .child(input_area)
             // Scrollable message area
             .child(messages_content)
-            // Footer with model selector, Continue in Chat, and Actions
+            // Footer with model selector and footer actions
             .child(self.render_footer(cx))
             // Note: Actions menu is now handled by parent via on_show_actions callback
             // The parent opens the standard ActionsDialog window
             .into_any_element()
     }
 }
+
+#[cfg(test)]
+mod render_core_footer_tests {
+    use std::fs;
+
+    #[test]
+    fn test_script_generation_mode_replaces_continue_with_save_and_run_primary_button() {
+        let content = fs::read_to_string("src/prompts/chat/render_core.rs")
+            .expect("Failed to read src/prompts/chat/render_core.rs");
+        let normalized: String = content.chars().filter(|c| !c.is_whitespace()).collect();
+
+        assert!(
+            normalized.contains("letprimary_button=ifself.script_generation_mode{"),
+            "Footer primary action should branch on script_generation_mode"
+        );
+        assert!(
+            normalized.contains("\"chat-footer-primary-button\",\"SaveandRun\",None,ScriptGenerationAction::SaveAndRun,"),
+            "Script generation mode should render Save and Run as the primary footer action"
+        );
+        assert!(
+            normalized.contains(
+                "}else{self.render_footer_button(\"chat-footer-primary-button\",\"ContinueinChat\",Some(\"⌘↵\"),"
+            ),
+            "Non-script mode should keep Continue in Chat as the primary footer action"
+        );
+    }
+
+    #[test]
+    fn test_script_generation_secondary_footer_actions_render_save_and_run_only() {
+        let content = fs::read_to_string("src/prompts/chat/render_core.rs")
+            .expect("Failed to read src/prompts/chat/render_core.rs");
+
+        assert!(
+            content.contains("\"chat-script-generation-save\""),
+            "Script generation footer should render Save action"
+        );
+        assert!(
+            content.contains("\"chat-script-generation-run\""),
+            "Script generation footer should render Run action"
+        );
+        assert!(
+            !content.contains("\"chat-script-generation-save-and-run\""),
+            "Save and Run should only appear as the primary footer action slot"
+        );
+    }
+}


thinking
**Planning scoped checks and tests**
codex
I’ve finished the code edits and added focused tests in `render_core.rs`. Next I’m running scoped verification: `cargo check -p script-kit-gpui`, then targeted tests for the new footer behavior.
exec
/bin/zsh -lc 'cargo check -p script-kit-gpui' in /Users/johnlindquist/dev/script-kit-gpuiexec
/bin/zsh -lc 'cargo test -p script-kit-gpui render_core_footer_tests -- --nocapture' in /Users/johnlindquist/dev/script-kit-gpuifile update:
diff --git a/src/prompts/chat/render_core.rs b/src/prompts/chat/render_core.rs
index 59f504a9b2cf341109463f106d0bc4b8979101f9..4e91d2d0ed474e69c143cd50e58e0491df58450b
--- a/src/prompts/chat/render_core.rs
+++ b/src/prompts/chat/render_core.rs
@@ -5,7 +5,7 @@
         &self,
         id: &'static str,
         label: &'static str,
-        shortcut: &'static str,
+        shortcut: Option<&'static str>,
         accent_color: u32,
         muted_color: u32,
     ) -> AnyElement {
@@ -20,10 +20,42 @@
             .rounded(px(4.0))
             .cursor_default()
             .child(div().text_xs().text_color(rgb(accent_color)).child(label))
-            .child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            .when_some(shortcut, |d, shortcut| {
+                d.child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            })
             .into_any_element()
     }
 
+    fn render_script_generation_footer_button(
+        &self,
+        id: &'static str,
+        label: &'static str,
+        shortcut: Option<&'static str>,
+        action: ScriptGenerationAction,
+        accent_color: u32,
+        muted_color: u32,
+        cx: &mut Context<Self>,
+    ) -> AnyElement {
+        div()
+            .id(id)
+            .flex()
+            .flex_row()
+            .items_center()
+            .gap(px(6.0))
+            .px(px(8.0))
+            .py(px(2.0))
+            .rounded(px(4.0))
+            .cursor_pointer()
+            .child(div().text_xs().text_color(rgb(accent_color)).child(label))
+            .when_some(shortcut, |d, shortcut| {
+                d.child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            })
+            .on_click(cx.listener(move |this, _event, _window, cx| {
+                this.handle_script_generation_action(action, cx);
+            }))
+            .into_any_element()
+    }
+
     fn render_footer(&self, cx: &mut Context<Self>) -> impl IntoElement {
         let footer_colors = PromptFooterColors::from_theme(&self.theme);
         let footer_bg = rgba(crate::components::prompt_footer::footer_surface_rgba(
@@ -40,11 +72,59 @@
                 .into_any_element()
         };
 
-        let mut right_side = div().flex().flex_row().items_center().min_w(px(0.));
-        if let Some(script_actions) = self.render_script_generation_footer_actions(cx) {
-            right_side = right_side.child(script_actions).child(divider());
+        let mut left_side = div()
+            .flex()
+            .flex_row()
+            .items_center()
+            .gap(px(8.0))
+            .flex_1()
+            .min_w(px(0.0))
+            .overflow_hidden()
+            .child(
+                svg()
+                    .external_path(crate::utils::get_logo_path())
+                    .size(px(16.0))
+                    .ml(px(2.0))
+                    .text_color(rgb(footer_colors.accent)),
+            )
+            .child(
+                div()
+                    .max_w(px(420.0))
+                    .overflow_hidden()
+                    .text_ellipsis()
+                    .whitespace_nowrap()
+                    .text_xs()
+                    .text_color(rgb(footer_colors.accent))
+                    .child(model_text),
+            );
+
+        if self.script_generation_mode {
+            if let Some(script_actions) = self.render_script_generation_footer_actions(cx) {
+                left_side = left_side.child(divider()).child(script_actions);
+            }
         }
 
+        let mut right_side = div().flex().flex_row().items_center().min_w(px(0.));
+        let primary_button = if self.script_generation_mode {
+            self.render_script_generation_footer_button(
+                "chat-footer-primary-button",
+                "Save and Run",
+                None,
+                ScriptGenerationAction::SaveAndRun,
+                footer_colors.accent,
+                footer_colors.text_muted,
+                cx,
+            )
+        } else {
+            self.render_footer_button(
+                "chat-footer-primary-button",
+                "Continue in Chat",
+                Some("⌘↵"),
+                footer_colors.accent,
+                footer_colors.text_muted,
+            )
+        };
+
         right_side = right_side
             .child(
                 div()
@@ -53,18 +133,12 @@
                     .child("Shift+Enter newline"),
             )
             .child(divider())
-            .child(self.render_footer_button(
-                "chat-footer-primary-button",
-                "Continue in Chat",
-                "⌘↵",
-                footer_colors.accent,
-                footer_colors.text_muted,
-            ))
+            .child(primary_button)
             .child(divider())
             .child(self.render_footer_button(
                 "chat-footer-secondary-button",
                 "Actions",
-                "⌘K",
+                Some("⌘K"),
                 footer_colors.accent,
                 footer_colors.text_muted,
             ));
@@ -87,33 +161,7 @@
             .border_t_1()
             .border_color(rgba((footer_colors.border << 8) | 0x50))
             .bg(footer_bg)
-            .child(
-                div()
-                    .flex()
-                    .flex_row()
-                    .items_center()
-                    .gap(px(8.0))
-                    .flex_1()
-                    .min_w(px(0.0))
-                    .overflow_hidden()
-                    .child(
-                        svg()
-                            .external_path(crate::utils::get_logo_path())
-                            .size(px(16.0))
-                            .ml(px(2.0))
-                            .text_color(rgb(footer_colors.accent)),
-                    )
-                    .child(
-                        div()
-                            .max_w(px(420.0))
-                            .overflow_hidden()
-                            .text_ellipsis()
-                            .whitespace_nowrap()
-                            .text_xs()
-                            .text_color(rgb(footer_colors.accent))
-                            .child(model_text),
-                    ),
-            )
+            .child(left_side)
             .child(right_side)
     }
 
@@ -128,49 +176,36 @@
             return None;
         }
 
-        let colors = &self.prompt_colors;
         let theme_colors = &self.theme.colors;
-        let button_bg = theme::hover_overlay_bg(&self.theme, 0x24);
-        let button_hover_bg = theme::hover_overlay_bg(&self.theme, 0x36);
+        let footer_colors = PromptFooterColors::from_theme(&self.theme);
 
         let mut action_container = div()
             .id("chat-script-generation-footer-actions")
             .flex()
             .flex_row()
             .items_center()
-            .gap(px(6.0))
+            .gap(px(2.0))
             .min_w(px(0.0));
 
         if show_actions {
-            let button = |id: &'static str,
-                          label: &'static str,
-                          action: ScriptGenerationAction|
-             -> AnyElement {
-                div()
-                    .id(format!("chat-script-generation-{}", id))
-                    .px(px(8.0))
-                    .py(px(2.0))
-                    .rounded(px(6.0))
-                    .bg(button_bg)
-                    .cursor_pointer()
-                    .hover(move |d| d.bg(button_hover_bg))
-                    .text_xs()
-                    .font_weight(gpui::FontWeight::MEDIUM)
-                    .text_color(rgb(colors.text_primary))
-                    .child(label)
-                    .on_click(cx.listener(move |this, _event, _window, cx| {
-                        this.handle_script_generation_action(action, cx);
-                    }))
-                    .into_any_element()
-            };
-
             action_container = action_container
-                .child(button("save", "Save", ScriptGenerationAction::Save))
-                .child(button("run", "Run", ScriptGenerationAction::Run))
-                .child(button(
-                    "save-and-run",
-                    "Save and Run",
-                    ScriptGenerationAction::SaveAndRun,
+                .child(self.render_script_generation_footer_button(
+                    "chat-script-generation-save",
+                    "Save",
+                    None,
+                    ScriptGenerationAction::Save,
+                    footer_colors.accent,
+                    footer_colors.text_muted,
+                    cx,
+                ))
+                .child(self.render_script_generation_footer_button(
+                    "chat-script-generation-run",
+                    "Run",
+                    None,
+                    ScriptGenerationAction::Run,
+                    footer_colors.accent,
+                    footer_colors.text_muted,
+                    cx,
                 ));
         }
 
@@ -560,10 +595,56 @@
             .child(input_area)
             // Scrollable message area
             .child(messages_content)
-            // Footer with model selector, Continue in Chat, and Actions
+            // Footer with model selector and footer actions
             .child(self.render_footer(cx))
             // Note: Actions menu is now handled by parent via on_show_actions callback
             // The parent opens the standard ActionsDialog window
             .into_any_element()
     }
 }
+
+#[cfg(test)]
+mod render_core_footer_tests {
+    use std::fs;
+
+    #[test]
+    fn test_script_generation_mode_replaces_continue_with_save_and_run_primary_button() {
+        let content = fs::read_to_string("src/prompts/chat/render_core.rs")
+            .expect("Failed to read src/prompts/chat/render_core.rs");
+        let normalized: String = content.chars().filter(|c| !c.is_whitespace()).collect();
+
+        assert!(
+            normalized.contains("letprimary_button=ifself.script_generation_mode{"),
+            "Footer primary action should branch on script_generation_mode"
+        );
+        assert!(
+            normalized.contains("\"chat-footer-primary-button\",\"SaveandRun\",None,ScriptGenerationAction::SaveAndRun,"),
+            "Script generation mode should render Save and Run as the primary footer action"
+        );
+        assert!(
+            normalized.contains(
+                "}else{self.render_footer_button(\"chat-footer-primary-button\",\"ContinueinChat\",Some(\"⌘↵\"),"
+            ),
+            "Non-script mode should keep Continue in Chat as the primary footer action"
+        );
+    }
+
+    #[test]
+    fn test_script_generation_secondary_footer_actions_render_save_and_run_only() {
+        let content = fs::read_to_string("src/prompts/chat/render_core.rs")
+            .expect("Failed to read src/prompts/chat/render_core.rs");
+
+        assert!(
+            content.contains("\"chat-script-generation-save\""),
+            "Script generation footer should render Save action"
+        );
+        assert!(
+            content.contains("\"chat-script-generation-run\""),
+            "Script generation footer should render Run action"
+        );
+        assert!(
+            !content.contains("\"chat-script-generation-save-and-run\""),
+            "Save and Run should only appear as the primary footer action slot"
+        );
+    }
+}


thinking
**Waiting on build completion**
codex
Build checks are running and currently waiting on shared Cargo locks from parallel agents; I’m polling both sessions and will report exact results as soon as they finish.
 succeeded in 6.93s:
    Blocking waiting for file lock on package cache
    Blocking waiting for file lock on package cache
    Checking script-kit-gpui v0.1.0 (/Users/johnlindquist/dev/script-kit-gpui)
warning: glob import doesn't reexport anything with visibility `pub(in crate::prompts)` because no imported item is public enough
  --> src/prompts/div/mod.rs:32:16
   |
32 | pub(super) use inline::*;
   |                ^^^^^^^^^
   |
note: the most public imported item is `pub(self)`
  --> src/prompts/div/mod.rs:32:16
   |
32 | pub(super) use inline::*;
   |                ^^^^^^^^^
   = help: reduce the glob import's visibility or increase visibility of imported items
   = note: `#[warn(unused_imports)]` (part of `#[warn(unused)]`) on by default

warning: glob import doesn't reexport anything with visibility `pub(in crate::prompts)` because no imported item is public enough
  --> src/prompts/div/mod.rs:34:16
   |
file update:
diff --git a/src/prompts/chat/render_core.rs b/src/prompts/chat/render_core.rs
index 59f504a9b2cf341109463f106d0bc4b8979101f9..4e91d2d0ed474e69c143cd50e58e0491df58450b
--- a/src/prompts/chat/render_core.rs
+++ b/src/prompts/chat/render_core.rs
@@ -5,7 +5,7 @@
         &self,
         id: &'static str,
         label: &'static str,
-        shortcut: &'static str,
+        shortcut: Option<&'static str>,
         accent_color: u32,
         muted_color: u32,
     ) -> AnyElement {
@@ -20,10 +20,42 @@
             .rounded(px(4.0))
             .cursor_default()
             .child(div().text_xs().text_color(rgb(accent_color)).child(label))
-            .child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            .when_some(shortcut, |d, shortcut| {
+                d.child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            })
             .into_any_element()
     }
 
+    fn render_script_generation_footer_button(
+        &self,
+        id: &'static str,
+        label: &'static str,
+        shortcut: Option<&'static str>,
+        action: ScriptGenerationAction,
+        accent_color: u32,
+        muted_color: u32,
+        cx: &mut Context<Self>,
+    ) -> AnyElement {
+        div()
+            .id(id)
+            .flex()
+            .flex_row()
+            .items_center()
+            .gap(px(6.0))
+            .px(px(8.0))
+            .py(px(2.0))
+            .rounded(px(4.0))
+            .cursor_pointer()
+            .child(div().text_xs().text_color(rgb(accent_color)).child(label))
+            .when_some(shortcut, |d, shortcut| {
+                d.child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            })
+            .on_click(cx.listener(move |this, _event, _window, cx| {
+                this.handle_script_generation_action(action, cx);
+            }))
+            .into_any_element()
+    }
+
     fn render_footer(&self, cx: &mut Context<Self>) -> impl IntoElement {
         let footer_colors = PromptFooterColors::from_theme(&self.theme);
         let footer_bg = rgba(crate::components::prompt_footer::footer_surface_rgba(
@@ -40,11 +72,59 @@
                 .into_any_element()
         };
 
-        let mut right_side = div().flex().flex_row().items_center().min_w(px(0.));
-        if let Some(script_actions) = self.render_script_generation_footer_actions(cx) {
-            right_side = right_side.child(script_actions).child(divider());
+        let mut left_side = div()
+            .flex()
+            .flex_row()
+            .items_center()
+            .gap(px(8.0))
+            .flex_1()
+            .min_w(px(0.0))
+            .overflow_hidden()
+            .child(
+                svg()
+                    .external_path(crate::utils::get_logo_path())
+                    .size(px(16.0))
+                    .ml(px(2.0))
+                    .text_color(rgb(footer_colors.accent)),
+            )
+            .child(
+                div()
+                    .max_w(px(420.0))
+                    .overflow_hidden()
+                    .text_ellipsis()
+                    .whitespace_nowrap()
+                    .text_xs()
+                    .text_color(rgb(footer_colors.accent))
+                    .child(model_text),
+            );
+
+        if self.script_generation_mode {
+            if let Some(script_actions) = self.render_script_generation_footer_actions(cx) {
+                left_side = left_side.child(divider()).child(script_actions);
+            }
         }
 
+        let mut right_side = div().flex().flex_row().items_center().min_w(px(0.));
+        let primary_button = if self.script_generation_mode {
+            self.render_script_generation_footer_button(
+                "chat-footer-primary-button",
+                "Save and Run",
+                None,
+                ScriptGenerationAction::SaveAndRun,
+                footer_colors.accent,
+                footer_colors.text_muted,
+                cx,
+            )
+        } else {
+            self.render_footer_button(
+                "chat-footer-primary-button",
+                "Continue in Chat",
+                Some("⌘↵"),
+                footer_colors.accent,
+                footer_colors.text_muted,
+            )
+        };
+
         right_side = right_side
             .child(
                 div()
@@ -53,18 +133,12 @@
                     .child("Shift+Enter newline"),
             )
             .child(divider())
-            .child(self.render_footer_button(
-                "chat-footer-primary-button",
-                "Continue in Chat",
-                "⌘↵",
-                footer_colors.accent,
-                footer_colors.text_muted,
-            ))
+            .child(primary_button)
             .child(divider())
             .child(self.render_footer_button(
                 "chat-footer-secondary-button",
                 "Actions",
-                "⌘K",
+                Some("⌘K"),
                 footer_colors.accent,
                 footer_colors.text_muted,
             ));
@@ -87,33 +161,7 @@
             .border_t_1()
             .border_color(rgba((footer_colors.border << 8) | 0x50))
             .bg(footer_bg)
-            .child(
-                div()
-                    .flex()
-                    .flex_row()
-                    .items_center()
-                    .gap(px(8.0))
-                    .flex_1()
-                    .min_w(px(0.0))
-                    .overflow_hidden()
-                    .child(
-                        svg()
-                            .external_path(crate::utils::get_logo_path())
-                            .size(px(16.0))
-                            .ml(px(2.0))
-                            .text_color(rgb(footer_colors.accent)),
-                    )
-                    .child(
-                        div()
-                            .max_w(px(420.0))
-                            .overflow_hidden()
-                            .text_ellipsis()
-                            .whitespace_nowrap()
-                            .text_xs()
-                            .text_color(rgb(footer_colors.accent))
-                            .child(model_text),
-                    ),
-            )
+            .child(left_side)
             .child(right_side)
     }
 
@@ -128,49 +176,36 @@
             return None;
         }
 
-        let colors = &self.prompt_colors;
         let theme_colors = &self.theme.colors;
-        let button_bg = theme::hover_overlay_bg(&self.theme, 0x24);
-        let button_hover_bg = theme::hover_overlay_bg(&self.theme, 0x36);
+        let footer_colors = PromptFooterColors::from_theme(&self.theme);
 
         let mut action_container = div()
             .id("chat-script-generation-footer-actions")
             .flex()
             .flex_row()
             .items_center()
-            .gap(px(6.0))
+            .gap(px(2.0))
             .min_w(px(0.0));
 
         if show_actions {
-            let button = |id: &'static str,
-                          label: &'static str,
-                          action: ScriptGenerationAction|
-             -> AnyElement {
-                div()
-                    .id(format!("chat-script-generation-{}", id))
-                    .px(px(8.0))
-                    .py(px(2.0))
-                    .rounded(px(6.0))
-                    .bg(button_bg)
-                    .cursor_pointer()
-                    .hover(move |d| d.bg(button_hover_bg))
-                    .text_xs()
-                    .font_weight(gpui::FontWeight::MEDIUM)
-                    .text_color(rgb(colors.text_primary))
-                    .child(label)
-                    .on_click(cx.listener(move |this, _event, _window, cx| {
-                        this.handle_script_generation_action(action, cx);
-                    }))
-                    .into_any_element()
-            };
-
             action_container = action_container
-                .child(button("save", "Save", ScriptGenerationAction::Save))
-                .child(button("run", "Run", ScriptGenerationAction::Run))
-                .child(button(
-                    "save-and-run",
-                    "Save and Run",
-                    ScriptGenerationAction::SaveAndRun,
+                .child(self.render_script_generation_footer_button(
+                    "chat-script-generation-save",
+                    "Save",
+                    None,
+                    ScriptGenerationAction::Save,
+                    footer_colors.accent,
+                    footer_colors.text_muted,
+                    cx,
+                ))
+                .child(self.render_script_generation_footer_button(
+                    "chat-script-generation-run",
+                    "Run",
+                    None,
+                    ScriptGenerationAction::Run,
+                    footer_colors.accent,
+                    footer_colors.text_muted,
+                    cx,
                 ));
         }
 
@@ -560,10 +595,56 @@
             .child(input_area)
             // Scrollable message area
             .child(messages_content)
-            // Footer with model selector, Continue in Chat, and Actions
+            // Footer with model selector and footer actions
             .child(self.render_footer(cx))
             // Note: Actions menu is now handled by parent via on_show_actions callback
             // The parent opens the standard ActionsDialog window
             .into_any_element()
     }
 }
+
+#[cfg(test)]
+mod render_core_footer_tests {
+    use std::fs;
+
+    #[test]
+    fn test_script_generation_mode_replaces_continue_with_save_and_run_primary_button() {
+        let content = fs::read_to_string("src/prompts/chat/render_core.rs")
+            .expect("Failed to read src/prompts/chat/render_core.rs");
+        let normalized: String = content.chars().filter(|c| !c.is_whitespace()).collect();
+
+        assert!(
+            normalized.contains("letprimary_button=ifself.script_generation_mode{"),
+            "Footer primary action should branch on script_generation_mode"
+        );
+        assert!(
+            normalized.contains("\"chat-footer-primary-button\",\"SaveandRun\",None,ScriptGenerationAction::SaveAndRun,"),
+            "Script generation mode should render Save and Run as the primary footer action"
+        );
+        assert!(
+            normalized.contains(
+                "}else{self.render_footer_button(\"chat-footer-primary-button\",\"ContinueinChat\",Some(\"⌘↵\"),"
+            ),
+            "Non-script mode should keep Continue in Chat as the primary footer action"
+        );
+    }
+
+    #[test]
+    fn test_script_generation_secondary_footer_actions_render_save_and_run_only() {
+        let content = fs::read_to_string("src/prompts/chat/render_core.rs")
+            .expect("Failed to read src/prompts/chat/render_core.rs");
+
+        assert!(
+            content.contains("\"chat-script-generation-save\""),
+            "Script generation footer should render Save action"
+        );
+        assert!(
+            content.contains("\"chat-script-generation-run\""),
+            "Script generation footer should render Run action"
+        );
+        assert!(
+            !content.contains("\"chat-script-generation-save-and-run\""),
+            "Save and Run should only appear as the primary footer action slot"
+        );
+    }
+}

 exited 101 in 26.38s:
    Blocking waiting for file lock on package cache
    Blocking waiting for file lock on package cache
    Blocking waiting for file lock on build directory
warning: glob import doesn't reexport anything with visibility `pub(in crate::prompts)` because no imported item is public enough
  --> src/prompts/div/mod.rs:32:16
   |
32 | pub(super) use inline::*;
   |                ^^^^^^^^^
   |
note: the most public imported item is `pub(self)`
  --> src/prompts/div/mod.rs:32:16
   |
32 | pub(super) use inline::*;
   |                ^^^^^^^^^
   = help: reduce the glob import's visibility or increase visibility of imported items
   = note: `#[warn(unused_imports)]` (part of `#[warn(unused)]`) on by default

warning: glob import doesn't reexport anything with visibility `pub(in crate::prompts)` because no imported item is public enough
  --> src/prompts/div/mod.rs:34:16
   |

thinking
**Assessing test scoping conflicts**
file update:
diff --git a/src/prompts/chat/render_core.rs b/src/prompts/chat/render_core.rs
index 59f504a9b2cf341109463f106d0bc4b8979101f9..4e91d2d0ed474e69c143cd50e58e0491df58450b
--- a/src/prompts/chat/render_core.rs
+++ b/src/prompts/chat/render_core.rs
@@ -5,7 +5,7 @@
         &self,
         id: &'static str,
         label: &'static str,
-        shortcut: &'static str,
+        shortcut: Option<&'static str>,
         accent_color: u32,
         muted_color: u32,
     ) -> AnyElement {
@@ -20,10 +20,42 @@
             .rounded(px(4.0))
             .cursor_default()
             .child(div().text_xs().text_color(rgb(accent_color)).child(label))
-            .child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            .when_some(shortcut, |d, shortcut| {
+                d.child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            })
             .into_any_element()
     }
 
+    fn render_script_generation_footer_button(
+        &self,
+        id: &'static str,
+        label: &'static str,
+        shortcut: Option<&'static str>,
+        action: ScriptGenerationAction,
+        accent_color: u32,
+        muted_color: u32,
+        cx: &mut Context<Self>,
+    ) -> AnyElement {
+        div()
+            .id(id)
+            .flex()
+            .flex_row()
+            .items_center()
+            .gap(px(6.0))
+            .px(px(8.0))
+            .py(px(2.0))
+            .rounded(px(4.0))
+            .cursor_pointer()
+            .child(div().text_xs().text_color(rgb(accent_color)).child(label))
+            .when_some(shortcut, |d, shortcut| {
+                d.child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            })
+            .on_click(cx.listener(move |this, _event, _window, cx| {
+                this.handle_script_generation_action(action, cx);
+            }))
+            .into_any_element()
+    }
+
     fn render_footer(&self, cx: &mut Context<Self>) -> impl IntoElement {
         let footer_colors = PromptFooterColors::from_theme(&self.theme);
         let footer_bg = rgba(crate::components::prompt_footer::footer_surface_rgba(
@@ -40,11 +72,59 @@
                 .into_any_element()
         };
 
-        let mut right_side = div().flex().flex_row().items_center().min_w(px(0.));
-        if let Some(script_actions) = self.render_script_generation_footer_actions(cx) {
-            right_side = right_side.child(script_actions).child(divider());
+        let mut left_side = div()
+            .flex()
+            .flex_row()
+            .items_center()
+            .gap(px(8.0))
+            .flex_1()
+            .min_w(px(0.0))
+            .overflow_hidden()
+            .child(
+                svg()
+                    .external_path(crate::utils::get_logo_path())
+                    .size(px(16.0))
+                    .ml(px(2.0))
+                    .text_color(rgb(footer_colors.accent)),
+            )
+            .child(
+                div()
+                    .max_w(px(420.0))
+                    .overflow_hidden()
+                    .text_ellipsis()
+                    .whitespace_nowrap()
+                    .text_xs()
+                    .text_color(rgb(footer_colors.accent))
+                    .child(model_text),
+            );
+
+        if self.script_generation_mode {
+            if let Some(script_actions) = self.render_script_generation_footer_actions(cx) {
+                left_side = left_side.child(divider()).child(script_actions);
+            }
         }
 
+        let mut right_side = div().flex().flex_row().items_center().min_w(px(0.));
+        let primary_button = if self.script_generation_mode {
+            self.render_script_generation_footer_button(
+                "chat-footer-primary-button",
+                "Save and Run",
+                None,
+                ScriptGenerationAction::SaveAndRun,
+                footer_colors.accent,
+                footer_colors.text_muted,
+                cx,
+            )
+        } else {
+            self.render_footer_button(
+                "chat-footer-primary-button",
+                "Continue in Chat",
+                Some("⌘↵"),
+                footer_colors.accent,
+                footer_colors.text_muted,
+            )
+        };
+
         right_side = right_side
             .child(
                 div()
@@ -53,18 +133,12 @@
                     .child("Shift+Enter newline"),
             )
             .child(divider())
-            .child(self.render_footer_button(
-                "chat-footer-primary-button",
-                "Continue in Chat",
-                "⌘↵",
-                footer_colors.accent,
-                footer_colors.text_muted,
-            ))
+            .child(primary_button)
             .child(divider())
             .child(self.render_footer_button(
                 "chat-footer-secondary-button",
                 "Actions",
-                "⌘K",
+                Some("⌘K"),
                 footer_colors.accent,
                 footer_colors.text_muted,
             ));
@@ -87,33 +161,7 @@
             .border_t_1()
             .border_color(rgba((footer_colors.border << 8) | 0x50))
             .bg(footer_bg)
-            .child(
-                div()
-                    .flex()
-                    .flex_row()
-                    .items_center()
-                    .gap(px(8.0))
-                    .flex_1()
-                    .min_w(px(0.0))
-                    .overflow_hidden()
-                    .child(
-                        svg()
-                            .external_path(crate::utils::get_logo_path())
-                            .size(px(16.0))
-                            .ml(px(2.0))
-                            .text_color(rgb(footer_colors.accent)),
-                    )
-                    .child(
-                        div()
-                            .max_w(px(420.0))
-                            .overflow_hidden()
-                            .text_ellipsis()
-                            .whitespace_nowrap()
-                            .text_xs()
-                            .text_color(rgb(footer_colors.accent))
-                            .child(model_text),
-                    ),
-            )
+            .child(left_side)
             .child(right_side)
     }
 
@@ -128,49 +176,36 @@
             return None;
         }
 
-        let colors = &self.prompt_colors;
         let theme_colors = &self.theme.colors;
-        let button_bg = theme::hover_overlay_bg(&self.theme, 0x24);
-        let button_hover_bg = theme::hover_overlay_bg(&self.theme, 0x36);
+        let footer_colors = PromptFooterColors::from_theme(&self.theme);
 
         let mut action_container = div()
             .id("chat-script-generation-footer-actions")
             .flex()
             .flex_row()
             .items_center()
-            .gap(px(6.0))
+            .gap(px(2.0))
             .min_w(px(0.0));
 
         if show_actions {
-            let button = |id: &'static str,
-                          label: &'static str,
-                          action: ScriptGenerationAction|
-             -> AnyElement {
-                div()
-                    .id(format!("chat-script-generation-{}", id))
-                    .px(px(8.0))
-                    .py(px(2.0))
-                    .rounded(px(6.0))
-                    .bg(button_bg)
-                    .cursor_pointer()
-                    .hover(move |d| d.bg(button_hover_bg))
-                    .text_xs()
-                    .font_weight(gpui::FontWeight::MEDIUM)
-                    .text_color(rgb(colors.text_primary))
-                    .child(label)
-                    .on_click(cx.listener(move |this, _event, _window, cx| {
-                        this.handle_script_generation_action(action, cx);
-                    }))
-                    .into_any_element()
-            };
-
             action_container = action_container
-                .child(button("save", "Save", ScriptGenerationAction::Save))
-                .child(button("run", "Run", ScriptGenerationAction::Run))
-                .child(button(
-                    "save-and-run",
-                    "Save and Run",
-                    ScriptGenerationAction::SaveAndRun,
+                .child(self.render_script_generation_footer_button(
+                    "chat-script-generation-save",
+                    "Save",
+                    None,
+                    ScriptGenerationAction::Save,
+                    footer_colors.accent,
+                    footer_colors.text_muted,
+                    cx,
+                ))
+                .child(self.render_script_generation_footer_button(
+                    "chat-script-generation-run",
+                    "Run",
+                    None,
+                    ScriptGenerationAction::Run,
+                    footer_colors.accent,
+                    footer_colors.text_muted,
+                    cx,
                 ));
         }
 
@@ -560,10 +595,56 @@
             .child(input_area)
             // Scrollable message area
             .child(messages_content)
-            // Footer with model selector, Continue in Chat, and Actions
+            // Footer with model selector and footer actions
             .child(self.render_footer(cx))
             // Note: Actions menu is now handled by parent via on_show_actions callback
             // The parent opens the standard ActionsDialog window
             .into_any_element()
     }
 }
+
+#[cfg(test)]
+mod render_core_footer_tests {
+    use std::fs;
+
+    #[test]
+    fn test_script_generation_mode_replaces_continue_with_save_and_run_primary_button() {
+        let content = fs::read_to_string("src/prompts/chat/render_core.rs")
+            .expect("Failed to read src/prompts/chat/render_core.rs");
+        let normalized: String = content.chars().filter(|c| !c.is_whitespace()).collect();
+
+        assert!(
+            normalized.contains("letprimary_button=ifself.script_generation_mode{"),
+            "Footer primary action should branch on script_generation_mode"
+        );
+        assert!(
+            normalized.contains("\"chat-footer-primary-button\",\"SaveandRun\",None,ScriptGenerationAction::SaveAndRun,"),
+            "Script generation mode should render Save and Run as the primary footer action"
+        );
+        assert!(
+            normalized.contains(
+                "}else{self.render_footer_button(\"chat-footer-primary-button\",\"ContinueinChat\",Some(\"⌘↵\"),"
+            ),
+            "Non-script mode should keep Continue in Chat as the primary footer action"
+        );
+    }
+
+    #[test]
+    fn test_script_generation_secondary_footer_actions_render_save_and_run_only() {
+        let content = fs::read_to_string("src/prompts/chat/render_core.rs")
+            .expect("Failed to read src/prompts/chat/render_core.rs");
+
+        assert!(
+            content.contains("\"chat-script-generation-save\""),
+            "Script generation footer should render Save action"
+        );
+        assert!(
+            content.contains("\"chat-script-generation-run\""),
+            "Script generation footer should render Run action"
+        );
+        assert!(
+            !content.contains("\"chat-script-generation-save-and-run\""),
+            "Save and Run should only appear as the primary footer action slot"
+        );
+    }
+}


thinking
**Inspecting diff for errors**
exec
/bin/zsh -lc 'git diff -- src/prompts/chat/render_core.rs src/prompts/chat/prompt.rs' in /Users/johnlindquist/dev/script-kit-gpui succeeded in 52ms:
diff --git a/src/prompts/chat/prompt.rs b/src/prompts/chat/prompt.rs
index c22d02f..4ef4ac1 100644
--- a/src/prompts/chat/prompt.rs
+++ b/src/prompts/chat/prompt.rs
@@ -27,6 +27,7 @@ pub struct ChatPrompt {
     pub(super) provider_registry: Option<ProviderRegistry>,
     pub(super) available_models: Vec<ModelInfo>,
     pub(super) selected_model: Option<ModelInfo>,
+    pub(super) builtin_system_prompt: Option<String>,
     pub(super) builtin_streaming_content: String,
     pub(super) builtin_is_streaming: bool,
     // Word-buffered reveal: full accumulated content from provider and reveal watermark
@@ -48,6 +49,10 @@ pub struct ChatPrompt {
     pub(super) loading_providers: bool,
     // Setup mode: when true, shows API key configuration card instead of chat
     pub(super) needs_setup: bool,
+    // Script generation mode: enables post-response Save/Run actions
+    pub(super) script_generation_mode: bool,
+    pub(super) script_generation_status: Option<String>,
+    pub(super) script_generation_status_is_error: bool,
file update:
diff --git a/src/prompts/chat/render_core.rs b/src/prompts/chat/render_core.rs
index 59f504a9b2cf341109463f106d0bc4b8979101f9..4e91d2d0ed474e69c143cd50e58e0491df58450b
--- a/src/prompts/chat/render_core.rs
+++ b/src/prompts/chat/render_core.rs
@@ -5,7 +5,7 @@
         &self,
         id: &'static str,
         label: &'static str,
-        shortcut: &'static str,
+        shortcut: Option<&'static str>,
         accent_color: u32,
         muted_color: u32,
     ) -> AnyElement {
@@ -20,10 +20,42 @@
             .rounded(px(4.0))
             .cursor_default()
             .child(div().text_xs().text_color(rgb(accent_color)).child(label))
-            .child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            .when_some(shortcut, |d, shortcut| {
+                d.child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            })
             .into_any_element()
     }
 
+    fn render_script_generation_footer_button(
+        &self,
+        id: &'static str,
+        label: &'static str,
+        shortcut: Option<&'static str>,
+        action: ScriptGenerationAction,
+        accent_color: u32,
+        muted_color: u32,
+        cx: &mut Context<Self>,
+    ) -> AnyElement {
+        div()
+            .id(id)
+            .flex()
+            .flex_row()
+            .items_center()
+            .gap(px(6.0))
+            .px(px(8.0))
+            .py(px(2.0))
+            .rounded(px(4.0))
+            .cursor_pointer()
+            .child(div().text_xs().text_color(rgb(accent_color)).child(label))
+            .when_some(shortcut, |d, shortcut| {
+                d.child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            })
+            .on_click(cx.listener(move |this, _event, _window, cx| {
+                this.handle_script_generation_action(action, cx);
+            }))
+            .into_any_element()
+    }
+
     fn render_footer(&self, cx: &mut Context<Self>) -> impl IntoElement {
         let footer_colors = PromptFooterColors::from_theme(&self.theme);
         let footer_bg = rgba(crate::components::prompt_footer::footer_surface_rgba(
@@ -40,11 +72,59 @@
                 .into_any_element()
         };
 
-        let mut right_side = div().flex().flex_row().items_center().min_w(px(0.));
-        if let Some(script_actions) = self.render_script_generation_footer_actions(cx) {
-            right_side = right_side.child(script_actions).child(divider());
+        let mut left_side = div()
+            .flex()
+            .flex_row()
+            .items_center()
+            .gap(px(8.0))
+            .flex_1()
+            .min_w(px(0.0))
+            .overflow_hidden()
+            .child(
+                svg()
+                    .external_path(crate::utils::get_logo_path())
+                    .size(px(16.0))
+                    .ml(px(2.0))
+                    .text_color(rgb(footer_colors.accent)),
+            )
+            .child(
+                div()
+                    .max_w(px(420.0))
+                    .overflow_hidden()
+                    .text_ellipsis()
+                    .whitespace_nowrap()
+                    .text_xs()
+                    .text_color(rgb(footer_colors.accent))
+                    .child(model_text),
+            );
+
+        if self.script_generation_mode {
+            if let Some(script_actions) = self.render_script_generation_footer_actions(cx) {
+                left_side = left_side.child(divider()).child(script_actions);
+            }
         }
 
+        let mut right_side = div().flex().flex_row().items_center().min_w(px(0.));
+        let primary_button = if self.script_generation_mode {
+            self.render_script_generation_footer_button(
+                "chat-footer-primary-button",
+                "Save and Run",
+                None,
+                ScriptGenerationAction::SaveAndRun,
+                footer_colors.accent,
+                footer_colors.text_muted,
+                cx,
+            )
+        } else {
+            self.render_footer_button(
+                "chat-footer-primary-button",
+                "Continue in Chat",
+                Some("⌘↵"),
+                footer_colors.accent,
+                footer_colors.text_muted,
+            )
+        };
+
         right_side = right_side
             .child(
                 div()
@@ -53,18 +133,12 @@
                     .child("Shift+Enter newline"),
             )
             .child(divider())
-            .child(self.render_footer_button(
-                "chat-footer-primary-button",
-                "Continue in Chat",
-                "⌘↵",
-                footer_colors.accent,
-                footer_colors.text_muted,
-            ))
+            .child(primary_button)
             .child(divider())
             .child(self.render_footer_button(
                 "chat-footer-secondary-button",
                 "Actions",
-                "⌘K",
+                Some("⌘K"),
                 footer_colors.accent,
                 footer_colors.text_muted,
             ));
@@ -87,33 +161,7 @@
             .border_t_1()
             .border_color(rgba((footer_colors.border << 8) | 0x50))
             .bg(footer_bg)
-            .child(
-                div()
-                    .flex()
-                    .flex_row()
-                    .items_center()
-                    .gap(px(8.0))
-                    .flex_1()
-                    .min_w(px(0.0))
-                    .overflow_hidden()
-                    .child(
-                        svg()
-                            .external_path(crate::utils::get_logo_path())
-                            .size(px(16.0))
-                            .ml(px(2.0))
-                            .text_color(rgb(footer_colors.accent)),
-                    )
-                    .child(
-                        div()
-                            .max_w(px(420.0))
-                            .overflow_hidden()
-                            .text_ellipsis()
-                            .whitespace_nowrap()
-                            .text_xs()
-                            .text_color(rgb(footer_colors.accent))
-                            .child(model_text),
-                    ),
-            )
+            .child(left_side)
             .child(right_side)
     }
 
@@ -128,49 +176,36 @@
             return None;
         }
 
-        let colors = &self.prompt_colors;
         let theme_colors = &self.theme.colors;
-        let button_bg = theme::hover_overlay_bg(&self.theme, 0x24);
-        let button_hover_bg = theme::hover_overlay_bg(&self.theme, 0x36);
+        let footer_colors = PromptFooterColors::from_theme(&self.theme);
 
         let mut action_container = div()
             .id("chat-script-generation-footer-actions")
             .flex()
             .flex_row()
             .items_center()
-            .gap(px(6.0))
+            .gap(px(2.0))
             .min_w(px(0.0));
 
         if show_actions {
-            let button = |id: &'static str,
-                          label: &'static str,
-                          action: ScriptGenerationAction|
-             -> AnyElement {
-                div()
-                    .id(format!("chat-script-generation-{}", id))
-                    .px(px(8.0))
-                    .py(px(2.0))
-                    .rounded(px(6.0))
-                    .bg(button_bg)
-                    .cursor_pointer()
-                    .hover(move |d| d.bg(button_hover_bg))
-                    .text_xs()
-                    .font_weight(gpui::FontWeight::MEDIUM)
-                    .text_color(rgb(colors.text_primary))
-                    .child(label)
-                    .on_click(cx.listener(move |this, _event, _window, cx| {
-                        this.handle_script_generation_action(action, cx);
-                    }))
-                    .into_any_element()
-            };
-
             action_container = action_container
-                .child(button("save", "Save", ScriptGenerationAction::Save))
-                .child(button("run", "Run", ScriptGenerationAction::Run))
-                .child(button(
-                    "save-and-run",
-                    "Save and Run",
-                    ScriptGenerationAction::SaveAndRun,
+                .child(self.render_script_generation_footer_button(
+                    "chat-script-generation-save",
+                    "Save",
+                    None,
+                    ScriptGenerationAction::Save,
+                    footer_colors.accent,
+                    footer_colors.text_muted,
+                    cx,
+                ))
+                .child(self.render_script_generation_footer_button(
+                    "chat-script-generation-run",
+                    "Run",
+                    None,
+                    ScriptGenerationAction::Run,
+                    footer_colors.accent,
+                    footer_colors.text_muted,
+                    cx,
                 ));
         }
 
@@ -560,10 +595,56 @@
             .child(input_area)
             // Scrollable message area
             .child(messages_content)
-            // Footer with model selector, Continue in Chat, and Actions
+            // Footer with model selector and footer actions
             .child(self.render_footer(cx))
             // Note: Actions menu is now handled by parent via on_show_actions callback
             // The parent opens the standard ActionsDialog window
             .into_any_element()
     }
 }
+
+#[cfg(test)]
+mod render_core_footer_tests {
+    use std::fs;
+
+    #[test]
+    fn test_script_generation_mode_replaces_continue_with_save_and_run_primary_button() {
+        let content = fs::read_to_string("src/prompts/chat/render_core.rs")
+            .expect("Failed to read src/prompts/chat/render_core.rs");
+        let normalized: String = content.chars().filter(|c| !c.is_whitespace()).collect();
+
+        assert!(
+            normalized.contains("letprimary_button=ifself.script_generation_mode{"),
+            "Footer primary action should branch on script_generation_mode"
+        );
+        assert!(
+            normalized.contains("\"chat-footer-primary-button\",\"SaveandRun\",None,ScriptGenerationAction::SaveAndRun,"),
+            "Script generation mode should render Save and Run as the primary footer action"
+        );
+        assert!(
+            normalized.contains(
+                "}else{self.render_footer_button(\"chat-footer-primary-button\",\"ContinueinChat\",Some(\"⌘↵\"),"
+            ),
+            "Non-script mode should keep Continue in Chat as the primary footer action"
+        );
+    }
+
+    #[test]
+    fn test_script_generation_secondary_footer_actions_render_save_and_run_only() {
+        let content = fs::read_to_string("src/prompts/chat/render_core.rs")
+            .expect("Failed to read src/prompts/chat/render_core.rs");
+
+        assert!(
+            content.contains("\"chat-script-generation-save\""),
+            "Script generation footer should render Save action"
+        );
+        assert!(
+            content.contains("\"chat-script-generation-run\""),
+            "Script generation footer should render Run action"
+        );
+        assert!(
+            !content.contains("\"chat-script-generation-save-and-run\""),
+            "Save and Run should only appear as the primary footer action slot"
+        );
+    }
+}


thinking
**Flagging unexpected preexisting changes**
codex
`cargo check` succeeded earlier, but I added final footer tests afterward, so I’m running a fresh scoped `cargo check -p script-kit-gpui` now to confirm the final code compiles.
exec
/bin/zsh -lc 'cargo check -p script-kit-gpui' in /Users/johnlindquist/dev/script-kit-gpui succeeded in 252ms:
warning: glob import doesn't reexport anything with visibility `pub(in crate::prompts)` because no imported item is public enough
  --> src/prompts/div/mod.rs:32:16
   |
32 | pub(super) use inline::*;
   |                ^^^^^^^^^
   |
note: the most public imported item is `pub(self)`
  --> src/prompts/div/mod.rs:32:16
   |
32 | pub(super) use inline::*;
   |                ^^^^^^^^^
   = help: reduce the glob import's visibility or increase visibility of imported items
   = note: `#[warn(unused_imports)]` (part of `#[warn(unused)]`) on by default

warning: glob import doesn't reexport anything with visibility `pub(in crate::prompts)` because no imported item is public enough
  --> src/prompts/div/mod.rs:34:16
   |
34 | pub(super) use render_html::*;
   |                ^^^^^^^^^^^^^^
   |
file update:
diff --git a/src/prompts/chat/render_core.rs b/src/prompts/chat/render_core.rs
index 59f504a9b2cf341109463f106d0bc4b8979101f9..4e91d2d0ed474e69c143cd50e58e0491df58450b
--- a/src/prompts/chat/render_core.rs
+++ b/src/prompts/chat/render_core.rs
@@ -5,7 +5,7 @@
         &self,
         id: &'static str,
         label: &'static str,
-        shortcut: &'static str,
+        shortcut: Option<&'static str>,
         accent_color: u32,
         muted_color: u32,
     ) -> AnyElement {
@@ -20,10 +20,42 @@
             .rounded(px(4.0))
             .cursor_default()
             .child(div().text_xs().text_color(rgb(accent_color)).child(label))
-            .child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            .when_some(shortcut, |d, shortcut| {
+                d.child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            })
             .into_any_element()
     }
 
+    fn render_script_generation_footer_button(
+        &self,
+        id: &'static str,
+        label: &'static str,
+        shortcut: Option<&'static str>,
+        action: ScriptGenerationAction,
+        accent_color: u32,
+        muted_color: u32,
+        cx: &mut Context<Self>,
+    ) -> AnyElement {
+        div()
+            .id(id)
+            .flex()
+            .flex_row()
+            .items_center()
+            .gap(px(6.0))
+            .px(px(8.0))
+            .py(px(2.0))
+            .rounded(px(4.0))
+            .cursor_pointer()
+            .child(div().text_xs().text_color(rgb(accent_color)).child(label))
+            .when_some(shortcut, |d, shortcut| {
+                d.child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            })
+            .on_click(cx.listener(move |this, _event, _window, cx| {
+                this.handle_script_generation_action(action, cx);
+            }))
+            .into_any_element()
+    }
+
     fn render_footer(&self, cx: &mut Context<Self>) -> impl IntoElement {
         let footer_colors = PromptFooterColors::from_theme(&self.theme);
         let footer_bg = rgba(crate::components::prompt_footer::footer_surface_rgba(
@@ -40,11 +72,59 @@
                 .into_any_element()
         };
 
-        let mut right_side = div().flex().flex_row().items_center().min_w(px(0.));
-        if let Some(script_actions) = self.render_script_generation_footer_actions(cx) {
-            right_side = right_side.child(script_actions).child(divider());
+        let mut left_side = div()
+            .flex()
+            .flex_row()
+            .items_center()
+            .gap(px(8.0))
+            .flex_1()
+            .min_w(px(0.0))
+            .overflow_hidden()
+            .child(
+                svg()
+                    .external_path(crate::utils::get_logo_path())
+                    .size(px(16.0))
+                    .ml(px(2.0))
+                    .text_color(rgb(footer_colors.accent)),
+            )
+            .child(
+                div()
+                    .max_w(px(420.0))
+                    .overflow_hidden()
+                    .text_ellipsis()
+                    .whitespace_nowrap()
+                    .text_xs()
+                    .text_color(rgb(footer_colors.accent))
+                    .child(model_text),
+            );
+
+        if self.script_generation_mode {
+            if let Some(script_actions) = self.render_script_generation_footer_actions(cx) {
+                left_side = left_side.child(divider()).child(script_actions);
+            }
         }
 
+        let mut right_side = div().flex().flex_row().items_center().min_w(px(0.));
+        let primary_button = if self.script_generation_mode {
+            self.render_script_generation_footer_button(
+                "chat-footer-primary-button",
+                "Save and Run",
+                None,
+                ScriptGenerationAction::SaveAndRun,
+                footer_colors.accent,
+                footer_colors.text_muted,
+                cx,
+            )
+        } else {
+            self.render_footer_button(
+                "chat-footer-primary-button",
+                "Continue in Chat",
+                Some("⌘↵"),
+                footer_colors.accent,
+                footer_colors.text_muted,
+            )
+        };
+
         right_side = right_side
             .child(
                 div()
@@ -53,18 +133,12 @@
                     .child("Shift+Enter newline"),
             )
             .child(divider())
-            .child(self.render_footer_button(
-                "chat-footer-primary-button",
-                "Continue in Chat",
-                "⌘↵",
-                footer_colors.accent,
-                footer_colors.text_muted,
-            ))
+            .child(primary_button)
             .child(divider())
             .child(self.render_footer_button(
                 "chat-footer-secondary-button",
                 "Actions",
-                "⌘K",
+                Some("⌘K"),
                 footer_colors.accent,
                 footer_colors.text_muted,
             ));
@@ -87,33 +161,7 @@
             .border_t_1()
             .border_color(rgba((footer_colors.border << 8) | 0x50))
             .bg(footer_bg)
-            .child(
-                div()
-                    .flex()
-                    .flex_row()
-                    .items_center()
-                    .gap(px(8.0))
-                    .flex_1()
-                    .min_w(px(0.0))
-                    .overflow_hidden()
-                    .child(
-                        svg()
-                            .external_path(crate::utils::get_logo_path())
-                            .size(px(16.0))
-                            .ml(px(2.0))
-                            .text_color(rgb(footer_colors.accent)),
-                    )
-                    .child(
-                        div()
-                            .max_w(px(420.0))
-                            .overflow_hidden()
-                            .text_ellipsis()
-                            .whitespace_nowrap()
-                            .text_xs()
-                            .text_color(rgb(footer_colors.accent))
-                            .child(model_text),
-                    ),
-            )
+            .child(left_side)
             .child(right_side)
     }
 
@@ -128,49 +176,36 @@
             return None;
         }
 
-        let colors = &self.prompt_colors;
         let theme_colors = &self.theme.colors;
-        let button_bg = theme::hover_overlay_bg(&self.theme, 0x24);
-        let button_hover_bg = theme::hover_overlay_bg(&self.theme, 0x36);
+        let footer_colors = PromptFooterColors::from_theme(&self.theme);
 
         let mut action_container = div()
             .id("chat-script-generation-footer-actions")
             .flex()
             .flex_row()
             .items_center()
-            .gap(px(6.0))
+            .gap(px(2.0))
             .min_w(px(0.0));
 
         if show_actions {
-            let button = |id: &'static str,
-                          label: &'static str,
-                          action: ScriptGenerationAction|
-             -> AnyElement {
-                div()
-                    .id(format!("chat-script-generation-{}", id))
-                    .px(px(8.0))
-                    .py(px(2.0))
-                    .rounded(px(6.0))
-                    .bg(button_bg)
-                    .cursor_pointer()
-                    .hover(move |d| d.bg(button_hover_bg))
-                    .text_xs()
-                    .font_weight(gpui::FontWeight::MEDIUM)
-                    .text_color(rgb(colors.text_primary))
-                    .child(label)
-                    .on_click(cx.listener(move |this, _event, _window, cx| {
-                        this.handle_script_generation_action(action, cx);
-                    }))
-                    .into_any_element()
-            };
-
             action_container = action_container
-                .child(button("save", "Save", ScriptGenerationAction::Save))
-                .child(button("run", "Run", ScriptGenerationAction::Run))
-                .child(button(
-                    "save-and-run",
-                    "Save and Run",
-                    ScriptGenerationAction::SaveAndRun,
+                .child(self.render_script_generation_footer_button(
+                    "chat-script-generation-save",
+                    "Save",
+                    None,
+                    ScriptGenerationAction::Save,
+                    footer_colors.accent,
+                    footer_colors.text_muted,
+                    cx,
+                ))
+                .child(self.render_script_generation_footer_button(
+                    "chat-script-generation-run",
+                    "Run",
+                    None,
+                    ScriptGenerationAction::Run,
+                    footer_colors.accent,
+                    footer_colors.text_muted,
+                    cx,
                 ));
         }
 
@@ -560,10 +595,56 @@
             .child(input_area)
             // Scrollable message area
             .child(messages_content)
-            // Footer with model selector, Continue in Chat, and Actions
+            // Footer with model selector and footer actions
             .child(self.render_footer(cx))
             // Note: Actions menu is now handled by parent via on_show_actions callback
             // The parent opens the standard ActionsDialog window
             .into_any_element()
     }
 }
+
+#[cfg(test)]
+mod render_core_footer_tests {
+    use std::fs;
+
+    #[test]
+    fn test_script_generation_mode_replaces_continue_with_save_and_run_primary_button() {
+        let content = fs::read_to_string("src/prompts/chat/render_core.rs")
+            .expect("Failed to read src/prompts/chat/render_core.rs");
+        let normalized: String = content.chars().filter(|c| !c.is_whitespace()).collect();
+
+        assert!(
+            normalized.contains("letprimary_button=ifself.script_generation_mode{"),
+            "Footer primary action should branch on script_generation_mode"
+        );
+        assert!(
+            normalized.contains("\"chat-footer-primary-button\",\"SaveandRun\",None,ScriptGenerationAction::SaveAndRun,"),
+            "Script generation mode should render Save and Run as the primary footer action"
+        );
+        assert!(
+            normalized.contains(
+                "}else{self.render_footer_button(\"chat-footer-primary-button\",\"ContinueinChat\",Some(\"⌘↵\"),"
+            ),
+            "Non-script mode should keep Continue in Chat as the primary footer action"
+        );
+    }
+
+    #[test]
+    fn test_script_generation_secondary_footer_actions_render_save_and_run_only() {
+        let content = fs::read_to_string("src/prompts/chat/render_core.rs")
+            .expect("Failed to read src/prompts/chat/render_core.rs");
+
+        assert!(
+            content.contains("\"chat-script-generation-save\""),
+            "Script generation footer should render Save action"
+        );
+        assert!(
+            content.contains("\"chat-script-generation-run\""),
+            "Script generation footer should render Run action"
+        );
+        assert!(
+            !content.contains("\"chat-script-generation-save-and-run\""),
+            "Save and Run should only appear as the primary footer action slot"
+        );
+    }
+}


thinking
**Assessing test feasibility despite unrelated failures**
exec
/bin/zsh -lc 'git status --short src/prompts/chat/render_core.rs src/prompts/chat/prompt.rs' in /Users/johnlindquist/dev/script-kit-gpui succeeded in 52ms:
 M src/prompts/chat/prompt.rs
 M src/prompts/chat/render_core.rs
file update:
diff --git a/src/prompts/chat/render_core.rs b/src/prompts/chat/render_core.rs
index 59f504a9b2cf341109463f106d0bc4b8979101f9..4e91d2d0ed474e69c143cd50e58e0491df58450b
--- a/src/prompts/chat/render_core.rs
+++ b/src/prompts/chat/render_core.rs
@@ -5,7 +5,7 @@
         &self,
         id: &'static str,
         label: &'static str,
-        shortcut: &'static str,
+        shortcut: Option<&'static str>,
         accent_color: u32,
         muted_color: u32,
     ) -> AnyElement {
@@ -20,10 +20,42 @@
             .rounded(px(4.0))
             .cursor_default()
             .child(div().text_xs().text_color(rgb(accent_color)).child(label))
-            .child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            .when_some(shortcut, |d, shortcut| {
+                d.child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            })
             .into_any_element()
     }
 
+    fn render_script_generation_footer_button(
+        &self,
+        id: &'static str,
+        label: &'static str,
+        shortcut: Option<&'static str>,
+        action: ScriptGenerationAction,
+        accent_color: u32,
+        muted_color: u32,
+        cx: &mut Context<Self>,
+    ) -> AnyElement {
+        div()
+            .id(id)
+            .flex()
+            .flex_row()
+            .items_center()
+            .gap(px(6.0))
+            .px(px(8.0))
+            .py(px(2.0))
+            .rounded(px(4.0))
+            .cursor_pointer()
+            .child(div().text_xs().text_color(rgb(accent_color)).child(label))
+            .when_some(shortcut, |d, shortcut| {
+                d.child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            })
+            .on_click(cx.listener(move |this, _event, _window, cx| {
+                this.handle_script_generation_action(action, cx);
+            }))
+            .into_any_element()
+    }
+
     fn render_footer(&self, cx: &mut Context<Self>) -> impl IntoElement {
         let footer_colors = PromptFooterColors::from_theme(&self.theme);
         let footer_bg = rgba(crate::components::prompt_footer::footer_surface_rgba(
@@ -40,11 +72,59 @@
                 .into_any_element()
         };
 
-        let mut right_side = div().flex().flex_row().items_center().min_w(px(0.));
-        if let Some(script_actions) = self.render_script_generation_footer_actions(cx) {
-            right_side = right_side.child(script_actions).child(divider());
+        let mut left_side = div()
+            .flex()
+            .flex_row()
+            .items_center()
+            .gap(px(8.0))
+            .flex_1()
+            .min_w(px(0.0))
+            .overflow_hidden()
+            .child(
+                svg()
+                    .external_path(crate::utils::get_logo_path())
+                    .size(px(16.0))
+                    .ml(px(2.0))
+                    .text_color(rgb(footer_colors.accent)),
+            )
+            .child(
+                div()
+                    .max_w(px(420.0))
+                    .overflow_hidden()
+                    .text_ellipsis()
+                    .whitespace_nowrap()
+                    .text_xs()
+                    .text_color(rgb(footer_colors.accent))
+                    .child(model_text),
+            );
+
+        if self.script_generation_mode {
+            if let Some(script_actions) = self.render_script_generation_footer_actions(cx) {
+                left_side = left_side.child(divider()).child(script_actions);
+            }
         }
 
+        let mut right_side = div().flex().flex_row().items_center().min_w(px(0.));
+        let primary_button = if self.script_generation_mode {
+            self.render_script_generation_footer_button(
+                "chat-footer-primary-button",
+                "Save and Run",
+                None,
+                ScriptGenerationAction::SaveAndRun,
+                footer_colors.accent,
+                footer_colors.text_muted,
+                cx,
+            )
+        } else {
+            self.render_footer_button(
+                "chat-footer-primary-button",
+                "Continue in Chat",
+                Some("⌘↵"),
+                footer_colors.accent,
+                footer_colors.text_muted,
+            )
+        };
+
         right_side = right_side
             .child(
                 div()
@@ -53,18 +133,12 @@
                     .child("Shift+Enter newline"),
             )
             .child(divider())
-            .child(self.render_footer_button(
-                "chat-footer-primary-button",
-                "Continue in Chat",
-                "⌘↵",
-                footer_colors.accent,
-                footer_colors.text_muted,
-            ))
+            .child(primary_button)
             .child(divider())
             .child(self.render_footer_button(
                 "chat-footer-secondary-button",
                 "Actions",
-                "⌘K",
+                Some("⌘K"),
                 footer_colors.accent,
                 footer_colors.text_muted,
             ));
@@ -87,33 +161,7 @@
             .border_t_1()
             .border_color(rgba((footer_colors.border << 8) | 0x50))
             .bg(footer_bg)
-            .child(
-                div()
-                    .flex()
-                    .flex_row()
-                    .items_center()
-                    .gap(px(8.0))
-                    .flex_1()
-                    .min_w(px(0.0))
-                    .overflow_hidden()
-                    .child(
-                        svg()
-                            .external_path(crate::utils::get_logo_path())
-                            .size(px(16.0))
-                            .ml(px(2.0))
-                            .text_color(rgb(footer_colors.accent)),
-                    )
-                    .child(
-                        div()
-                            .max_w(px(420.0))
-                            .overflow_hidden()
-                            .text_ellipsis()
-                            .whitespace_nowrap()
-                            .text_xs()
-                            .text_color(rgb(footer_colors.accent))
-                            .child(model_text),
-                    ),
-            )
+            .child(left_side)
             .child(right_side)
     }
 
@@ -128,49 +176,36 @@
             return None;
         }
 
-        let colors = &self.prompt_colors;
         let theme_colors = &self.theme.colors;
-        let button_bg = theme::hover_overlay_bg(&self.theme, 0x24);
-        let button_hover_bg = theme::hover_overlay_bg(&self.theme, 0x36);
+        let footer_colors = PromptFooterColors::from_theme(&self.theme);
 
         let mut action_container = div()
             .id("chat-script-generation-footer-actions")
             .flex()
             .flex_row()
             .items_center()
-            .gap(px(6.0))
+            .gap(px(2.0))
             .min_w(px(0.0));
 
         if show_actions {
-            let button = |id: &'static str,
-                          label: &'static str,
-                          action: ScriptGenerationAction|
-             -> AnyElement {
-                div()
-                    .id(format!("chat-script-generation-{}", id))
-                    .px(px(8.0))
-                    .py(px(2.0))
-                    .rounded(px(6.0))
-                    .bg(button_bg)
-                    .cursor_pointer()
-                    .hover(move |d| d.bg(button_hover_bg))
-                    .text_xs()
-                    .font_weight(gpui::FontWeight::MEDIUM)
-                    .text_color(rgb(colors.text_primary))
-                    .child(label)
-                    .on_click(cx.listener(move |this, _event, _window, cx| {
-                        this.handle_script_generation_action(action, cx);
-                    }))
-                    .into_any_element()
-            };
-
             action_container = action_container
-                .child(button("save", "Save", ScriptGenerationAction::Save))
-                .child(button("run", "Run", ScriptGenerationAction::Run))
-                .child(button(
-                    "save-and-run",
-                    "Save and Run",
-                    ScriptGenerationAction::SaveAndRun,
+                .child(self.render_script_generation_footer_button(
+                    "chat-script-generation-save",
+                    "Save",
+                    None,
+                    ScriptGenerationAction::Save,
+                    footer_colors.accent,
+                    footer_colors.text_muted,
+                    cx,
+                ))
+                .child(self.render_script_generation_footer_button(
+                    "chat-script-generation-run",
+                    "Run",
+                    None,
+                    ScriptGenerationAction::Run,
+                    footer_colors.accent,
+                    footer_colors.text_muted,
+                    cx,
                 ));
         }
 
@@ -560,10 +595,56 @@
             .child(input_area)
             // Scrollable message area
             .child(messages_content)
-            // Footer with model selector, Continue in Chat, and Actions
+            // Footer with model selector and footer actions
             .child(self.render_footer(cx))
             // Note: Actions menu is now handled by parent via on_show_actions callback
             // The parent opens the standard ActionsDialog window
             .into_any_element()
     }
 }
+
+#[cfg(test)]
+mod render_core_footer_tests {
+    use std::fs;
+
+    #[test]
+    fn test_script_generation_mode_replaces_continue_with_save_and_run_primary_button() {
+        let content = fs::read_to_string("src/prompts/chat/render_core.rs")
+            .expect("Failed to read src/prompts/chat/render_core.rs");
+        let normalized: String = content.chars().filter(|c| !c.is_whitespace()).collect();
+
+        assert!(
+            normalized.contains("letprimary_button=ifself.script_generation_mode{"),
+            "Footer primary action should branch on script_generation_mode"
+        );
+        assert!(
+            normalized.contains("\"chat-footer-primary-button\",\"SaveandRun\",None,ScriptGenerationAction::SaveAndRun,"),
+            "Script generation mode should render Save and Run as the primary footer action"
+        );
+        assert!(
+            normalized.contains(
+                "}else{self.render_footer_button(\"chat-footer-primary-button\",\"ContinueinChat\",Some(\"⌘↵\"),"
+            ),
+            "Non-script mode should keep Continue in Chat as the primary footer action"
+        );
+    }
+
+    #[test]
+    fn test_script_generation_secondary_footer_actions_render_save_and_run_only() {
+        let content = fs::read_to_string("src/prompts/chat/render_core.rs")
+            .expect("Failed to read src/prompts/chat/render_core.rs");
+
+        assert!(
+            content.contains("\"chat-script-generation-save\""),
+            "Script generation footer should render Save action"
+        );
+        assert!(
+            content.contains("\"chat-script-generation-run\""),
+            "Script generation footer should render Run action"
+        );
+        assert!(
+            !content.contains("\"chat-script-generation-save-and-run\""),
+            "Save and Run should only appear as the primary footer action slot"
+        );
+    }
+}


thinking
**Planning selective commit**
codex
The scoped `cargo check` passed after the edits. I also attempted a targeted test run, but test compilation is currently failing in unrelated in-progress files from other agents; I’m collecting the final diff for `render_core.rs` and then I’ll finalize status/release claims.
exec
/bin/zsh -lc "git diff -- src/prompts/chat/render_core.rs | sed -n '1,260p'" in /Users/johnlindquist/dev/script-kit-gpui succeeded in 51ms:
diff --git a/src/prompts/chat/render_core.rs b/src/prompts/chat/render_core.rs
index e24f659..4e91d2d 100644
--- a/src/prompts/chat/render_core.rs
+++ b/src/prompts/chat/render_core.rs
@@ -1,28 +1,236 @@
 use super::*;
 
 impl ChatPrompt {
-    fn render_footer(&self, _cx: &mut Context<Self>) -> impl IntoElement {
-        // Use standard PromptFooter colors from theme
-        let footer_colors = PromptFooterColors::from_theme(&self.theme);
+    fn render_footer_button(
+        &self,
+        id: &'static str,
+        label: &'static str,
+        shortcut: Option<&'static str>,
+        accent_color: u32,
+        muted_color: u32,
+    ) -> AnyElement {
+        div()
file update:
diff --git a/src/prompts/chat/render_core.rs b/src/prompts/chat/render_core.rs
index 59f504a9b2cf341109463f106d0bc4b8979101f9..4e91d2d0ed474e69c143cd50e58e0491df58450b
--- a/src/prompts/chat/render_core.rs
+++ b/src/prompts/chat/render_core.rs
@@ -5,7 +5,7 @@
         &self,
         id: &'static str,
         label: &'static str,
-        shortcut: &'static str,
+        shortcut: Option<&'static str>,
         accent_color: u32,
         muted_color: u32,
     ) -> AnyElement {
@@ -20,10 +20,42 @@
             .rounded(px(4.0))
             .cursor_default()
             .child(div().text_xs().text_color(rgb(accent_color)).child(label))
-            .child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            .when_some(shortcut, |d, shortcut| {
+                d.child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            })
             .into_any_element()
     }
 
+    fn render_script_generation_footer_button(
+        &self,
+        id: &'static str,
+        label: &'static str,
+        shortcut: Option<&'static str>,
+        action: ScriptGenerationAction,
+        accent_color: u32,
+        muted_color: u32,
+        cx: &mut Context<Self>,
+    ) -> AnyElement {
+        div()
+            .id(id)
+            .flex()
+            .flex_row()
+            .items_center()
+            .gap(px(6.0))
+            .px(px(8.0))
+            .py(px(2.0))
+            .rounded(px(4.0))
+            .cursor_pointer()
+            .child(div().text_xs().text_color(rgb(accent_color)).child(label))
+            .when_some(shortcut, |d, shortcut| {
+                d.child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            })
+            .on_click(cx.listener(move |this, _event, _window, cx| {
+                this.handle_script_generation_action(action, cx);
+            }))
+            .into_any_element()
+    }
+
     fn render_footer(&self, cx: &mut Context<Self>) -> impl IntoElement {
         let footer_colors = PromptFooterColors::from_theme(&self.theme);
         let footer_bg = rgba(crate::components::prompt_footer::footer_surface_rgba(
@@ -40,11 +72,59 @@
                 .into_any_element()
         };
 
-        let mut right_side = div().flex().flex_row().items_center().min_w(px(0.));
-        if let Some(script_actions) = self.render_script_generation_footer_actions(cx) {
-            right_side = right_side.child(script_actions).child(divider());
+        let mut left_side = div()
+            .flex()
+            .flex_row()
+            .items_center()
+            .gap(px(8.0))
+            .flex_1()
+            .min_w(px(0.0))
+            .overflow_hidden()
+            .child(
+                svg()
+                    .external_path(crate::utils::get_logo_path())
+                    .size(px(16.0))
+                    .ml(px(2.0))
+                    .text_color(rgb(footer_colors.accent)),
+            )
+            .child(
+                div()
+                    .max_w(px(420.0))
+                    .overflow_hidden()
+                    .text_ellipsis()
+                    .whitespace_nowrap()
+                    .text_xs()
+                    .text_color(rgb(footer_colors.accent))
+                    .child(model_text),
+            );
+
+        if self.script_generation_mode {
+            if let Some(script_actions) = self.render_script_generation_footer_actions(cx) {
+                left_side = left_side.child(divider()).child(script_actions);
+            }
         }
 
+        let mut right_side = div().flex().flex_row().items_center().min_w(px(0.));
+        let primary_button = if self.script_generation_mode {
+            self.render_script_generation_footer_button(
+                "chat-footer-primary-button",
+                "Save and Run",
+                None,
+                ScriptGenerationAction::SaveAndRun,
+                footer_colors.accent,
+                footer_colors.text_muted,
+                cx,
+            )
+        } else {
+            self.render_footer_button(
+                "chat-footer-primary-button",
+                "Continue in Chat",
+                Some("⌘↵"),
+                footer_colors.accent,
+                footer_colors.text_muted,
+            )
+        };
+
         right_side = right_side
             .child(
                 div()
@@ -53,18 +133,12 @@
                     .child("Shift+Enter newline"),
             )
             .child(divider())
-            .child(self.render_footer_button(
-                "chat-footer-primary-button",
-                "Continue in Chat",
-                "⌘↵",
-                footer_colors.accent,
-                footer_colors.text_muted,
-            ))
+            .child(primary_button)
             .child(divider())
             .child(self.render_footer_button(
                 "chat-footer-secondary-button",
                 "Actions",
-                "⌘K",
+                Some("⌘K"),
                 footer_colors.accent,
                 footer_colors.text_muted,
             ));
@@ -87,33 +161,7 @@
             .border_t_1()
             .border_color(rgba((footer_colors.border << 8) | 0x50))
             .bg(footer_bg)
-            .child(
-                div()
-                    .flex()
-                    .flex_row()
-                    .items_center()
-                    .gap(px(8.0))
-                    .flex_1()
-                    .min_w(px(0.0))
-                    .overflow_hidden()
-                    .child(
-                        svg()
-                            .external_path(crate::utils::get_logo_path())
-                            .size(px(16.0))
-                            .ml(px(2.0))
-                            .text_color(rgb(footer_colors.accent)),
-                    )
-                    .child(
-                        div()
-                            .max_w(px(420.0))
-                            .overflow_hidden()
-                            .text_ellipsis()
-                            .whitespace_nowrap()
-                            .text_xs()
-                            .text_color(rgb(footer_colors.accent))
-                            .child(model_text),
-                    ),
-            )
+            .child(left_side)
             .child(right_side)
     }
 
@@ -128,49 +176,36 @@
             return None;
         }
 
-        let colors = &self.prompt_colors;
         let theme_colors = &self.theme.colors;
-        let button_bg = theme::hover_overlay_bg(&self.theme, 0x24);
-        let button_hover_bg = theme::hover_overlay_bg(&self.theme, 0x36);
+        let footer_colors = PromptFooterColors::from_theme(&self.theme);
 
         let mut action_container = div()
             .id("chat-script-generation-footer-actions")
             .flex()
             .flex_row()
             .items_center()
-            .gap(px(6.0))
+            .gap(px(2.0))
             .min_w(px(0.0));
 
         if show_actions {
-            let button = |id: &'static str,
-                          label: &'static str,
-                          action: ScriptGenerationAction|
-             -> AnyElement {
-                div()
-                    .id(format!("chat-script-generation-{}", id))
-                    .px(px(8.0))
-                    .py(px(2.0))
-                    .rounded(px(6.0))
-                    .bg(button_bg)
-                    .cursor_pointer()
-                    .hover(move |d| d.bg(button_hover_bg))
-                    .text_xs()
-                    .font_weight(gpui::FontWeight::MEDIUM)
-                    .text_color(rgb(colors.text_primary))
-                    .child(label)
-                    .on_click(cx.listener(move |this, _event, _window, cx| {
-                        this.handle_script_generation_action(action, cx);
-                    }))
-                    .into_any_element()
-            };
-
             action_container = action_container
-                .child(button("save", "Save", ScriptGenerationAction::Save))
-                .child(button("run", "Run", ScriptGenerationAction::Run))
-                .child(button(
-                    "save-and-run",
-                    "Save and Run",
-                    ScriptGenerationAction::SaveAndRun,
+                .child(self.render_script_generation_footer_button(
+                    "chat-script-generation-save",
+                    "Save",
+                    None,
+                    ScriptGenerationAction::Save,
+                    footer_colors.accent,
+                    footer_colors.text_muted,
+                    cx,
+                ))
+                .child(self.render_script_generation_footer_button(
+                    "chat-script-generation-run",
+                    "Run",
+                    None,
+                    ScriptGenerationAction::Run,
+                    footer_colors.accent,
+                    footer_colors.text_muted,
+                    cx,
                 ));
         }
 
@@ -560,10 +595,56 @@
             .child(input_area)
             // Scrollable message area
             .child(messages_content)
-            // Footer with model selector, Continue in Chat, and Actions
+            // Footer with model selector and footer actions
             .child(self.render_footer(cx))
             // Note: Actions menu is now handled by parent via on_show_actions callback
             // The parent opens the standard ActionsDialog window
             .into_any_element()
     }
 }
+
+#[cfg(test)]
+mod render_core_footer_tests {
+    use std::fs;
+
+    #[test]
+    fn test_script_generation_mode_replaces_continue_with_save_and_run_primary_button() {
+        let content = fs::read_to_string("src/prompts/chat/render_core.rs")
+            .expect("Failed to read src/prompts/chat/render_core.rs");
+        let normalized: String = content.chars().filter(|c| !c.is_whitespace()).collect();
+
+        assert!(
+            normalized.contains("letprimary_button=ifself.script_generation_mode{"),
+            "Footer primary action should branch on script_generation_mode"
+        );
+        assert!(
+            normalized.contains("\"chat-footer-primary-button\",\"SaveandRun\",None,ScriptGenerationAction::SaveAndRun,"),
+            "Script generation mode should render Save and Run as the primary footer action"
+        );
+        assert!(
+            normalized.contains(
+                "}else{self.render_footer_button(\"chat-footer-primary-button\",\"ContinueinChat\",Some(\"⌘↵\"),"
+            ),
+            "Non-script mode should keep Continue in Chat as the primary footer action"
+        );
+    }
+
+    #[test]
+    fn test_script_generation_secondary_footer_actions_render_save_and_run_only() {
+        let content = fs::read_to_string("src/prompts/chat/render_core.rs")
+            .expect("Failed to read src/prompts/chat/render_core.rs");
+
+        assert!(
+            content.contains("\"chat-script-generation-save\""),
+            "Script generation footer should render Save action"
+        );
+        assert!(
+            content.contains("\"chat-script-generation-run\""),
+            "Script generation footer should render Run action"
+        );
+        assert!(
+            !content.contains("\"chat-script-generation-save-and-run\""),
+            "Save and Run should only appear as the primary footer action slot"
+        );
+    }
+}


thinking
**Resolving mixed uncommitted changes**
exec
/bin/zsh -lc 'cargo fmt -- src/prompts/chat/render_core.rs' in /Users/johnlindquist/dev/script-kit-gpui exited 1 in 92ms:
Error writing files: failed to resolve mod `tests`: file for module found at both "/Users/johnlindquist/dev/script-kit-gpui/src/protocol/message/tests.rs" and "/Users/johnlindquist/dev/script-kit-gpui/src/protocol/message/tests/mod.rs"
file update:
diff --git a/src/prompts/chat/render_core.rs b/src/prompts/chat/render_core.rs
index 59f504a9b2cf341109463f106d0bc4b8979101f9..4e91d2d0ed474e69c143cd50e58e0491df58450b
--- a/src/prompts/chat/render_core.rs
+++ b/src/prompts/chat/render_core.rs
@@ -5,7 +5,7 @@
         &self,
         id: &'static str,
         label: &'static str,
-        shortcut: &'static str,
+        shortcut: Option<&'static str>,
         accent_color: u32,
         muted_color: u32,
     ) -> AnyElement {
@@ -20,10 +20,42 @@
             .rounded(px(4.0))
             .cursor_default()
             .child(div().text_xs().text_color(rgb(accent_color)).child(label))
-            .child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            .when_some(shortcut, |d, shortcut| {
+                d.child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            })
             .into_any_element()
     }
 
+    fn render_script_generation_footer_button(
+        &self,
+        id: &'static str,
+        label: &'static str,
+        shortcut: Option<&'static str>,
+        action: ScriptGenerationAction,
+        accent_color: u32,
+        muted_color: u32,
+        cx: &mut Context<Self>,
+    ) -> AnyElement {
+        div()
+            .id(id)
+            .flex()
+            .flex_row()
+            .items_center()
+            .gap(px(6.0))
+            .px(px(8.0))
+            .py(px(2.0))
+            .rounded(px(4.0))
+            .cursor_pointer()
+            .child(div().text_xs().text_color(rgb(accent_color)).child(label))
+            .when_some(shortcut, |d, shortcut| {
+                d.child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            })
+            .on_click(cx.listener(move |this, _event, _window, cx| {
+                this.handle_script_generation_action(action, cx);
+            }))
+            .into_any_element()
+    }
+
     fn render_footer(&self, cx: &mut Context<Self>) -> impl IntoElement {
         let footer_colors = PromptFooterColors::from_theme(&self.theme);
         let footer_bg = rgba(crate::components::prompt_footer::footer_surface_rgba(
@@ -40,11 +72,59 @@
                 .into_any_element()
         };
 
-        let mut right_side = div().flex().flex_row().items_center().min_w(px(0.));
-        if let Some(script_actions) = self.render_script_generation_footer_actions(cx) {
-            right_side = right_side.child(script_actions).child(divider());
+        let mut left_side = div()
+            .flex()
+            .flex_row()
+            .items_center()
+            .gap(px(8.0))
+            .flex_1()
+            .min_w(px(0.0))
+            .overflow_hidden()
+            .child(
+                svg()
+                    .external_path(crate::utils::get_logo_path())
+                    .size(px(16.0))
+                    .ml(px(2.0))
+                    .text_color(rgb(footer_colors.accent)),
+            )
+            .child(
+                div()
+                    .max_w(px(420.0))
+                    .overflow_hidden()
+                    .text_ellipsis()
+                    .whitespace_nowrap()
+                    .text_xs()
+                    .text_color(rgb(footer_colors.accent))
+                    .child(model_text),
+            );
+
+        if self.script_generation_mode {
+            if let Some(script_actions) = self.render_script_generation_footer_actions(cx) {
+                left_side = left_side.child(divider()).child(script_actions);
+            }
         }
 
+        let mut right_side = div().flex().flex_row().items_center().min_w(px(0.));
+        let primary_button = if self.script_generation_mode {
+            self.render_script_generation_footer_button(
+                "chat-footer-primary-button",
+                "Save and Run",
+                None,
+                ScriptGenerationAction::SaveAndRun,
+                footer_colors.accent,
+                footer_colors.text_muted,
+                cx,
+            )
+        } else {
+            self.render_footer_button(
+                "chat-footer-primary-button",
+                "Continue in Chat",
+                Some("⌘↵"),
+                footer_colors.accent,
+                footer_colors.text_muted,
+            )
+        };
+
         right_side = right_side
             .child(
                 div()
@@ -53,18 +133,12 @@
                     .child("Shift+Enter newline"),
             )
             .child(divider())
-            .child(self.render_footer_button(
-                "chat-footer-primary-button",
-                "Continue in Chat",
-                "⌘↵",
-                footer_colors.accent,
-                footer_colors.text_muted,
-            ))
+            .child(primary_button)
             .child(divider())
             .child(self.render_footer_button(
                 "chat-footer-secondary-button",
                 "Actions",
-                "⌘K",
+                Some("⌘K"),
                 footer_colors.accent,
                 footer_colors.text_muted,
             ));
@@ -87,33 +161,7 @@
             .border_t_1()
             .border_color(rgba((footer_colors.border << 8) | 0x50))
             .bg(footer_bg)
-            .child(
-                div()
-                    .flex()
-                    .flex_row()
-                    .items_center()
-                    .gap(px(8.0))
-                    .flex_1()
-                    .min_w(px(0.0))
-                    .overflow_hidden()
-                    .child(
-                        svg()
-                            .external_path(crate::utils::get_logo_path())
-                            .size(px(16.0))
-                            .ml(px(2.0))
-                            .text_color(rgb(footer_colors.accent)),
-                    )
-                    .child(
-                        div()
-                            .max_w(px(420.0))
-                            .overflow_hidden()
-                            .text_ellipsis()
-                            .whitespace_nowrap()
-                            .text_xs()
-                            .text_color(rgb(footer_colors.accent))
-                            .child(model_text),
-                    ),
-            )
+            .child(left_side)
             .child(right_side)
     }
 
@@ -128,49 +176,36 @@
             return None;
         }
 
-        let colors = &self.prompt_colors;
         let theme_colors = &self.theme.colors;
-        let button_bg = theme::hover_overlay_bg(&self.theme, 0x24);
-        let button_hover_bg = theme::hover_overlay_bg(&self.theme, 0x36);
+        let footer_colors = PromptFooterColors::from_theme(&self.theme);
 
         let mut action_container = div()
             .id("chat-script-generation-footer-actions")
             .flex()
             .flex_row()
             .items_center()
-            .gap(px(6.0))
+            .gap(px(2.0))
             .min_w(px(0.0));
 
         if show_actions {
-            let button = |id: &'static str,
-                          label: &'static str,
-                          action: ScriptGenerationAction|
-             -> AnyElement {
-                div()
-                    .id(format!("chat-script-generation-{}", id))
-                    .px(px(8.0))
-                    .py(px(2.0))
-                    .rounded(px(6.0))
-                    .bg(button_bg)
-                    .cursor_pointer()
-                    .hover(move |d| d.bg(button_hover_bg))
-                    .text_xs()
-                    .font_weight(gpui::FontWeight::MEDIUM)
-                    .text_color(rgb(colors.text_primary))
-                    .child(label)
-                    .on_click(cx.listener(move |this, _event, _window, cx| {
-                        this.handle_script_generation_action(action, cx);
-                    }))
-                    .into_any_element()
-            };
-
             action_container = action_container
-                .child(button("save", "Save", ScriptGenerationAction::Save))
-                .child(button("run", "Run", ScriptGenerationAction::Run))
-                .child(button(
-                    "save-and-run",
-                    "Save and Run",
-                    ScriptGenerationAction::SaveAndRun,
+                .child(self.render_script_generation_footer_button(
+                    "chat-script-generation-save",
+                    "Save",
+                    None,
+                    ScriptGenerationAction::Save,
+                    footer_colors.accent,
+                    footer_colors.text_muted,
+                    cx,
+                ))
+                .child(self.render_script_generation_footer_button(
+                    "chat-script-generation-run",
+                    "Run",
+                    None,
+                    ScriptGenerationAction::Run,
+                    footer_colors.accent,
+                    footer_colors.text_muted,
+                    cx,
                 ));
         }
 
@@ -560,10 +595,56 @@
             .child(input_area)
             // Scrollable message area
             .child(messages_content)
-            // Footer with model selector, Continue in Chat, and Actions
+            // Footer with model selector and footer actions
             .child(self.render_footer(cx))
             // Note: Actions menu is now handled by parent via on_show_actions callback
             // The parent opens the standard ActionsDialog window
             .into_any_element()
     }
 }
+
+#[cfg(test)]
+mod render_core_footer_tests {
+    use std::fs;
+
+    #[test]
+    fn test_script_generation_mode_replaces_continue_with_save_and_run_primary_button() {
+        let content = fs::read_to_string("src/prompts/chat/render_core.rs")
+            .expect("Failed to read src/prompts/chat/render_core.rs");
+        let normalized: String = content.chars().filter(|c| !c.is_whitespace()).collect();
+
+        assert!(
+            normalized.contains("letprimary_button=ifself.script_generation_mode{"),
+            "Footer primary action should branch on script_generation_mode"
+        );
+        assert!(
+            normalized.contains("\"chat-footer-primary-button\",\"SaveandRun\",None,ScriptGenerationAction::SaveAndRun,"),
+            "Script generation mode should render Save and Run as the primary footer action"
+        );
+        assert!(
+            normalized.contains(
+                "}else{self.render_footer_button(\"chat-footer-primary-button\",\"ContinueinChat\",Some(\"⌘↵\"),"
+            ),
+            "Non-script mode should keep Continue in Chat as the primary footer action"
+        );
+    }
+
+    #[test]
+    fn test_script_generation_secondary_footer_actions_render_save_and_run_only() {
+        let content = fs::read_to_string("src/prompts/chat/render_core.rs")
+            .expect("Failed to read src/prompts/chat/render_core.rs");
+
+        assert!(
+            content.contains("\"chat-script-generation-save\""),
+            "Script generation footer should render Save action"
+        );
+        assert!(
+            content.contains("\"chat-script-generation-run\""),
+            "Script generation footer should render Run action"
+        );
+        assert!(
+            !content.contains("\"chat-script-generation-save-and-run\""),
+            "Save and Run should only appear as the primary footer action slot"
+        );
+    }
+}


thinking
**Testing direct file formatting**
exec
/bin/zsh -lc 'rustfmt src/prompts/chat/render_core.rs' in /Users/johnlindquist/dev/script-kit-gpui succeeded in 50ms:

file update:
diff --git a/src/prompts/chat/render_core.rs b/src/prompts/chat/render_core.rs
index 59f504a9b2cf341109463f106d0bc4b8979101f9..4e91d2d0ed474e69c143cd50e58e0491df58450b
--- a/src/prompts/chat/render_core.rs
+++ b/src/prompts/chat/render_core.rs
@@ -5,7 +5,7 @@
         &self,
         id: &'static str,
         label: &'static str,
-        shortcut: &'static str,
+        shortcut: Option<&'static str>,
         accent_color: u32,
         muted_color: u32,
     ) -> AnyElement {
@@ -20,10 +20,42 @@
             .rounded(px(4.0))
             .cursor_default()
             .child(div().text_xs().text_color(rgb(accent_color)).child(label))
-            .child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            .when_some(shortcut, |d, shortcut| {
+                d.child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            })
             .into_any_element()
     }
 
+    fn render_script_generation_footer_button(
+        &self,
+        id: &'static str,
+        label: &'static str,
+        shortcut: Option<&'static str>,
+        action: ScriptGenerationAction,
+        accent_color: u32,
+        muted_color: u32,
+        cx: &mut Context<Self>,
+    ) -> AnyElement {
+        div()
+            .id(id)
+            .flex()
+            .flex_row()
+            .items_center()
+            .gap(px(6.0))
+            .px(px(8.0))
+            .py(px(2.0))
+            .rounded(px(4.0))
+            .cursor_pointer()
+            .child(div().text_xs().text_color(rgb(accent_color)).child(label))
+            .when_some(shortcut, |d, shortcut| {
+                d.child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            })
+            .on_click(cx.listener(move |this, _event, _window, cx| {
+                this.handle_script_generation_action(action, cx);
+            }))
+            .into_any_element()
+    }
+
     fn render_footer(&self, cx: &mut Context<Self>) -> impl IntoElement {
         let footer_colors = PromptFooterColors::from_theme(&self.theme);
         let footer_bg = rgba(crate::components::prompt_footer::footer_surface_rgba(
@@ -40,11 +72,59 @@
                 .into_any_element()
         };
 
-        let mut right_side = div().flex().flex_row().items_center().min_w(px(0.));
-        if let Some(script_actions) = self.render_script_generation_footer_actions(cx) {
-            right_side = right_side.child(script_actions).child(divider());
+        let mut left_side = div()
+            .flex()
+            .flex_row()
+            .items_center()
+            .gap(px(8.0))
+            .flex_1()
+            .min_w(px(0.0))
+            .overflow_hidden()
+            .child(
+                svg()
+                    .external_path(crate::utils::get_logo_path())
+                    .size(px(16.0))
+                    .ml(px(2.0))
+                    .text_color(rgb(footer_colors.accent)),
+            )
+            .child(
+                div()
+                    .max_w(px(420.0))
+                    .overflow_hidden()
+                    .text_ellipsis()
+                    .whitespace_nowrap()
+                    .text_xs()
+                    .text_color(rgb(footer_colors.accent))
+                    .child(model_text),
+            );
+
+        if self.script_generation_mode {
+            if let Some(script_actions) = self.render_script_generation_footer_actions(cx) {
+                left_side = left_side.child(divider()).child(script_actions);
+            }
         }
 
+        let mut right_side = div().flex().flex_row().items_center().min_w(px(0.));
+        let primary_button = if self.script_generation_mode {
+            self.render_script_generation_footer_button(
+                "chat-footer-primary-button",
+                "Save and Run",
+                None,
+                ScriptGenerationAction::SaveAndRun,
+                footer_colors.accent,
+                footer_colors.text_muted,
+                cx,
+            )
+        } else {
+            self.render_footer_button(
+                "chat-footer-primary-button",
+                "Continue in Chat",
+                Some("⌘↵"),
+                footer_colors.accent,
+                footer_colors.text_muted,
+            )
+        };
+
         right_side = right_side
             .child(
                 div()
@@ -53,18 +133,12 @@
                     .child("Shift+Enter newline"),
             )
             .child(divider())
-            .child(self.render_footer_button(
-                "chat-footer-primary-button",
-                "Continue in Chat",
-                "⌘↵",
-                footer_colors.accent,
-                footer_colors.text_muted,
-            ))
+            .child(primary_button)
             .child(divider())
             .child(self.render_footer_button(
                 "chat-footer-secondary-button",
                 "Actions",
-                "⌘K",
+                Some("⌘K"),
                 footer_colors.accent,
                 footer_colors.text_muted,
             ));
@@ -87,33 +161,7 @@
             .border_t_1()
             .border_color(rgba((footer_colors.border << 8) | 0x50))
             .bg(footer_bg)
-            .child(
-                div()
-                    .flex()
-                    .flex_row()
-                    .items_center()
-                    .gap(px(8.0))
-                    .flex_1()
-                    .min_w(px(0.0))
-                    .overflow_hidden()
-                    .child(
-                        svg()
-                            .external_path(crate::utils::get_logo_path())
-                            .size(px(16.0))
-                            .ml(px(2.0))
-                            .text_color(rgb(footer_colors.accent)),
-                    )
-                    .child(
-                        div()
-                            .max_w(px(420.0))
-                            .overflow_hidden()
-                            .text_ellipsis()
-                            .whitespace_nowrap()
-                            .text_xs()
-                            .text_color(rgb(footer_colors.accent))
-                            .child(model_text),
-                    ),
-            )
+            .child(left_side)
             .child(right_side)
     }
 
@@ -128,49 +176,36 @@
             return None;
         }
 
-        let colors = &self.prompt_colors;
         let theme_colors = &self.theme.colors;
-        let button_bg = theme::hover_overlay_bg(&self.theme, 0x24);
-        let button_hover_bg = theme::hover_overlay_bg(&self.theme, 0x36);
+        let footer_colors = PromptFooterColors::from_theme(&self.theme);
 
         let mut action_container = div()
             .id("chat-script-generation-footer-actions")
             .flex()
             .flex_row()
             .items_center()
-            .gap(px(6.0))
+            .gap(px(2.0))
             .min_w(px(0.0));
 
         if show_actions {
-            let button = |id: &'static str,
-                          label: &'static str,
-                          action: ScriptGenerationAction|
-             -> AnyElement {
-                div()
-                    .id(format!("chat-script-generation-{}", id))
-                    .px(px(8.0))
-                    .py(px(2.0))
-                    .rounded(px(6.0))
-                    .bg(button_bg)
-                    .cursor_pointer()
-                    .hover(move |d| d.bg(button_hover_bg))
-                    .text_xs()
-                    .font_weight(gpui::FontWeight::MEDIUM)
-                    .text_color(rgb(colors.text_primary))
-                    .child(label)
-                    .on_click(cx.listener(move |this, _event, _window, cx| {
-                        this.handle_script_generation_action(action, cx);
-                    }))
-                    .into_any_element()
-            };
-
             action_container = action_container
-                .child(button("save", "Save", ScriptGenerationAction::Save))
-                .child(button("run", "Run", ScriptGenerationAction::Run))
-                .child(button(
-                    "save-and-run",
-                    "Save and Run",
-                    ScriptGenerationAction::SaveAndRun,
+                .child(self.render_script_generation_footer_button(
+                    "chat-script-generation-save",
+                    "Save",
+                    None,
+                    ScriptGenerationAction::Save,
+                    footer_colors.accent,
+                    footer_colors.text_muted,
+                    cx,
+                ))
+                .child(self.render_script_generation_footer_button(
+                    "chat-script-generation-run",
+                    "Run",
+                    None,
+                    ScriptGenerationAction::Run,
+                    footer_colors.accent,
+                    footer_colors.text_muted,
+                    cx,
                 ));
         }
 
@@ -560,10 +595,56 @@
             .child(input_area)
             // Scrollable message area
             .child(messages_content)
-            // Footer with model selector, Continue in Chat, and Actions
+            // Footer with model selector and footer actions
             .child(self.render_footer(cx))
             // Note: Actions menu is now handled by parent via on_show_actions callback
             // The parent opens the standard ActionsDialog window
             .into_any_element()
     }
 }
+
+#[cfg(test)]
+mod render_core_footer_tests {
+    use std::fs;
+
+    #[test]
+    fn test_script_generation_mode_replaces_continue_with_save_and_run_primary_button() {
+        let content = fs::read_to_string("src/prompts/chat/render_core.rs")
+            .expect("Failed to read src/prompts/chat/render_core.rs");
+        let normalized: String = content.chars().filter(|c| !c.is_whitespace()).collect();
+
+        assert!(
+            normalized.contains("letprimary_button=ifself.script_generation_mode{"),
+            "Footer primary action should branch on script_generation_mode"
+        );
+        assert!(
+            normalized.contains("\"chat-footer-primary-button\",\"SaveandRun\",None,ScriptGenerationAction::SaveAndRun,"),
+            "Script generation mode should render Save and Run as the primary footer action"
+        );
+        assert!(
+            normalized.contains(
+                "}else{self.render_footer_button(\"chat-footer-primary-button\",\"ContinueinChat\",Some(\"⌘↵\"),"
+            ),
+            "Non-script mode should keep Continue in Chat as the primary footer action"
+        );
+    }
+
+    #[test]
+    fn test_script_generation_secondary_footer_actions_render_save_and_run_only() {
+        let content = fs::read_to_string("src/prompts/chat/render_core.rs")
+            .expect("Failed to read src/prompts/chat/render_core.rs");
+
+        assert!(
+            content.contains("\"chat-script-generation-save\""),
+            "Script generation footer should render Save action"
+        );
+        assert!(
+            content.contains("\"chat-script-generation-run\""),
+            "Script generation footer should render Run action"
+        );
+        assert!(
+            !content.contains("\"chat-script-generation-save-and-run\""),
+            "Save and Run should only appear as the primary footer action slot"
+        );
+    }
+}


thinking
**Revalidating build after formatting**
exec
/bin/zsh -lc 'cargo check -p script-kit-gpui' in /Users/johnlindquist/dev/script-kit-gpui succeeded in 255ms:
warning: glob import doesn't reexport anything with visibility `pub(in crate::prompts)` because no imported item is public enough
  --> src/prompts/div/mod.rs:32:16
   |
32 | pub(super) use inline::*;
   |                ^^^^^^^^^
   |
note: the most public imported item is `pub(self)`
  --> src/prompts/div/mod.rs:32:16
   |
32 | pub(super) use inline::*;
   |                ^^^^^^^^^
   = help: reduce the glob import's visibility or increase visibility of imported items
   = note: `#[warn(unused_imports)]` (part of `#[warn(unused)]`) on by default

warning: glob import doesn't reexport anything with visibility `pub(in crate::prompts)` because no imported item is public enough
  --> src/prompts/div/mod.rs:34:16
   |
34 | pub(super) use render_html::*;
   |                ^^^^^^^^^^^^^^
   |
file update:
diff --git a/src/prompts/chat/render_core.rs b/src/prompts/chat/render_core.rs
index 59f504a9b2cf341109463f106d0bc4b8979101f9..4e91d2d0ed474e69c143cd50e58e0491df58450b
--- a/src/prompts/chat/render_core.rs
+++ b/src/prompts/chat/render_core.rs
@@ -5,7 +5,7 @@
         &self,
         id: &'static str,
         label: &'static str,
-        shortcut: &'static str,
+        shortcut: Option<&'static str>,
         accent_color: u32,
         muted_color: u32,
     ) -> AnyElement {
@@ -20,10 +20,42 @@
             .rounded(px(4.0))
             .cursor_default()
             .child(div().text_xs().text_color(rgb(accent_color)).child(label))
-            .child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            .when_some(shortcut, |d, shortcut| {
+                d.child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            })
             .into_any_element()
     }
 
+    fn render_script_generation_footer_button(
+        &self,
+        id: &'static str,
+        label: &'static str,
+        shortcut: Option<&'static str>,
+        action: ScriptGenerationAction,
+        accent_color: u32,
+        muted_color: u32,
+        cx: &mut Context<Self>,
+    ) -> AnyElement {
+        div()
+            .id(id)
+            .flex()
+            .flex_row()
+            .items_center()
+            .gap(px(6.0))
+            .px(px(8.0))
+            .py(px(2.0))
+            .rounded(px(4.0))
+            .cursor_pointer()
+            .child(div().text_xs().text_color(rgb(accent_color)).child(label))
+            .when_some(shortcut, |d, shortcut| {
+                d.child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            })
+            .on_click(cx.listener(move |this, _event, _window, cx| {
+                this.handle_script_generation_action(action, cx);
+            }))
+            .into_any_element()
+    }
+
     fn render_footer(&self, cx: &mut Context<Self>) -> impl IntoElement {
         let footer_colors = PromptFooterColors::from_theme(&self.theme);
         let footer_bg = rgba(crate::components::prompt_footer::footer_surface_rgba(
@@ -40,11 +72,59 @@
                 .into_any_element()
         };
 
-        let mut right_side = div().flex().flex_row().items_center().min_w(px(0.));
-        if let Some(script_actions) = self.render_script_generation_footer_actions(cx) {
-            right_side = right_side.child(script_actions).child(divider());
+        let mut left_side = div()
+            .flex()
+            .flex_row()
+            .items_center()
+            .gap(px(8.0))
+            .flex_1()
+            .min_w(px(0.0))
+            .overflow_hidden()
+            .child(
+                svg()
+                    .external_path(crate::utils::get_logo_path())
+                    .size(px(16.0))
+                    .ml(px(2.0))
+                    .text_color(rgb(footer_colors.accent)),
+            )
+            .child(
+                div()
+                    .max_w(px(420.0))
+                    .overflow_hidden()
+                    .text_ellipsis()
+                    .whitespace_nowrap()
+                    .text_xs()
+                    .text_color(rgb(footer_colors.accent))
+                    .child(model_text),
+            );
+
+        if self.script_generation_mode {
+            if let Some(script_actions) = self.render_script_generation_footer_actions(cx) {
+                left_side = left_side.child(divider()).child(script_actions);
+            }
         }
 
+        let mut right_side = div().flex().flex_row().items_center().min_w(px(0.));
+        let primary_button = if self.script_generation_mode {
+            self.render_script_generation_footer_button(
+                "chat-footer-primary-button",
+                "Save and Run",
+                None,
+                ScriptGenerationAction::SaveAndRun,
+                footer_colors.accent,
+                footer_colors.text_muted,
+                cx,
+            )
+        } else {
+            self.render_footer_button(
+                "chat-footer-primary-button",
+                "Continue in Chat",
+                Some("⌘↵"),
+                footer_colors.accent,
+                footer_colors.text_muted,
+            )
+        };
+
         right_side = right_side
             .child(
                 div()
@@ -53,18 +133,12 @@
                     .child("Shift+Enter newline"),
             )
             .child(divider())
-            .child(self.render_footer_button(
-                "chat-footer-primary-button",
-                "Continue in Chat",
-                "⌘↵",
-                footer_colors.accent,
-                footer_colors.text_muted,
-            ))
+            .child(primary_button)
             .child(divider())
             .child(self.render_footer_button(
                 "chat-footer-secondary-button",
                 "Actions",
-                "⌘K",
+                Some("⌘K"),
                 footer_colors.accent,
                 footer_colors.text_muted,
             ));
@@ -87,33 +161,7 @@
             .border_t_1()
             .border_color(rgba((footer_colors.border << 8) | 0x50))
             .bg(footer_bg)
-            .child(
-                div()
-                    .flex()
-                    .flex_row()
-                    .items_center()
-                    .gap(px(8.0))
-                    .flex_1()
-                    .min_w(px(0.0))
-                    .overflow_hidden()
-                    .child(
-                        svg()
-                            .external_path(crate::utils::get_logo_path())
-                            .size(px(16.0))
-                            .ml(px(2.0))
-                            .text_color(rgb(footer_colors.accent)),
-                    )
-                    .child(
-                        div()
-                            .max_w(px(420.0))
-                            .overflow_hidden()
-                            .text_ellipsis()
-                            .whitespace_nowrap()
-                            .text_xs()
-                            .text_color(rgb(footer_colors.accent))
-                            .child(model_text),
-                    ),
-            )
+            .child(left_side)
             .child(right_side)
     }
 
@@ -128,49 +176,36 @@
             return None;
         }
 
-        let colors = &self.prompt_colors;
         let theme_colors = &self.theme.colors;
-        let button_bg = theme::hover_overlay_bg(&self.theme, 0x24);
-        let button_hover_bg = theme::hover_overlay_bg(&self.theme, 0x36);
+        let footer_colors = PromptFooterColors::from_theme(&self.theme);
 
         let mut action_container = div()
             .id("chat-script-generation-footer-actions")
             .flex()
             .flex_row()
             .items_center()
-            .gap(px(6.0))
+            .gap(px(2.0))
             .min_w(px(0.0));
 
         if show_actions {
-            let button = |id: &'static str,
-                          label: &'static str,
-                          action: ScriptGenerationAction|
-             -> AnyElement {
-                div()
-                    .id(format!("chat-script-generation-{}", id))
-                    .px(px(8.0))
-                    .py(px(2.0))
-                    .rounded(px(6.0))
-                    .bg(button_bg)
-                    .cursor_pointer()
-                    .hover(move |d| d.bg(button_hover_bg))
-                    .text_xs()
-                    .font_weight(gpui::FontWeight::MEDIUM)
-                    .text_color(rgb(colors.text_primary))
-                    .child(label)
-                    .on_click(cx.listener(move |this, _event, _window, cx| {
-                        this.handle_script_generation_action(action, cx);
-                    }))
-                    .into_any_element()
-            };
-
             action_container = action_container
-                .child(button("save", "Save", ScriptGenerationAction::Save))
-                .child(button("run", "Run", ScriptGenerationAction::Run))
-                .child(button(
-                    "save-and-run",
-                    "Save and Run",
-                    ScriptGenerationAction::SaveAndRun,
+                .child(self.render_script_generation_footer_button(
+                    "chat-script-generation-save",
+                    "Save",
+                    None,
+                    ScriptGenerationAction::Save,
+                    footer_colors.accent,
+                    footer_colors.text_muted,
+                    cx,
+                ))
+                .child(self.render_script_generation_footer_button(
+                    "chat-script-generation-run",
+                    "Run",
+                    None,
+                    ScriptGenerationAction::Run,
+                    footer_colors.accent,
+                    footer_colors.text_muted,
+                    cx,
                 ));
         }
 
@@ -560,10 +595,56 @@
             .child(input_area)
             // Scrollable message area
             .child(messages_content)
-            // Footer with model selector, Continue in Chat, and Actions
+            // Footer with model selector and footer actions
             .child(self.render_footer(cx))
             // Note: Actions menu is now handled by parent via on_show_actions callback
             // The parent opens the standard ActionsDialog window
             .into_any_element()
     }
 }
+
+#[cfg(test)]
+mod render_core_footer_tests {
+    use std::fs;
+
+    #[test]
+    fn test_script_generation_mode_replaces_continue_with_save_and_run_primary_button() {
+        let content = fs::read_to_string("src/prompts/chat/render_core.rs")
+            .expect("Failed to read src/prompts/chat/render_core.rs");
+        let normalized: String = content.chars().filter(|c| !c.is_whitespace()).collect();
+
+        assert!(
+            normalized.contains("letprimary_button=ifself.script_generation_mode{"),
+            "Footer primary action should branch on script_generation_mode"
+        );
+        assert!(
+            normalized.contains("\"chat-footer-primary-button\",\"SaveandRun\",None,ScriptGenerationAction::SaveAndRun,"),
+            "Script generation mode should render Save and Run as the primary footer action"
+        );
+        assert!(
+            normalized.contains(
+                "}else{self.render_footer_button(\"chat-footer-primary-button\",\"ContinueinChat\",Some(\"⌘↵\"),"
+            ),
+            "Non-script mode should keep Continue in Chat as the primary footer action"
+        );
+    }
+
+    #[test]
+    fn test_script_generation_secondary_footer_actions_render_save_and_run_only() {
+        let content = fs::read_to_string("src/prompts/chat/render_core.rs")
+            .expect("Failed to read src/prompts/chat/render_core.rs");
+
+        assert!(
+            content.contains("\"chat-script-generation-save\""),
+            "Script generation footer should render Save action"
+        );
+        assert!(
+            content.contains("\"chat-script-generation-run\""),
+            "Script generation footer should render Run action"
+        );
+        assert!(
+            !content.contains("\"chat-script-generation-save-and-run\""),
+            "Save and Run should only appear as the primary footer action slot"
+        );
+    }
+}


thinking
**Preparing precise test context**
exec
/bin/zsh -lc "nl -ba src/prompts/chat/render_core.rs | sed -n '1,260p'" in /Users/johnlindquist/dev/script-kit-gpui succeeded in 50ms:
     1	use super::*;
     2	
     3	impl ChatPrompt {
     4	    fn render_footer_button(
     5	        &self,
     6	        id: &'static str,
     7	        label: &'static str,
     8	        shortcut: Option<&'static str>,
     9	        accent_color: u32,
    10	        muted_color: u32,
    11	    ) -> AnyElement {
    12	        div()
    13	            .id(id)
    14	            .flex()
    15	            .flex_row()
    16	            .items_center()
    17	            .gap(px(6.0))
    18	            .px(px(8.0))
    19	            .py(px(2.0))
    20	            .rounded(px(4.0))
file update:
diff --git a/src/prompts/chat/render_core.rs b/src/prompts/chat/render_core.rs
index 59f504a9b2cf341109463f106d0bc4b8979101f9..4e91d2d0ed474e69c143cd50e58e0491df58450b
--- a/src/prompts/chat/render_core.rs
+++ b/src/prompts/chat/render_core.rs
@@ -5,7 +5,7 @@
         &self,
         id: &'static str,
         label: &'static str,
-        shortcut: &'static str,
+        shortcut: Option<&'static str>,
         accent_color: u32,
         muted_color: u32,
     ) -> AnyElement {
@@ -20,10 +20,42 @@
             .rounded(px(4.0))
             .cursor_default()
             .child(div().text_xs().text_color(rgb(accent_color)).child(label))
-            .child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            .when_some(shortcut, |d, shortcut| {
+                d.child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            })
             .into_any_element()
     }
 
+    fn render_script_generation_footer_button(
+        &self,
+        id: &'static str,
+        label: &'static str,
+        shortcut: Option<&'static str>,
+        action: ScriptGenerationAction,
+        accent_color: u32,
+        muted_color: u32,
+        cx: &mut Context<Self>,
+    ) -> AnyElement {
+        div()
+            .id(id)
+            .flex()
+            .flex_row()
+            .items_center()
+            .gap(px(6.0))
+            .px(px(8.0))
+            .py(px(2.0))
+            .rounded(px(4.0))
+            .cursor_pointer()
+            .child(div().text_xs().text_color(rgb(accent_color)).child(label))
+            .when_some(shortcut, |d, shortcut| {
+                d.child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            })
+            .on_click(cx.listener(move |this, _event, _window, cx| {
+                this.handle_script_generation_action(action, cx);
+            }))
+            .into_any_element()
+    }
+
     fn render_footer(&self, cx: &mut Context<Self>) -> impl IntoElement {
         let footer_colors = PromptFooterColors::from_theme(&self.theme);
         let footer_bg = rgba(crate::components::prompt_footer::footer_surface_rgba(
@@ -40,11 +72,59 @@
                 .into_any_element()
         };
 
-        let mut right_side = div().flex().flex_row().items_center().min_w(px(0.));
-        if let Some(script_actions) = self.render_script_generation_footer_actions(cx) {
-            right_side = right_side.child(script_actions).child(divider());
+        let mut left_side = div()
+            .flex()
+            .flex_row()
+            .items_center()
+            .gap(px(8.0))
+            .flex_1()
+            .min_w(px(0.0))
+            .overflow_hidden()
+            .child(
+                svg()
+                    .external_path(crate::utils::get_logo_path())
+                    .size(px(16.0))
+                    .ml(px(2.0))
+                    .text_color(rgb(footer_colors.accent)),
+            )
+            .child(
+                div()
+                    .max_w(px(420.0))
+                    .overflow_hidden()
+                    .text_ellipsis()
+                    .whitespace_nowrap()
+                    .text_xs()
+                    .text_color(rgb(footer_colors.accent))
+                    .child(model_text),
+            );
+
+        if self.script_generation_mode {
+            if let Some(script_actions) = self.render_script_generation_footer_actions(cx) {
+                left_side = left_side.child(divider()).child(script_actions);
+            }
         }
 
+        let mut right_side = div().flex().flex_row().items_center().min_w(px(0.));
+        let primary_button = if self.script_generation_mode {
+            self.render_script_generation_footer_button(
+                "chat-footer-primary-button",
+                "Save and Run",
+                None,
+                ScriptGenerationAction::SaveAndRun,
+                footer_colors.accent,
+                footer_colors.text_muted,
+                cx,
+            )
+        } else {
+            self.render_footer_button(
+                "chat-footer-primary-button",
+                "Continue in Chat",
+                Some("⌘↵"),
+                footer_colors.accent,
+                footer_colors.text_muted,
+            )
+        };
+
         right_side = right_side
             .child(
                 div()
@@ -53,18 +133,12 @@
                     .child("Shift+Enter newline"),
             )
             .child(divider())
-            .child(self.render_footer_button(
-                "chat-footer-primary-button",
-                "Continue in Chat",
-                "⌘↵",
-                footer_colors.accent,
-                footer_colors.text_muted,
-            ))
+            .child(primary_button)
             .child(divider())
             .child(self.render_footer_button(
                 "chat-footer-secondary-button",
                 "Actions",
-                "⌘K",
+                Some("⌘K"),
                 footer_colors.accent,
                 footer_colors.text_muted,
             ));
@@ -87,33 +161,7 @@
             .border_t_1()
             .border_color(rgba((footer_colors.border << 8) | 0x50))
             .bg(footer_bg)
-            .child(
-                div()
-                    .flex()
-                    .flex_row()
-                    .items_center()
-                    .gap(px(8.0))
-                    .flex_1()
-                    .min_w(px(0.0))
-                    .overflow_hidden()
-                    .child(
-                        svg()
-                            .external_path(crate::utils::get_logo_path())
-                            .size(px(16.0))
-                            .ml(px(2.0))
-                            .text_color(rgb(footer_colors.accent)),
-                    )
-                    .child(
-                        div()
-                            .max_w(px(420.0))
-                            .overflow_hidden()
-                            .text_ellipsis()
-                            .whitespace_nowrap()
-                            .text_xs()
-                            .text_color(rgb(footer_colors.accent))
-                            .child(model_text),
-                    ),
-            )
+            .child(left_side)
             .child(right_side)
     }
 
@@ -128,49 +176,36 @@
             return None;
         }
 
-        let colors = &self.prompt_colors;
         let theme_colors = &self.theme.colors;
-        let button_bg = theme::hover_overlay_bg(&self.theme, 0x24);
-        let button_hover_bg = theme::hover_overlay_bg(&self.theme, 0x36);
+        let footer_colors = PromptFooterColors::from_theme(&self.theme);
 
         let mut action_container = div()
             .id("chat-script-generation-footer-actions")
             .flex()
             .flex_row()
             .items_center()
-            .gap(px(6.0))
+            .gap(px(2.0))
             .min_w(px(0.0));
 
         if show_actions {
-            let button = |id: &'static str,
-                          label: &'static str,
-                          action: ScriptGenerationAction|
-             -> AnyElement {
-                div()
-                    .id(format!("chat-script-generation-{}", id))
-                    .px(px(8.0))
-                    .py(px(2.0))
-                    .rounded(px(6.0))
-                    .bg(button_bg)
-                    .cursor_pointer()
-                    .hover(move |d| d.bg(button_hover_bg))
-                    .text_xs()
-                    .font_weight(gpui::FontWeight::MEDIUM)
-                    .text_color(rgb(colors.text_primary))
-                    .child(label)
-                    .on_click(cx.listener(move |this, _event, _window, cx| {
-                        this.handle_script_generation_action(action, cx);
-                    }))
-                    .into_any_element()
-            };
-
             action_container = action_container
-                .child(button("save", "Save", ScriptGenerationAction::Save))
-                .child(button("run", "Run", ScriptGenerationAction::Run))
-                .child(button(
-                    "save-and-run",
-                    "Save and Run",
-                    ScriptGenerationAction::SaveAndRun,
+                .child(self.render_script_generation_footer_button(
+                    "chat-script-generation-save",
+                    "Save",
+                    None,
+                    ScriptGenerationAction::Save,
+                    footer_colors.accent,
+                    footer_colors.text_muted,
+                    cx,
+                ))
+                .child(self.render_script_generation_footer_button(
+                    "chat-script-generation-run",
+                    "Run",
+                    None,
+                    ScriptGenerationAction::Run,
+                    footer_colors.accent,
+                    footer_colors.text_muted,
+                    cx,
                 ));
         }
 
@@ -560,10 +595,56 @@
             .child(input_area)
             // Scrollable message area
             .child(messages_content)
-            // Footer with model selector, Continue in Chat, and Actions
+            // Footer with model selector and footer actions
             .child(self.render_footer(cx))
             // Note: Actions menu is now handled by parent via on_show_actions callback
             // The parent opens the standard ActionsDialog window
             .into_any_element()
     }
 }
+
+#[cfg(test)]
+mod render_core_footer_tests {
+    use std::fs;
+
+    #[test]
+    fn test_script_generation_mode_replaces_continue_with_save_and_run_primary_button() {
+        let content = fs::read_to_string("src/prompts/chat/render_core.rs")
+            .expect("Failed to read src/prompts/chat/render_core.rs");
+        let normalized: String = content.chars().filter(|c| !c.is_whitespace()).collect();
+
+        assert!(
+            normalized.contains("letprimary_button=ifself.script_generation_mode{"),
+            "Footer primary action should branch on script_generation_mode"
+        );
+        assert!(
+            normalized.contains("\"chat-footer-primary-button\",\"SaveandRun\",None,ScriptGenerationAction::SaveAndRun,"),
+            "Script generation mode should render Save and Run as the primary footer action"
+        );
+        assert!(
+            normalized.contains(
+                "}else{self.render_footer_button(\"chat-footer-primary-button\",\"ContinueinChat\",Some(\"⌘↵\"),"
+            ),
+            "Non-script mode should keep Continue in Chat as the primary footer action"
+        );
+    }
+
+    #[test]
+    fn test_script_generation_secondary_footer_actions_render_save_and_run_only() {
+        let content = fs::read_to_string("src/prompts/chat/render_core.rs")
+            .expect("Failed to read src/prompts/chat/render_core.rs");
+
+        assert!(
+            content.contains("\"chat-script-generation-save\""),
+            "Script generation footer should render Save action"
+        );
+        assert!(
+            content.contains("\"chat-script-generation-run\""),
+            "Script generation footer should render Run action"
+        );
+        assert!(
+            !content.contains("\"chat-script-generation-save-and-run\""),
+            "Save and Run should only appear as the primary footer action slot"
+        );
+    }
+}

exec
/bin/zsh -lc "nl -ba src/prompts/chat/render_core.rs | sed -n '560,700p'" in /Users/johnlindquist/dev/script-kit-gpui succeeded in 51ms:
   560	                            ),
   561	                    )
   562	                })
   563	                .into_any_element()
   564	        } else {
   565	            div()
   566	                .id("chat-messages")
   567	                .flex_1()
   568	                .min_h(px(0.))
   569	                .overflow_y_scroll()
   570	                .child(
   571	                    div()
   572	                        .flex()
   573	                        .flex_col()
   574	                        .w_full()
   575	                        .px(px(12.0))
   576	                        .py(px(12.0))
   577	                        .child(self.render_conversation_starters(cx)),
   578	                )
   579	                .into_any_element()
file update:
diff --git a/src/prompts/chat/render_core.rs b/src/prompts/chat/render_core.rs
index 59f504a9b2cf341109463f106d0bc4b8979101f9..4e91d2d0ed474e69c143cd50e58e0491df58450b
--- a/src/prompts/chat/render_core.rs
+++ b/src/prompts/chat/render_core.rs
@@ -5,7 +5,7 @@
         &self,
         id: &'static str,
         label: &'static str,
-        shortcut: &'static str,
+        shortcut: Option<&'static str>,
         accent_color: u32,
         muted_color: u32,
     ) -> AnyElement {
@@ -20,10 +20,42 @@
             .rounded(px(4.0))
             .cursor_default()
             .child(div().text_xs().text_color(rgb(accent_color)).child(label))
-            .child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            .when_some(shortcut, |d, shortcut| {
+                d.child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            })
             .into_any_element()
     }
 
+    fn render_script_generation_footer_button(
+        &self,
+        id: &'static str,
+        label: &'static str,
+        shortcut: Option<&'static str>,
+        action: ScriptGenerationAction,
+        accent_color: u32,
+        muted_color: u32,
+        cx: &mut Context<Self>,
+    ) -> AnyElement {
+        div()
+            .id(id)
+            .flex()
+            .flex_row()
+            .items_center()
+            .gap(px(6.0))
+            .px(px(8.0))
+            .py(px(2.0))
+            .rounded(px(4.0))
+            .cursor_pointer()
+            .child(div().text_xs().text_color(rgb(accent_color)).child(label))
+            .when_some(shortcut, |d, shortcut| {
+                d.child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            })
+            .on_click(cx.listener(move |this, _event, _window, cx| {
+                this.handle_script_generation_action(action, cx);
+            }))
+            .into_any_element()
+    }
+
     fn render_footer(&self, cx: &mut Context<Self>) -> impl IntoElement {
         let footer_colors = PromptFooterColors::from_theme(&self.theme);
         let footer_bg = rgba(crate::components::prompt_footer::footer_surface_rgba(
@@ -40,11 +72,59 @@
                 .into_any_element()
         };
 
-        let mut right_side = div().flex().flex_row().items_center().min_w(px(0.));
-        if let Some(script_actions) = self.render_script_generation_footer_actions(cx) {
-            right_side = right_side.child(script_actions).child(divider());
+        let mut left_side = div()
+            .flex()
+            .flex_row()
+            .items_center()
+            .gap(px(8.0))
+            .flex_1()
+            .min_w(px(0.0))
+            .overflow_hidden()
+            .child(
+                svg()
+                    .external_path(crate::utils::get_logo_path())
+                    .size(px(16.0))
+                    .ml(px(2.0))
+                    .text_color(rgb(footer_colors.accent)),
+            )
+            .child(
+                div()
+                    .max_w(px(420.0))
+                    .overflow_hidden()
+                    .text_ellipsis()
+                    .whitespace_nowrap()
+                    .text_xs()
+                    .text_color(rgb(footer_colors.accent))
+                    .child(model_text),
+            );
+
+        if self.script_generation_mode {
+            if let Some(script_actions) = self.render_script_generation_footer_actions(cx) {
+                left_side = left_side.child(divider()).child(script_actions);
+            }
         }
 
+        let mut right_side = div().flex().flex_row().items_center().min_w(px(0.));
+        let primary_button = if self.script_generation_mode {
+            self.render_script_generation_footer_button(
+                "chat-footer-primary-button",
+                "Save and Run",
+                None,
+                ScriptGenerationAction::SaveAndRun,
+                footer_colors.accent,
+                footer_colors.text_muted,
+                cx,
+            )
+        } else {
+            self.render_footer_button(
+                "chat-footer-primary-button",
+                "Continue in Chat",
+                Some("⌘↵"),
+                footer_colors.accent,
+                footer_colors.text_muted,
+            )
+        };
+
         right_side = right_side
             .child(
                 div()
@@ -53,18 +133,12 @@
                     .child("Shift+Enter newline"),
             )
             .child(divider())
-            .child(self.render_footer_button(
-                "chat-footer-primary-button",
-                "Continue in Chat",
-                "⌘↵",
-                footer_colors.accent,
-                footer_colors.text_muted,
-            ))
+            .child(primary_button)
             .child(divider())
             .child(self.render_footer_button(
                 "chat-footer-secondary-button",
                 "Actions",
-                "⌘K",
+                Some("⌘K"),
                 footer_colors.accent,
                 footer_colors.text_muted,
             ));
@@ -87,33 +161,7 @@
             .border_t_1()
             .border_color(rgba((footer_colors.border << 8) | 0x50))
             .bg(footer_bg)
-            .child(
-                div()
-                    .flex()
-                    .flex_row()
-                    .items_center()
-                    .gap(px(8.0))
-                    .flex_1()
-                    .min_w(px(0.0))
-                    .overflow_hidden()
-                    .child(
-                        svg()
-                            .external_path(crate::utils::get_logo_path())
-                            .size(px(16.0))
-                            .ml(px(2.0))
-                            .text_color(rgb(footer_colors.accent)),
-                    )
-                    .child(
-                        div()
-                            .max_w(px(420.0))
-                            .overflow_hidden()
-                            .text_ellipsis()
-                            .whitespace_nowrap()
-                            .text_xs()
-                            .text_color(rgb(footer_colors.accent))
-                            .child(model_text),
-                    ),
-            )
+            .child(left_side)
             .child(right_side)
     }
 
@@ -128,49 +176,36 @@
             return None;
         }
 
-        let colors = &self.prompt_colors;
         let theme_colors = &self.theme.colors;
-        let button_bg = theme::hover_overlay_bg(&self.theme, 0x24);
-        let button_hover_bg = theme::hover_overlay_bg(&self.theme, 0x36);
+        let footer_colors = PromptFooterColors::from_theme(&self.theme);
 
         let mut action_container = div()
             .id("chat-script-generation-footer-actions")
             .flex()
             .flex_row()
             .items_center()
-            .gap(px(6.0))
+            .gap(px(2.0))
             .min_w(px(0.0));
 
         if show_actions {
-            let button = |id: &'static str,
-                          label: &'static str,
-                          action: ScriptGenerationAction|
-             -> AnyElement {
-                div()
-                    .id(format!("chat-script-generation-{}", id))
-                    .px(px(8.0))
-                    .py(px(2.0))
-                    .rounded(px(6.0))
-                    .bg(button_bg)
-                    .cursor_pointer()
-                    .hover(move |d| d.bg(button_hover_bg))
-                    .text_xs()
-                    .font_weight(gpui::FontWeight::MEDIUM)
-                    .text_color(rgb(colors.text_primary))
-                    .child(label)
-                    .on_click(cx.listener(move |this, _event, _window, cx| {
-                        this.handle_script_generation_action(action, cx);
-                    }))
-                    .into_any_element()
-            };
-
             action_container = action_container
-                .child(button("save", "Save", ScriptGenerationAction::Save))
-                .child(button("run", "Run", ScriptGenerationAction::Run))
-                .child(button(
-                    "save-and-run",
-                    "Save and Run",
-                    ScriptGenerationAction::SaveAndRun,
+                .child(self.render_script_generation_footer_button(
+                    "chat-script-generation-save",
+                    "Save",
+                    None,
+                    ScriptGenerationAction::Save,
+                    footer_colors.accent,
+                    footer_colors.text_muted,
+                    cx,
+                ))
+                .child(self.render_script_generation_footer_button(
+                    "chat-script-generation-run",
+                    "Run",
+                    None,
+                    ScriptGenerationAction::Run,
+                    footer_colors.accent,
+                    footer_colors.text_muted,
+                    cx,
                 ));
         }
 
@@ -560,10 +595,56 @@
             .child(input_area)
             // Scrollable message area
             .child(messages_content)
-            // Footer with model selector, Continue in Chat, and Actions
+            // Footer with model selector and footer actions
             .child(self.render_footer(cx))
             // Note: Actions menu is now handled by parent via on_show_actions callback
             // The parent opens the standard ActionsDialog window
             .into_any_element()
     }
 }
+
+#[cfg(test)]
+mod render_core_footer_tests {
+    use std::fs;
+
+    #[test]
+    fn test_script_generation_mode_replaces_continue_with_save_and_run_primary_button() {
+        let content = fs::read_to_string("src/prompts/chat/render_core.rs")
+            .expect("Failed to read src/prompts/chat/render_core.rs");
+        let normalized: String = content.chars().filter(|c| !c.is_whitespace()).collect();
+
+        assert!(
+            normalized.contains("letprimary_button=ifself.script_generation_mode{"),
+            "Footer primary action should branch on script_generation_mode"
+        );
+        assert!(
+            normalized.contains("\"chat-footer-primary-button\",\"SaveandRun\",None,ScriptGenerationAction::SaveAndRun,"),
+            "Script generation mode should render Save and Run as the primary footer action"
+        );
+        assert!(
+            normalized.contains(
+                "}else{self.render_footer_button(\"chat-footer-primary-button\",\"ContinueinChat\",Some(\"⌘↵\"),"
+            ),
+            "Non-script mode should keep Continue in Chat as the primary footer action"
+        );
+    }
+
+    #[test]
+    fn test_script_generation_secondary_footer_actions_render_save_and_run_only() {
+        let content = fs::read_to_string("src/prompts/chat/render_core.rs")
+            .expect("Failed to read src/prompts/chat/render_core.rs");
+
+        assert!(
+            content.contains("\"chat-script-generation-save\""),
+            "Script generation footer should render Save action"
+        );
+        assert!(
+            content.contains("\"chat-script-generation-run\""),
+            "Script generation footer should render Run action"
+        );
+        assert!(
+            !content.contains("\"chat-script-generation-save-and-run\""),
+            "Save and Run should only appear as the primary footer action slot"
+        );
+    }
+}


thinking
**Confirming prompt file unchanged**
codex
I’m done with implementation and verification for this task scope. I’m now marking swarm status `done` and releasing both file claims so other agents can continue.
exec
/bin/zsh -lc '~/.claude/bin/swarm.ts update --id codex-footer-button-style --status done --notes "Footer buttons restyled to match text-only footer style; script mode now replaces Continue with Save and Run primary; Save/Run moved near model; cargo check -p script-kit-gpui passed"' in /Users/johnlindquist/dev/script-kit-gpuiexec
/bin/zsh -lc '~/.claude/bin/swarm.ts release --id codex-footer-button-style src/prompts/chat/render_core.rs' in /Users/johnlindquist/dev/script-kit-gpui succeeded in 51ms:
Updated: codex-footer-button-style
 succeeded in 51ms:
Released for codex-footer-button-style: src/prompts/chat/render_core.rs
exec
/bin/zsh -lc '~/.claude/bin/swarm.ts release --id codex-footer-button-style src/prompts/chat/prompt.rs' in /Users/johnlindquist/dev/script-kit-gpui succeeded in 108ms:
Released for codex-footer-button-style: src/prompts/chat/prompt.rs
file update:
diff --git a/src/prompts/chat/render_core.rs b/src/prompts/chat/render_core.rs
index 59f504a9b2cf341109463f106d0bc4b8979101f9..4e91d2d0ed474e69c143cd50e58e0491df58450b
--- a/src/prompts/chat/render_core.rs
+++ b/src/prompts/chat/render_core.rs
@@ -5,7 +5,7 @@
         &self,
         id: &'static str,
         label: &'static str,
-        shortcut: &'static str,
+        shortcut: Option<&'static str>,
         accent_color: u32,
         muted_color: u32,
     ) -> AnyElement {
@@ -20,10 +20,42 @@
             .rounded(px(4.0))
             .cursor_default()
             .child(div().text_xs().text_color(rgb(accent_color)).child(label))
-            .child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            .when_some(shortcut, |d, shortcut| {
+                d.child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            })
             .into_any_element()
     }
 
+    fn render_script_generation_footer_button(
+        &self,
+        id: &'static str,
+        label: &'static str,
+        shortcut: Option<&'static str>,
+        action: ScriptGenerationAction,
+        accent_color: u32,
+        muted_color: u32,
+        cx: &mut Context<Self>,
+    ) -> AnyElement {
+        div()
+            .id(id)
+            .flex()
+            .flex_row()
+            .items_center()
+            .gap(px(6.0))
+            .px(px(8.0))
+            .py(px(2.0))
+            .rounded(px(4.0))
+            .cursor_pointer()
+            .child(div().text_xs().text_color(rgb(accent_color)).child(label))
+            .when_some(shortcut, |d, shortcut| {
+                d.child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            })
+            .on_click(cx.listener(move |this, _event, _window, cx| {
+                this.handle_script_generation_action(action, cx);
+            }))
+            .into_any_element()
+    }
+
     fn render_footer(&self, cx: &mut Context<Self>) -> impl IntoElement {
         let footer_colors = PromptFooterColors::from_theme(&self.theme);
         let footer_bg = rgba(crate::components::prompt_footer::footer_surface_rgba(
@@ -40,11 +72,59 @@
                 .into_any_element()
         };
 
-        let mut right_side = div().flex().flex_row().items_center().min_w(px(0.));
-        if let Some(script_actions) = self.render_script_generation_footer_actions(cx) {
-            right_side = right_side.child(script_actions).child(divider());
+        let mut left_side = div()
+            .flex()
+            .flex_row()
+            .items_center()
+            .gap(px(8.0))
+            .flex_1()
+            .min_w(px(0.0))
+            .overflow_hidden()
+            .child(
+                svg()
+                    .external_path(crate::utils::get_logo_path())
+                    .size(px(16.0))
+                    .ml(px(2.0))
+                    .text_color(rgb(footer_colors.accent)),
+            )
+            .child(
+                div()
+                    .max_w(px(420.0))
+                    .overflow_hidden()
+                    .text_ellipsis()
+                    .whitespace_nowrap()
+                    .text_xs()
+                    .text_color(rgb(footer_colors.accent))
+                    .child(model_text),
+            );
+
+        if self.script_generation_mode {
+            if let Some(script_actions) = self.render_script_generation_footer_actions(cx) {
+                left_side = left_side.child(divider()).child(script_actions);
+            }
         }
 
+        let mut right_side = div().flex().flex_row().items_center().min_w(px(0.));
+        let primary_button = if self.script_generation_mode {
+            self.render_script_generation_footer_button(
+                "chat-footer-primary-button",
+                "Save and Run",
+                None,
+                ScriptGenerationAction::SaveAndRun,
+                footer_colors.accent,
+                footer_colors.text_muted,
+                cx,
+            )
+        } else {
+            self.render_footer_button(
+                "chat-footer-primary-button",
+                "Continue in Chat",
+                Some("⌘↵"),
+                footer_colors.accent,
+                footer_colors.text_muted,
+            )
+        };
+
         right_side = right_side
             .child(
                 div()
@@ -53,18 +133,12 @@
                     .child("Shift+Enter newline"),
             )
             .child(divider())
-            .child(self.render_footer_button(
-                "chat-footer-primary-button",
-                "Continue in Chat",
-                "⌘↵",
-                footer_colors.accent,
-                footer_colors.text_muted,
-            ))
+            .child(primary_button)
             .child(divider())
             .child(self.render_footer_button(
                 "chat-footer-secondary-button",
                 "Actions",
-                "⌘K",
+                Some("⌘K"),
                 footer_colors.accent,
                 footer_colors.text_muted,
             ));
@@ -87,33 +161,7 @@
             .border_t_1()
             .border_color(rgba((footer_colors.border << 8) | 0x50))
             .bg(footer_bg)
-            .child(
-                div()
-                    .flex()
-                    .flex_row()
-                    .items_center()
-                    .gap(px(8.0))
-                    .flex_1()
-                    .min_w(px(0.0))
-                    .overflow_hidden()
-                    .child(
-                        svg()
-                            .external_path(crate::utils::get_logo_path())
-                            .size(px(16.0))
-                            .ml(px(2.0))
-                            .text_color(rgb(footer_colors.accent)),
-                    )
-                    .child(
-                        div()
-                            .max_w(px(420.0))
-                            .overflow_hidden()
-                            .text_ellipsis()
-                            .whitespace_nowrap()
-                            .text_xs()
-                            .text_color(rgb(footer_colors.accent))
-                            .child(model_text),
-                    ),
-            )
+            .child(left_side)
             .child(right_side)
     }
 
@@ -128,49 +176,36 @@
             return None;
         }
 
-        let colors = &self.prompt_colors;
         let theme_colors = &self.theme.colors;
-        let button_bg = theme::hover_overlay_bg(&self.theme, 0x24);
-        let button_hover_bg = theme::hover_overlay_bg(&self.theme, 0x36);
+        let footer_colors = PromptFooterColors::from_theme(&self.theme);
 
         let mut action_container = div()
             .id("chat-script-generation-footer-actions")
             .flex()
             .flex_row()
             .items_center()
-            .gap(px(6.0))
+            .gap(px(2.0))
             .min_w(px(0.0));
 
         if show_actions {
-            let button = |id: &'static str,
-                          label: &'static str,
-                          action: ScriptGenerationAction|
-             -> AnyElement {
-                div()
-                    .id(format!("chat-script-generation-{}", id))
-                    .px(px(8.0))
-                    .py(px(2.0))
-                    .rounded(px(6.0))
-                    .bg(button_bg)
-                    .cursor_pointer()
-                    .hover(move |d| d.bg(button_hover_bg))
-                    .text_xs()
-                    .font_weight(gpui::FontWeight::MEDIUM)
-                    .text_color(rgb(colors.text_primary))
-                    .child(label)
-                    .on_click(cx.listener(move |this, _event, _window, cx| {
-                        this.handle_script_generation_action(action, cx);
-                    }))
-                    .into_any_element()
-            };
-
             action_container = action_container
-                .child(button("save", "Save", ScriptGenerationAction::Save))
-                .child(button("run", "Run", ScriptGenerationAction::Run))
-                .child(button(
-                    "save-and-run",
-                    "Save and Run",
-                    ScriptGenerationAction::SaveAndRun,
+                .child(self.render_script_generation_footer_button(
+                    "chat-script-generation-save",
+                    "Save",
+                    None,
+                    ScriptGenerationAction::Save,
+                    footer_colors.accent,
+                    footer_colors.text_muted,
+                    cx,
+                ))
+                .child(self.render_script_generation_footer_button(
+                    "chat-script-generation-run",
+                    "Run",
+                    None,
+                    ScriptGenerationAction::Run,
+                    footer_colors.accent,
+                    footer_colors.text_muted,
+                    cx,
                 ));
         }
 
@@ -560,10 +595,56 @@
             .child(input_area)
             // Scrollable message area
             .child(messages_content)
-            // Footer with model selector, Continue in Chat, and Actions
+            // Footer with model selector and footer actions
             .child(self.render_footer(cx))
             // Note: Actions menu is now handled by parent via on_show_actions callback
             // The parent opens the standard ActionsDialog window
             .into_any_element()
     }
 }
+
+#[cfg(test)]
+mod render_core_footer_tests {
+    use std::fs;
+
+    #[test]
+    fn test_script_generation_mode_replaces_continue_with_save_and_run_primary_button() {
+        let content = fs::read_to_string("src/prompts/chat/render_core.rs")
+            .expect("Failed to read src/prompts/chat/render_core.rs");
+        let normalized: String = content.chars().filter(|c| !c.is_whitespace()).collect();
+
+        assert!(
+            normalized.contains("letprimary_button=ifself.script_generation_mode{"),
+            "Footer primary action should branch on script_generation_mode"
+        );
+        assert!(
+            normalized.contains("\"chat-footer-primary-button\",\"SaveandRun\",None,ScriptGenerationAction::SaveAndRun,"),
+            "Script generation mode should render Save and Run as the primary footer action"
+        );
+        assert!(
+            normalized.contains(
+                "}else{self.render_footer_button(\"chat-footer-primary-button\",\"ContinueinChat\",Some(\"⌘↵\"),"
+            ),
+            "Non-script mode should keep Continue in Chat as the primary footer action"
+        );
+    }
+
+    #[test]
+    fn test_script_generation_secondary_footer_actions_render_save_and_run_only() {
+        let content = fs::read_to_string("src/prompts/chat/render_core.rs")
+            .expect("Failed to read src/prompts/chat/render_core.rs");
+
+        assert!(
+            content.contains("\"chat-script-generation-save\""),
+            "Script generation footer should render Save action"
+        );
+        assert!(
+            content.contains("\"chat-script-generation-run\""),
+            "Script generation footer should render Run action"
+        );
+        assert!(
+            !content.contains("\"chat-script-generation-save-and-run\""),
+            "Save and Run should only appear as the primary footer action slot"
+        );
+    }
+}


thinking
**Summarizing changes and testing**

Implemented footer button style and placement updates in script-generation mode in `src/prompts/chat/render_core.rs`. Added new helper and tests there. No changes made to `src/prompts/chat/prompt.rs`.  

Verification:  
- `cargo check -p script-kit-gpui` succeeded.  
- Attempted targeted tests for footer changes failed due to unrelated compilation errors in other parts of the codebase.  

How to test:  
- In normal mode, footer shows `Continue in Chat ⌘↵` and `Actions ⌘K`.  
- In script-generation mode, left side near model shows `Save` and `Run` buttons (text-only accent style).  
- Right side shows primary `Save and Run` replacing `Continue in Chat`.  
- Clicking buttons triggers expected script generation behavior and status updates.  

Risks / Known gaps:  
- No visual screenshot verification was performed.  
- Tests for the new footer are in place but could not run due to unrelated module duplication/type errors elsewhere.  
- No commits were made as part of this task.
codex
Implemented the footer style/placement change for script-generation mode.

Changed files
- `src/prompts/chat/render_core.rs:4`
  - `render_footer_button` now supports optional shortcut text (so footer buttons can be text-only label when needed).
  - Added `render_script_generation_footer_button` to keep script actions clickable while matching footer text style (accent text, no bg/hover pill).
  - Moved script-generation secondary actions (`Save`, `Run`) to the left side near the model name.
  - Right-side primary button now switches by mode:
    - normal: `Continue in Chat ⌘↵`
    - `script_generation_mode=true`: `Save and Run` (replaces Continue)
  - `Actions ⌘K` stays on the right.
  - Added focused tests at `src/prompts/chat/render_core.rs:606`.

- `src/prompts/chat/prompt.rs`
  - No edits made in this task.

Verification run
- `cargo check -p script-kit-gpui` passed.
- Attempted targeted test run: `cargo test -p script-kit-gpui render_core_footer_tests -- --nocapture`
  - Failed due unrelated concurrent-tree test compilation errors outside this task’s scope (duplicate test module files / unrelated action test compile errors).

How to test
1. Open chat in normal mode: footer should show `Continue in Chat ⌘↵` and `Actions ⌘K`.
2. Open chat with `script_generation_mode=true`:
   - Left side near model shows text-style `Save` and `Run`.
   - Right-side primary is `Save and Run` (Continue hidden).
3. Click `Save`, `Run`, and `Save and Run` to verify script-generation actions fire and status updates.

Risks / known gaps
- UI screenshot-based visual verification was not run.
- Scoped tests are currently blocked by unrelated in-progress test-tree errors from other files.
- No commits were made.
file update:
diff --git a/src/prompts/chat/render_core.rs b/src/prompts/chat/render_core.rs
index 59f504a9b2cf341109463f106d0bc4b8979101f9..4e91d2d0ed474e69c143cd50e58e0491df58450b
--- a/src/prompts/chat/render_core.rs
+++ b/src/prompts/chat/render_core.rs
@@ -5,7 +5,7 @@
         &self,
         id: &'static str,
         label: &'static str,
-        shortcut: &'static str,
+        shortcut: Option<&'static str>,
         accent_color: u32,
         muted_color: u32,
     ) -> AnyElement {
@@ -20,10 +20,42 @@
             .rounded(px(4.0))
             .cursor_default()
             .child(div().text_xs().text_color(rgb(accent_color)).child(label))
-            .child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            .when_some(shortcut, |d, shortcut| {
+                d.child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            })
             .into_any_element()
     }
 
+    fn render_script_generation_footer_button(
+        &self,
+        id: &'static str,
+        label: &'static str,
+        shortcut: Option<&'static str>,
+        action: ScriptGenerationAction,
+        accent_color: u32,
+        muted_color: u32,
+        cx: &mut Context<Self>,
+    ) -> AnyElement {
+        div()
+            .id(id)
+            .flex()
+            .flex_row()
+            .items_center()
+            .gap(px(6.0))
+            .px(px(8.0))
+            .py(px(2.0))
+            .rounded(px(4.0))
+            .cursor_pointer()
+            .child(div().text_xs().text_color(rgb(accent_color)).child(label))
+            .when_some(shortcut, |d, shortcut| {
+                d.child(div().text_xs().text_color(rgb(muted_color)).child(shortcut))
+            })
+            .on_click(cx.listener(move |this, _event, _window, cx| {
+                this.handle_script_generation_action(action, cx);
+            }))
+            .into_any_element()
+    }
+
     fn render_footer(&self, cx: &mut Context<Self>) -> impl IntoElement {
         let footer_colors = PromptFooterColors::from_theme(&self.theme);
         let footer_bg = rgba(crate::components::prompt_footer::footer_surface_rgba(
@@ -40,11 +72,59 @@
                 .into_any_element()
         };
 
-        let mut right_side = div().flex().flex_row().items_center().min_w(px(0.));
-        if let Some(script_actions) = self.render_script_generation_footer_actions(cx) {
-            right_side = right_side.child(script_actions).child(divider());
+        let mut left_side = div()
+            .flex()
+            .flex_row()
+            .items_center()
+            .gap(px(8.0))
+            .flex_1()
+            .min_w(px(0.0))
+            .overflow_hidden()
+            .child(
+                svg()
+                    .external_path(crate::utils::get_logo_path())
+                    .size(px(16.0))
+                    .ml(px(2.0))
+                    .text_color(rgb(footer_colors.accent)),
+            )
+            .child(
+                div()
+                    .max_w(px(420.0))
+                    .overflow_hidden()
+                    .text_ellipsis()
+                    .whitespace_nowrap()
+                    .text_xs()
+                    .text_color(rgb(footer_colors.accent))
+                    .child(model_text),
+            );
+
+        if self.script_generation_mode {
+            if let Some(script_actions) = self.render_script_generation_footer_actions(cx) {
+                left_side = left_side.child(divider()).child(script_actions);
+            }
         }
 
+        let mut right_side = div().flex().flex_row().items_center().min_w(px(0.));
+        let primary_button = if self.script_generation_mode {
+            self.render_script_generation_footer_button(
+                "chat-footer-primary-button",
+                "Save and Run",
+                None,
+                ScriptGenerationAction::SaveAndRun,
+                footer_colors.accent,
+                footer_colors.text_muted,
+                cx,
+            )
+        } else {
+            self.render_footer_button(
+                "chat-footer-primary-button",
+                "Continue in Chat",
+                Some("⌘↵"),
+                footer_colors.accent,
+                footer_colors.text_muted,
+            )
+        };
+
         right_side = right_side
             .child(
                 div()
@@ -53,18 +133,12 @@
                     .child("Shift+Enter newline"),
             )
             .child(divider())
-            .child(self.render_footer_button(
-                "chat-footer-primary-button",
-                "Continue in Chat",
-                "⌘↵",
-                footer_colors.accent,
-                footer_colors.text_muted,
-            ))
+            .child(primary_button)
             .child(divider())
             .child(self.render_footer_button(
                 "chat-footer-secondary-button",
                 "Actions",
-                "⌘K",
+                Some("⌘K"),
                 footer_colors.accent,
                 footer_colors.text_muted,
             ));
@@ -87,33 +161,7 @@
             .border_t_1()
             .border_color(rgba((footer_colors.border << 8) | 0x50))
             .bg(footer_bg)
-            .child(
-                div()
-                    .flex()
-                    .flex_row()
-                    .items_center()
-                    .gap(px(8.0))
-                    .flex_1()
-                    .min_w(px(0.0))
-                    .overflow_hidden()
-                    .child(
-                        svg()
-                            .external_path(crate::utils::get_logo_path())
-                            .size(px(16.0))
-                            .ml(px(2.0))
-                            .text_color(rgb(footer_colors.accent)),
-                    )
-                    .child(
-                        div()
-                            .max_w(px(420.0))
-                            .overflow_hidden()
-                            .text_ellipsis()
-                            .whitespace_nowrap()
-                            .text_xs()
-                            .text_color(rgb(footer_colors.accent))
-                            .child(model_text),
-                    ),
-            )
+            .child(left_side)
             .child(right_side)
     }
 
@@ -128,49 +176,36 @@
             return None;
         }
 
-        let colors = &self.prompt_colors;
         let theme_colors = &self.theme.colors;
-        let button_bg = theme::hover_overlay_bg(&self.theme, 0x24);
-        let button_hover_bg = theme::hover_overlay_bg(&self.theme, 0x36);
+        let footer_colors = PromptFooterColors::from_theme(&self.theme);
 
         let mut action_container = div()
             .id("chat-script-generation-footer-actions")
             .flex()
             .flex_row()
             .items_center()
-            .gap(px(6.0))
+            .gap(px(2.0))
             .min_w(px(0.0));
 
         if show_actions {
-            let button = |id: &'static str,
-                          label: &'static str,
-                          action: ScriptGenerationAction|
-             -> AnyElement {
-                div()
-                    .id(format!("chat-script-generation-{}", id))
-                    .px(px(8.0))
-                    .py(px(2.0))
-                    .rounded(px(6.0))
-                    .bg(button_bg)
-                    .cursor_pointer()
-                    .hover(move |d| d.bg(button_hover_bg))
-                    .text_xs()
-                    .font_weight(gpui::FontWeight::MEDIUM)
-                    .text_color(rgb(colors.text_primary))
-                    .child(label)
-                    .on_click(cx.listener(move |this, _event, _window, cx| {
-                        this.handle_script_generation_action(action, cx);
-                    }))
-                    .into_any_element()
-            };
-
             action_container = action_container
-                .child(button("save", "Save", ScriptGenerationAction::Save))
-                .child(button("run", "Run", ScriptGenerationAction::Run))
-                .child(button(
-                    "save-and-run",
-                    "Save and Run",
-                    ScriptGenerationAction::SaveAndRun,
+                .child(self.render_script_generation_footer_button(
+                    "chat-script-generation-save",
+                    "Save",
+                    None,
+                    ScriptGenerationAction::Save,
+                    footer_colors.accent,
+                    footer_colors.text_muted,
+                    cx,
+                ))
+                .child(self.render_script_generation_footer_button(
+                    "chat-script-generation-run",
+                    "Run",
+                    None,
+                    ScriptGenerationAction::Run,
+                    footer_colors.accent,
+                    footer_colors.text_muted,
+                    cx,
                 ));
         }
 
@@ -560,10 +595,56 @@
             .child(input_area)
             // Scrollable message area
             .child(messages_content)
-            // Footer with model selector, Continue in Chat, and Actions
+            // Footer with model selector and footer actions
             .child(self.render_footer(cx))
             // Note: Actions menu is now handled by parent via on_show_actions callback
             // The parent opens the standard ActionsDialog window
             .into_any_element()
     }
 }
+
+#[cfg(test)]
+mod render_core_footer_tests {
+    use std::fs;
+
+    #[test]
+    fn test_script_generation_mode_replaces_continue_with_save_and_run_primary_button() {
+        let content = fs::read_to_string("src/prompts/chat/render_core.rs")
+            .expect("Failed to read src/prompts/chat/render_core.rs");
+        let normalized: String = content.chars().filter(|c| !c.is_whitespace()).collect();
+
+        assert!(
+            normalized.contains("letprimary_button=ifself.script_generation_mode{"),
+            "Footer primary action should branch on script_generation_mode"
+        );
+        assert!(
+            normalized.contains("\"chat-footer-primary-button\",\"SaveandRun\",None,ScriptGenerationAction::SaveAndRun,"),
+            "Script generation mode should render Save and Run as the primary footer action"
+        );
+        assert!(
+            normalized.contains(
+                "}else{self.render_footer_button(\"chat-footer-primary-button\",\"ContinueinChat\",Some(\"⌘↵\"),"
+            ),
+            "Non-script mode should keep Continue in Chat as the primary footer action"
+        );
+    }
+
+    #[test]
+    fn test_script_generation_secondary_footer_actions_render_save_and_run_only() {
+        let content = fs::read_to_string("src/prompts/chat/render_core.rs")
+            .expect("Failed to read src/prompts/chat/render_core.rs");
+
+        assert!(
+            content.contains("\"chat-script-generation-save\""),
+            "Script generation footer should render Save action"
+        );
+        assert!(
+            content.contains("\"chat-script-generation-run\""),
+            "Script generation footer should render Run action"
+        );
+        assert!(
+            !content.contains("\"chat-script-generation-save-and-run\""),
+            "Save and Run should only appear as the primary footer action slot"
+        );
+    }
+}

tokens used
126,603
Implemented the footer style/placement change for script-generation mode.

Changed files
- `src/prompts/chat/render_core.rs:4`
  - `render_footer_button` now supports optional shortcut text (so footer buttons can be text-only label when needed).
  - Added `render_script_generation_footer_button` to keep script actions clickable while matching footer text style (accent text, no bg/hover pill).
  - Moved script-generation secondary actions (`Save`, `Run`) to the left side near the model name.
  - Right-side primary button now switches by mode:
    - normal: `Continue in Chat ⌘↵`
    - `script_generation_mode=true`: `Save and Run` (replaces Continue)
  - `Actions ⌘K` stays on the right.
  - Added focused tests at `src/prompts/chat/render_core.rs:606`.

- `src/prompts/chat/prompt.rs`
  - No edits made in this task.

Verification run
- `cargo check -p script-kit-gpui` passed.
- Attempted targeted test run: `cargo test -p script-kit-gpui render_core_footer_tests -- --nocapture`
  - Failed due unrelated concurrent-tree test compilation errors outside this task’s scope (duplicate test module files / unrelated action test compile errors).

How to test
1. Open chat in normal mode: footer should show `Continue in Chat ⌘↵` and `Actions ⌘K`.
2. Open chat with `script_generation_mode=true`:
   - Left side near model shows text-style `Save` and `Run`.
   - Right-side primary is `Save and Run` (Continue hidden).
3. Click `Save`, `Run`, and `Save and Run` to verify script-generation actions fire and status updates.

Risks / known gaps
- UI screenshot-based visual verification was not run.
- Scoped tests are currently blocked by unrelated in-progress test-tree errors from other files.
- No commits were made.


==== exit @ 2026-02-08T07:20:49.160Z code=0 status=done ====
