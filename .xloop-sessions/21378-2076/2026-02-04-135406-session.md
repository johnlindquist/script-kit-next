# Session: ESC clears filter before navigating back in built-in views

## Files changed
- `src/app_impl.rs` — Added `clear_builtin_view_filter()` shared helper
- `src/render_builtins.rs` — Replaced 6 duplicated ESC handlers with calls to shared helper

## What was improved

### Consistent ESC behavior across all built-in views
Previously, pressing ESC in any built-in view (ClipboardHistory, AppLauncher,
WindowSwitcher, ThemeChooser, DesignGallery, FileSearch) would immediately
navigate back to the main menu, even if the user had typed a filter/search
query. This was inconsistent with the main menu (ScriptList) where ESC first
clears the filter text, then closes the window on the next ESC.

Now all views follow the same two-step ESC pattern:
1. ESC with filter text → clears filter, resets selection to 0, scrolls to top
2. ESC without filter text → navigates back (or closes window)

### ThemeChooser special handling preserved
ThemeChooser retains its theme-restore-on-cancel behavior: when the filter
is empty and ESC is pressed, the original theme is restored before navigating
back. When the filter has text, ESC only clears the filter (keeps the
theme preview active).

### Shared helper eliminates duplication
Extracted `clear_builtin_view_filter()` in app_impl.rs that handles all 6
view types. Each view's scroll handle, filter field, and view-specific
cleanup (FileSearch debounce cancel, cached results clear) is centralized.

## What to avoid repeating
- When adding new built-in views with filter support, add a branch to
  `clear_builtin_view_filter()` instead of inlining ESC-filter-clear logic
  in the view's key handler.
- AppLauncher and DesignGallery use custom text rendering (not the shared
  `gpui_input_state`), but `clear_builtin_view_filter()` still resets
  `self.filter_text` and `self.pending_filter_sync` for all views uniformly.
