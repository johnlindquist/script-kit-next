# Session: Random Action/Dialog/Window Behavior Tests

## Files Changed
- `src/actions/dialog_random_action_window_tests.rs` (new, 1535 lines)
- `src/actions/mod.rs` (added test module registration)

## What Was Done
Added 85 new tests validating random behaviors across built-in actions, window dialogs, and cross-context scenarios:

- **Shortcut uniqueness** across 4 contexts (script, file, clipboard, AI)
- **Icon/section presence** for Notes and AI command bar actions
- **Script type permutations** — all 8 combos of shortcut/alias/frecency flags
- **Agent flag edge cases** with frecency and action title customization
- **Clipboard action permutations** — text/image x pinned/unpinned x app-name (8 combos)
- **Chat context flag combos** — model selection, checkmark uniqueness, message/response gating
- **Notes trash/selection gating** — actions disabled in trash view or with no selection
- **Auto-sizing toggle** all 8 permutations
- **File context** all FileType variants have primary action with enter shortcut
- **Path context** directory vs file primary action, trash description differences
- **New chat** section ordering (Last Used -> Presets -> Models)
- **Note switcher** icons (pin/current/regular), current bullet, large char counts
- **Action scoring** — prefix, exact, partial, case sensitivity (expects pre-lowercased query)
- **Fuzzy match** — unicode, interleaved chars, single char, full string
- **Keycap parsing** — modifiers, arrows, enter, multi-char keys (F12 splits per-char)
- **Shortcut formatting** — delete key, single letter, triple modifier
- **Deeplink name** — Japanese, mixed scripts, very long, single hyphen
- **CommandBarConfig** — all 5 presets, section style, close behaviors
- **Grouped items** — alternating sections, filtered subsets
- **Selection coercion** — single item, empty, all-headers
- **Window position** — all variants distinct
- **ProtocolAction** — all fields populated vs minimal
- **Invariants** — non-empty IDs/titles, title_lower consistency, category uniformity, ID uniqueness across 6 contexts

## What to Avoid
- `score_action` expects pre-lowercased search strings — don't test with uppercase input expecting a match
- `parse_shortcut_keycaps` splits non-modifier characters individually (F12 -> F,1,2, not F12)
- `confirm::constants` module is private — can't import from test files outside the confirm module
- Clippy catches `assertions_on_constants` — avoid asserting on compile-time constant values; use runtime-derived values instead
- Clippy catches `clone_on_copy` — use value copy for Copy types like `ContentType` and `FileType`
