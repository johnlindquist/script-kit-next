Got the full Oracle response. Here's the summary:

## Oracle Analysis: 3 Swarm Tasks for `prompt_handler/mod.rs`

### Task 1: `submit-callback-helper`
**Scope:** `src/prompt_handler/mod.rs`

Extract a `fn make_submit_callback(&self, dropped_label: &'static str) -> Arc<dyn Fn(String, Option<String>) + Send + Sync>` method on `ScriptListApp`. Replace the 7 identical copy-pasted closures (ShowDiv, ShowTerm, ShowEditor, ShowEnv, ShowDrop, ShowTemplate, ShowSelect) with one-line calls. PathPrompt keeps its extra logging line by wrapping the helper. Chat and Confirm are explicitly excluded (different message types/callback signatures).

### Task 2: `window-prep-dedup`
**Scope:** `src/prompt_handler/mod.rs`

Extract `fn prepare_window_for_prompt(&self, log_target, prompt_kind, bench_marker)` to centralize the `NEEDS_RESET.swap(false, ...)` + window visibility check block duplicated across ShowArg, ShowDiv, and ShowChat (3 sites).

### Task 3: `sdk-actions-shortcuts-helper`
**Scope:** `src/prompt_handler/mod.rs`

Extract `fn set_sdk_actions_and_shortcuts(&mut self, actions, log_target, log_shortcuts)` to deduplicate the SDK actions + shortcut registry rebuild logic between ShowArg and SetActions handlers.

**NEXT_AREA:** Standardize all `try_send` error handling (state/layout/ai/chat/confirm) behind a single `send_response_or_log()` helper so drop/disconnect behavior can't silently drift across handlers.

Want me to implement these, or dispatch them to a codex-swarm?
