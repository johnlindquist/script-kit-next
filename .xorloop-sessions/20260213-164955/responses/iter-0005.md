Got the full Oracle response. Here's the analysis:

---

Oracle (GPT-5.2 Pro) identified 3 tasks for deduplicating the actions toggle ceremony in `src/app_impl/actions_toggle.rs`:

### Task 1: `on-close-callback-factory`

**Scope:** `src/app_impl/actions_toggle.rs`

Extract the identical ~20-line `set_on_close` callback from `toggle_actions`, `toggle_webcam_actions`, and `toggle_chat_actions` into a single factory method `make_actions_window_on_close_callback(app_entity, log_message) -> Arc<dyn Fn>`. Each call site passes its unique log string. Tests in `on_close_reentrancy_tests` must be updated to match the new call-site pattern (`d.set_on_close(Self::make_actions_window_on_close_callback(` counted 3 times), and the `cx.defer` count drops to `>= 1`.

### Task 2: `spawn-open-actions-window-helper`

**Scope:** `src/app_impl/actions_toggle.rs`

Extract the identical ~15-line `cx.spawn(async move { cx.update(|cx| { match open_actions_window(...) }) }).detach()` block into `spawn_open_actions_window(cx, main_bounds, display_id, dialog, position, opened_log, failed_prefix)`. Each toggle passes its unique log strings. Existing bounds logging stays inline in the callers.

### Task 3: `actions-popup-open-preamble-helper`

**Scope:** `src/app_impl/actions_toggle.rs`

Extract the 4-line preamble (`show_actions_popup = true`, `push_focus_overlay`, `focus_handle.focus`, `gpui_input_focused = false`) into `begin_actions_popup_window_open(&mut self, cx, window)`. Used only by the 3 popup-window toggles — NOT by `toggle_arg_actions` or `toggle_terminal_commands` which have different focus patterns. The `resync_filter_input_after_actions_if_needed` call stays inline to avoid test churn.

**NEXT_AREA:** ActionsWindow auto-close behavior (`focus_lost` path) vs. `on_close` callback ordering — whether `platform::activate_main_window()` can race focus restoration when the popup dismisses itself.

---

Want me to dispatch these to a codex-swarm, or implement them sequentially?
