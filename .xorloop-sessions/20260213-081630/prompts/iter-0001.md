## Target Code

FEATURE: The "run-in-terminal" fallback passes user input through AppleScript string interpolation with incorrect escaping order, enabling AppleScript injection via crafted input
FILES: src/main_sections/fallbacks.rs, src/fallbacks/builtins.rs
SMELL: Line 49 escapes `"` before `\`, so an injected backslash-quote (`\"`) becomes `\\"` (escaped backslash + live quote), breaking out of the AppleScript `do script` string to execute arbitrary AppleScript commands

## Task: security fix: find injection risks, authz gaps, secret leaks, unsafe deserialization, path traversal — write the patched code

## Output Format — WRITE THE CODE, NOT A REPORT

For each issue you find, output this EXACT structure:

### N) Severity: **critical|major|minor**

**File path + function/line range:** `path/to/file.ext::function_name` (LNNN–LNNN)
**Problem description:** 2-3 sentences explaining what is wrong and why it matters.
**Concrete fix:** Show the COMPLETE replacement code in a fenced code block.

```language
// the actual fixed code — not pseudocode, not a description, REAL CODE
// include enough surrounding context that someone can find where to paste it
```

## Rules

- You MUST write actual, copy-pasteable code fixes — not descriptions of what to do
- Every finding MUST include a code block with the corrected implementation
- Do NOT suggest adding documentation, comments, or docstrings — only functional code changes
- Do NOT suggest adding logging unless it fixes an actual bug
- Prioritize by impact: bugs > security > performance > cleanup
- Maximum 15 findings — quality over quantity
- End with: NEXT_AREA: <suggest one unexplored area for future analysis>
