Got the full Oracle response. Here's the complete swarm task list:

---

## SWARM TASK LIST

### Task 1: `ui-key-helpers`

**Scope:** `src/ui_foundation/mod.rs, src/confirm/window.rs`

**Task:**
In `src/ui_foundation/mod.rs`, extend the canonical key helper set by adding two new allocation-free helpers: `is_key_tab(key: &str) -> bool` and `is_key_space(key: &str) -> bool`. Place them after `is_key_backspace` and before `is_key_k`, with matching `#[inline]` and doc comments. `is_key_tab` should check `key == "	" || key.eq_ignore_ascii_case("tab")`. `is_key_space` should check `key == " " || key.eq_ignore_ascii_case("space")`.

Then update `src/confirm/window.rs` `confirm_key_action()` (around line 44) to replace inline `key.eq_ignore_ascii_case("space") || key == " "` with `is_key_space(key)`, and `key.eq_ignore_ascii_case("tab")` with `is_key_tab(key)`. Import the new helpers.

Run `cargo check && cargo clippy --all-targets -- -D warnings && cargo test` to verify.

---

### Task 2: `prompts-path-template-drop-keys`

**Scope:** `src/prompts/path/render.rs, src/prompts/template/render.rs, src/prompts/drop.rs`

**Task:**
Convert non-helper key matching in Path, Template, and Drop prompts to canonical `is_key_*` helpers. In `src/prompts/path/render.rs` (lines 198-223), replace the `match key { "up" | "Up" | "ArrowUp" | "arrowup" => ... }` block with an `if/else if` chain using `is_key_up(key)`, `is_key_down(key)`, `is_key_left(key)`, `is_key_right(key)`, `is_key_tab(key)`, `is_key_enter(key)`, `is_key_backspace(key)`, and `printable_char(event.keystroke.key_char.as_deref())` for the fallback. In `src/prompts/template/render.rs` (lines 219-238), same pattern for `"tab" | "Tab"`, `"enter" | "Enter"`, `"backspace" | "Backspace"` arms. In `src/prompts/drop.rs` (lines 221-227), replace `key_str.eq_ignore_ascii_case("enter") || key_str.eq_ignore_ascii_case("return")` with `is_key_enter(key)`.

Add appropriate imports from `crate::ui_foundation` at the top of each file. Run `cargo check && cargo clippy --all-targets -- -D warnings && cargo test`.

---

### Task 3: `prompts-select-keys`

**Scope:** `src/prompts/select/render.rs`

**Task:**
In `src/prompts/select/render.rs`, replace the Pattern C key handler (lines 364-402) that builds local `is_up/is_down/is_space/is_enter/is_backspace` booleans via `eq_ignore_ascii_case()` with canonical helpers. Replace `let is_up = key_str.eq_ignore_ascii_case("up") || key_str.eq_ignore_ascii_case("arrowup")` with `is_key_up(key)`, etc. Use `is_key_space(key)` instead of `key_str.eq_ignore_ascii_case("space") || key_str == " "`. Use `printable_char(event.keystroke.key_char.as_deref())` for char extraction. Preserve behavior: `platform+a` toggles select-all, `platform+space` toggles selection, plain space feeds into filter.

Add imports: `use crate::ui_foundation::{is_key_backspace, is_key_down, is_key_enter, is_key_space, is_key_up, printable_char};`. Run `cargo check && cargo clippy --all-targets -- -D warnings && cargo test`.

---

### Task 4: `chat-key-actions`

**Scope:** `src/prompts/chat/types.rs`

**Task:**
In `src/prompts/chat/types.rs`, refactor both `resolve_setup_card_key()` (lines 75-123) and `resolve_chat_input_key_action()` (lines 183-203) to use canonical `is_key_*` helpers. For `resolve_setup_card_key`, replace `key.eq_ignore_ascii_case("tab")` with `is_key_tab(key)`, `eq_ignore_ascii_case("up"/"arrowup")` with `is_key_up(key)`, `eq_ignore_ascii_case("down"/"arrowdown")` with `is_key_down(key)`, `eq_ignore_ascii_case("enter"/"return") || key == " "` with `is_key_enter(key) || is_key_space(key)`, `eq_ignore_ascii_case("escape")` with `is_key_escape(key)`.

For `resolve_chat_input_key_action`, remove `let key_lower = key.to_ascii_lowercase(); match key_lower.as_str() { ... }` and replace with an allocation-free if/else chain: `is_key_escape` first, then `cmd_pressed` block (checking `.`, `is_key_k`, `is_key_enter`, `eq_ignore_ascii_case("c")`, `is_key_backspace`, `eq_ignore_ascii_case("v")`, then `Ignore`), then `is_key_enter` with shift/submit split, then `DelegateToInput` fallback. Preserve exact precedence: Escape wins, Cmd+Enter beats Shift+Enter. Add imports from `crate::ui_foundation`. Run `cargo check && cargo clippy --all-targets -- -D warnings && cargo test`.

---

NEXT_AREA: `src/prompts/chat/render_core.rs` where `to_ascii_lowercase()` is computed per keystroke; consider deferring the allocation until the `DelegateToInput` path.
