

Looking at the analysis, I'll extract the concrete implementation tasks:

---

- `harden-agent-build-terminal-cmd` scope:`src/agents/executor.rs` — Add path validation and remove unwrap in `build_terminal_command()`
- `clipboard-restore-race-fix` scope:`src/selected_text.rs` — Fix TOCTOU race in clipboard save/restore with guaranteed cleanup
- `pty-env-inheritance-scrub` scope:`src/terminal/pty/lifecycle.rs` — Call env_clear() before setting PTY env vars to stop leaking parent env
- `runner-env-scrub-script-spawn` scope:`src/executor/runner.rs` — Add env_clear() + allowlist to spawn_script() and run_command()

NEXT_AREA: `src/executor/runner.rs` run_command() at line 865 — the task description was cut off mid-sentence; the full env allowlist for script spawns (especially which `SCRIPT_KIT_*` vars to forward and whether `KIT` and `KNODE` paths are needed) needs investigation.
