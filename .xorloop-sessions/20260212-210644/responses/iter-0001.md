Here's the full GPT-5.2 Pro performance analysis of the Quicklinks feature:

---

## Performance Analysis — Quicklinks Feature (10 items)

### Critical

1. **Blocking I/O on UI thread** — `src/app_execute/builtin_execution.rs` `execute_builtin_with_query` (Quicklinks arm)
   - The entire flow — `load_quicklinks()` disk read + JSON parse, then `osascript` process spawns via `Command::output()` — runs synchronously. If on the UI thread, the app freezes.
   - **Fix:** Move the load→prompt→open flow off the UI thread using `cx.spawn()` + background executor.

### Major

2. **Double `osascript` spawn** — `choose_from_list` + `prompt_for_text`
   - Links with `{query}` invoke osascript twice (list picker + query dialog).
   - **Fix:** Combine into a single AppleScript that returns both selection and query in one run.

3. **Double-escaping strings** — `quicklink_picker_label` + `applescript_list_literal` + `applescript_escape`
   - Labels are escaped in `quicklink_picker_label()`, then escaped again inside `applescript_list_literal()`. Redundant allocations and potential correctness bugs.
   - **Fix:** Escape exactly once — keep escaping centralized in `applescript_list_literal()`.

4. **Chained `.replace()` in `applescript_escape`** — `src/app_execute/builtin_execution.rs`
   - Each `.replace()` allocates a new String and copies. Five chained calls = five full passes.
   - **Fix:** Single-pass escape with `String::with_capacity()` + iterate + `push_str()`.

5. **Full-buffer JSON I/O** — `src/quicklinks/mod.rs` `save_quicklinks_to_path` / `load_quicklinks_from_path`
   - `to_string_pretty` → `fs::write` and `read_to_string` → `from_str` each create large intermediate Strings.
   - **Fix:** Use `BufReader`/`BufWriter` + `serde_json::from_reader`/`to_writer_pretty`.

6. **Unnecessary writes** — `src/quicklinks/mod.rs` `delete_quicklink_from_path` / `update_quicklink_from_path`
   - Always writes back even if nothing changed (delete of non-existent ID, update with identical values).
   - **Fix:** Add no-op fast paths: compare before/after and skip write when unchanged.

### Minor

7. **Unnecessary `expand_url` allocation** — `execute_builtin_with_query` (Quicklinks arm)
   - Non-placeholder links still call `expand_url()` which allocates via `.replace()`.
   - **Fix:** Short-circuit: if no `{query}` in template, use the borrowed `&str` directly.

8. **Linear label scan** — `quicklink_labels.iter().position(...)` after selection
   - O(n) scan + ambiguity risk if labels collide.
   - **Fix:** Return index/id from AppleScript, not just label text.

9. **Repeated `quicklinks_path()` construction** — `src/quicklinks/mod.rs`
   - Calls `dirs::home_dir()` and builds `PathBuf` every invocation.
   - **Fix:** Cache with `OnceLock<PathBuf>`.

10. **`get_builtin_entries()` repeated allocations** — `src/builtins/mod.rs`
    - Builds a fresh `Vec<BuiltInEntry>` with many String allocations every call. If called per-keystroke, it's a steady allocation hotspot.
    - **Fix:** Cache at startup, rebuild only on config change.

---

**NEXT_AREA:** Profile the *picker/search pipeline* to determine how often `get_builtin_entries()` runs per keystroke/render, then apply caching/memoization at the right layer.
