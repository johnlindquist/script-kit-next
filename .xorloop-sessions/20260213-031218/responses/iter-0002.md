Here's the full GPT-5.2 Pro analysis of **documentation gaps** in the emoji picker:

---

## Documentation Gaps — Prioritized Checklist

### Critical

1. **`src/emoji/mod.rs` ~L1231-L1272 — Row mapping contract for `filtered_ordered_emojis` + `compute_scroll_row` is undocumented**
   - The navigation/scroll logic relies on subtle invariants (category contiguity, `ALL_CATEGORIES` order) that aren't stated anywhere. `compute_scroll_row` docs don't explain what it *assumes* about `ordered`.
   - **Fix:** Expand rustdoc to document invariants (grouped by category in display order), the flat-index model (headers excluded), the row model (1 header + ceil(count/GRID_COLS) per category), and add an example mapping.

2. **`src/render_builtins/emoji_picker.rs` ~L56-L95 — Grid row construction algorithm undocumented and coupled to `compute_scroll_row`**
   - The `EmojiGridRow` enum + `rows` builder is the layout engine but has zero explanation of the representation or why it must stay in sync with the scroll-row computation.
   - **Fix:** Add a comment block above `EmojiGridRow` explaining `Header` vs `Cells` rows, what `start_index` means (flat index into `ordered_emojis`), and explicitly link to `compute_scroll_row` as a coupling point.

### Major

3. **`src/emoji/mod.rs` L1-L35 — No module-level docs, no docs on `Emoji`, `EmojiCategory`, `display_name`**
   - **Fix:** Add `//!` module doc + `///` on the public struct/enum explaining fields, static lifetime, and category display order.

4. **`src/emoji/mod.rs` ~L51-L1210 — `ALL_CATEGORIES` and `EMOJIS` are public but undocumented**
   - **Fix:** Either add rustdoc (canonical display order, dataset curation) or restrict to `pub(crate)`.

5. **`src/emoji/mod.rs` ~L1212-L1290 — Public helpers `emojis_by_category`, `grouped_emojis`, `search_emojis` undocumented**
   - **Fix:** Add `///` docs covering ordering guarantees, search semantics (case-insensitive substring on name+keywords, unranked), and examples.

6. **`src/render_builtins/emoji_picker.rs` L1-L479 — No module docs, `render_emoji_picker` is a large function with no section comments**
   - **Fix:** Add `//!` header + navigational section comments ("Build row model", "Clamp selection and compute scroll row", "Keyboard routing", "Render virtualized grid rows").

7. **`src/main_sections/app_view_state.rs` ~L128-L133 — `EmojiPickerView` fields undocumented, especially `selected_category`**
   - **Fix:** Add field-level docs. If `selected_category` has no UI to set it today, say so explicitly.

8. **No standalone architecture doc for the emoji subsystem**
   - **Fix:** Add `docs/emoji_picker.md` covering data model, search, display ordering, flat-index vs header-rows, scroll calculation, and how to add emojis.

### Minor

9. **`src/emoji/mod.rs` ~L1227-L1229 — Stale `GRID_COLS` comment says "arrow-key navigation interceptor"**
   - **Fix:** Update to "shared between the renderer and keyboard navigation logic."

10. **`src/render_builtins/emoji_picker.rs` ~L482-L595 — Source-code-reading tests are unexplained**
    - **Fix:** Add a comment explaining why text assertions are used (render needs GPUI context; these are structural regression checks).

11. **`src/emoji/mod.rs` ~L1292-L1393 — Magic number tests ("296 entries") lack intent documentation**
    - **Fix:** Comment whether the exact count is intentional or should be a lower bound when expanding the dataset.

**No `unsafe` blocks found** in the emoji picker code, so no missing safety docs.

---

**NEXT_AREA:** Actions dialog + focus restoration behavior — how `ActionsDialogHost::EmojiPicker`, `focus_handle`, and the picker's key routing interact. This is the next likely spot for undocumented "works-but-no-one-knows-why" complexity.
