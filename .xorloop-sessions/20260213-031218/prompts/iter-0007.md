<previous-analyses>
- **Critical gaps**: Architecture docs in `keyword_manager` describe outdated stop/restart behavior; keystroke logger captures passwords with no privacy warning; keyword expansion silently falls back on unknown tool types without documentation.

- **Major gaps**: Timing constants reference nonexistent logic, keystroke filtering/variable substitution/matching semantics are undocumented, `scriptlet_path` field is misleading (accepts synthetic IDs), and no authoring guide exists for keyword triggers.

- **Minor gaps**: Stale inline comments in scriptlet parsing don't match actual checks, and non-macOS stub functions lack rustdoc explaining their no-op behavior.

NEXT_SEED: `src/keyboard_monitor/*` — KeyEvent semantics, modifier handling, accessibility permissions, and synthetic vs real keystroke discrimination
---
- **Full AX crawl on every cache miss**: Each window operation triggers a complete enumeration of all apps and windows on miss, with cache-clearing causing thrash — the single biggest bottleneck at O(apps × windows) per operation.
- **Redundant per-call allocations**: CFString attribute names are re-created for every AX call, window titles allocate fresh buffers in hot loops, and the cache locks/unlocks per insertion instead of batching — all adding unnecessary overhead.
- **Synchronous AX on the UI thread**: All accessibility calls are cross-process and blocking; if invoked from GPUI action handlers they stall rendering, and display bounds are also re-queried on every operation instead of being cached.

NEXT_SEED: AXUIElement lifetime safety — stale window IDs, CF retain/release ownership across cache refreshes, and cache invalidation correctness
---
- **Unbounded search input (MAJOR):** Pasting multi-MB text into the emoji filter triggers expensive string clones on the UI thread, causing a DoS. Fix by clamping input to 512 bytes (UTF-8-safe) before processing.
- **Minor defensive gaps (3 findings):** No bidi/control char validation on clipboard output, emoji picker unconditionally registered (can't be disabled via config), and a fragile slice index that could panic if invariants break.
- **Clean baseline:** No `unsafe` blocks, no deserialization or file handling, and no secret leaks found in the emoji picker path — the codebase is structurally sound here.

NEXT_SEED: Clipboard integration layer (`cx.write_to_clipboard` / macOS `NSPasteboard` types) — verify plain UTF-8 only, no extra pasteboard flavors enabling injection or data leakage.
---
</previous-analyses>

Do NOT repeat items already covered above. Find something new.
## Feature Under Review

FEATURE: The emoji picker is a built-in command that renders a searchable, category-grouped 8-column grid of emojis with arrow-key navigation, mouse hover selection, and Enter-to-copy-to-clipboard functionality.
FILES: src/render_builtins/emoji_picker.rs, src/emoji/mod.rs, src/main_sections/app_view_state.rs, src/app_execute/builtin_execution.rs

## Analysis Category

documentation gaps: find undocumented public APIs, missing README sections, stale comments

## Instructions

1. Analyze the feature described above through the lens of: documentation gaps
2. Be specific: reference actual file paths, function names, line ranges
3. Output a prioritized checklist of actionable improvements
4. For each item: severity (critical/major/minor), file path, concrete fix description
5. End with: NEXT_AREA: <suggest one unexplored area for future analysis>
