<previous-analyses>
- **Unbounded timer spawning:** Every arrow key press spawns a new detached 1s timer task with no dedup guard, creating a "thundering herd" of tasks during rapid input — fix with a single debounced fade task pattern.

- **Redundant work per keystroke:** Double `cx.notify()` calls per navigation event cause extra render invalidations, and repeated linear scans over `grouped_items` (`.position()` + `.rposition()`) compound to O(n²) during sustained key holds.

- **Missing fast-path guards:** Cursor-hide platform calls fire unconditionally every keystroke even when already in keyboard mode, and `validate_selection_bounds()` does multiple full passes plus eager cache clearing regardless of whether selection actually changed.

NEXT_SEED: `get_grouped_results_cached()` and `GroupedListItem` vector construction/invalidation pipeline
---
- **Critical gaps**: Architecture docs in `keyword_manager` describe outdated stop/restart behavior; keystroke logger captures passwords with no privacy warning; keyword expansion silently falls back on unknown tool types without documentation.

- **Major gaps**: Timing constants reference nonexistent logic, keystroke filtering/variable substitution/matching semantics are undocumented, `scriptlet_path` field is misleading (accepts synthetic IDs), and no authoring guide exists for keyword triggers.

- **Minor gaps**: Stale inline comments in scriptlet parsing don't match actual checks, and non-macOS stub functions lack rustdoc explaining their no-op behavior.

NEXT_SEED: `src/keyboard_monitor/*` — KeyEvent semantics, modifier handling, accessibility permissions, and synthetic vs real keystroke discrimination
---
- **Full AX crawl on every cache miss**: Each window operation triggers a complete enumeration of all apps and windows on miss, with cache-clearing causing thrash — the single biggest bottleneck at O(apps × windows) per operation.
- **Redundant per-call allocations**: CFString attribute names are re-created for every AX call, window titles allocate fresh buffers in hot loops, and the cache locks/unlocks per insertion instead of batching — all adding unnecessary overhead.
- **Synchronous AX on the UI thread**: All accessibility calls are cross-process and blocking; if invoked from GPUI action handlers they stall rendering, and display bounds are also re-queried on every operation instead of being cached.

NEXT_SEED: AXUIElement lifetime safety — stale window IDs, CF retain/release ownership across cache refreshes, and cache invalidation correctness
---
</previous-analyses>

Do NOT repeat items already covered above. Find something new.
## Feature Under Review

FEATURE: Emoji picker built-in with categorized grid navigation, keyword search filtering, horizontal/vertical arrow-key movement, category tabs, and clipboard insertion of selected emoji.
FILES: src/emoji/mod.rs, src/render_builtins/emoji_picker.rs, src/builtins/mod.rs, src/app_execute/builtin_execution.rs, src/app_impl/filter_input_change.rs

## Analysis Category

security audit: scan for injection risks, authz gaps, secret leaks, unsafe deserialization, path traversal

## Instructions

1. Analyze the feature described above through the lens of: security audit
2. Be specific: reference actual file paths, function names, line ranges
3. Output a prioritized checklist of actionable improvements
4. For each item: severity (critical/major/minor), file path, concrete fix description
5. End with: NEXT_AREA: <suggest one unexplored area for future analysis>
