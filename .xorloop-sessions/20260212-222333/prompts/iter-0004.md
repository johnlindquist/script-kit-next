<previous-analyses>
- **Low-risk FFI surface**: All cursor `msg_send!` calls use compile-time selectors with no external input; worst case is a wrong cursor icon that self-corrects on next mouse move.
- **Minor defensive gaps**: Missing null-checks on `NSCursor` returns, fragile cross-file imports via `include!`, and a stale `CURSOR_CLAIMED` flag if root handler skips a frame — none exploitable.
- **Bit-shift truncation in color helpers**: `hover_bg()` and `footer_surface_rgba()` silently discard high bits if accent values exceed 24-bit RGB; cosmetic-only, fixable with `debug_assert!`.

NEXT_SEED: `src/platform/path_actions.rs` — `NSPasteboard`/`NSWorkspace` FFI with manual `release` calls and clipboard data handling
---
- **`browser.rs` is dead code**: exists with GitHub search API logic but isn't declared in `mod.rs`, never compiled. The actual kit store UI in `render_builtins/kit_store.rs` duplicates git operations inline instead of using `git_ops.rs`.

- **Structs and functions lack field/error docs**: `KitManifest`, `InstalledKit`, `KitSearchResult` have no field-level `///` comments. All 8 public fallible functions missing `/// # Errors` sections. `git_ops.rs` uses `Result<_, String>` while siblings use `anyhow::Result`.

- **Filesystem path logic is inconsistent**: `discover.rs` hardcodes `dirs::home_dir().join(".scriptkit")`, `git_ops.rs` falls back to literal `"~"` (not shell-expanded), and `storage.rs` uses `get_kit_path()`. No canonical layout documented anywhere.

NEXT_SEED: `src/render_builtins/kit_store.rs` — duplicated git logic and architectural debt vs `kit_store/git_ops.rs`
---
- **Unbounded file reads and malformed JSON** can cause OOM/DoS or permanently brick frecency data; fix with file size caps (5 MiB), quarantine-and-reset on parse errors, and skip-deserializing the derived `score` field.
- **Symlink attacks and permission leaks** in the save path due to deterministic temp filenames and default permissions; fix with `tempfile::NamedTempFile` (O_EXCL) and 0o600 permissions, plus fsync before rename.
- **Unbounded growth and input quirks** from no entry count cap, no key validation, future timestamp pinning, and integer overflow in pruning; fix with MAX_ENTRIES/MAX_KEY_BYTES limits, timestamp clamping, and saturating arithmetic.

NEXT_SEED: Script execution pipeline — command injection, unsafe env var exposure, and filesystem permission assumptions in script launching and built-in command handling.
---
</previous-analyses>

Do NOT repeat items already covered above. Find something new.
## Feature Under Review

FEATURE: Platform cursor management that bypasses GPUI's built-in cursor system via direct NSCursor Objective-C calls, using a thread-local flag to coordinate pointer/arrow cursors across non-activating popup windows (NSPanel) where GPUI's own cursor styles don't apply.
FILES: src/platform/cursor.rs, src/platform/mod.rs, src/components/footer_button.rs, src/components/button/component.rs, src/components/prompt_footer.rs

## Analysis Category

security audit: scan for injection risks, authz gaps, secret leaks, unsafe deserialization, path traversal

## Instructions

1. Analyze the feature described above through the lens of: security audit
2. Be specific: reference actual file paths, function names, line ranges
3. Output a prioritized checklist of actionable improvements
4. For each item: severity (critical/major/minor), file path, concrete fix description
5. End with: NEXT_AREA: <suggest one unexplored area for future analysis>
