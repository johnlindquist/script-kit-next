<previous-analyses>
- **Critical safety docs needed**: Three files (`keystroke_logger.rs`, `text_injector.rs`, `keyword_manager/mod.rs`) lack safety/privacy documentation for sensitive operations — keystroke recording, synthetic input injection to focused apps, clipboard overwrites, and system-wide keyboard monitoring requiring Accessibility permissions.

- **14 major API/architecture gaps**: Public structs and functions across the text-expansion pipeline are undocumented — no `///` docs, no module-level `//!` architecture overviews, no `# Errors` sections, and no explanation of the dataflow (monitor → matcher → lookup → substitution → injector) or threading model.

- **Minor polish items**: Five items covering missing usage examples for keystroke logger, text injector, keyword matcher, and scriptlet formatting, plus one stale `// Public API for future use` comment that should be removed or converted to a stability note.

NEXT_SEED: `crate::keyboard_monitor` — event model, permission behavior, error types, and callback threading guarantees
---
I need to understand what "this analysis" refers to. Since there's no specific analysis document attached or referenced, I'll summarize the key analysis evident from the current project context (git status, architecture, and memory).

- Script Kit GPUI is a Rust+TypeScript rewrite with a bidirectional JSONL protocol, GPUI-based rendering, and a built-in command pipeline (`BuiltInFeature` enum → entry generation → execution → view rendering).

- The codebase enforces strict conventions: no `unwrap()` in production, no `part_*.rs` files, mandatory `cargo check && clippy && test` verification gate, and a pre-commit bot that reviews diffs with Claude Opus to reject resource leaks and dead code.

- Active work spans UI components (button, footer, dialog), platform cursor support, and AVFoundation camera capture using zero-copy Metal rendering via `CVPixelBuffer` surfaces instead of `RenderImage`.

NEXT_SEED: the bidirectional JSONL stdin/stdout protocol between bun scripts and the Rust app shell
---
I need to understand what "this analysis" refers to. Looking at the context, the most relevant analysis is the git status and recent work shown in the system prompt. Let me summarize:

- The codebase has active uncommitted changes across dialog actions, button components, footer/prompt UI, platform modules, and render implementation — plus several untracked files including cursor support and progress tests.
- Recent commits focus on emoji picker functionality: grid navigation, arrow key routing, spacer cells, non-dismissable behavior, and extracting scroll helpers — indicating an active UI feature buildout.
- The project follows strict conventions: mandatory verification gates (check/clippy/test), no unwrap in production, stdin JSON protocol for UI testing, and semantic module splitting instead of numbered part files.

NEXT_SEED: the untracked `src/platform/cursor.rs` module and its integration with the platform layer
---
</previous-analyses>

Do NOT repeat items already covered above. Find something new.
## Feature Under Review

FEATURE: Global hotkey registration and routing system that maps keyboard shortcuts to launcher, notes, AI, and script actions via a unified `HotkeyRoutes` table with transactional hot-reload support
FILES: src/hotkeys/mod.rs, src/shortcuts/mod.rs, src/config/mod.rs, src/main_entry/app_run_setup.rs

## Analysis Category

security audit: scan for injection risks, authz gaps, secret leaks, unsafe deserialization, path traversal

## Instructions

1. Analyze the feature described above through the lens of: security audit
2. Be specific: reference actual file paths, function names, line ranges
3. Output a prioritized checklist of actionable improvements
4. For each item: severity (critical/major/minor), file path, concrete fix description
5. End with: NEXT_AREA: <suggest one unexplored area for future analysis>
