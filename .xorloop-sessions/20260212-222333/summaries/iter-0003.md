- **Unbounded file reads and malformed JSON** can cause OOM/DoS or permanently brick frecency data; fix with file size caps (5 MiB), quarantine-and-reset on parse errors, and skip-deserializing the derived `score` field.
- **Symlink attacks and permission leaks** in the save path due to deterministic temp filenames and default permissions; fix with `tempfile::NamedTempFile` (O_EXCL) and 0o600 permissions, plus fsync before rename.
- **Unbounded growth and input quirks** from no entry count cap, no key validation, future timestamp pinning, and integer overflow in pruning; fix with MAX_ENTRIES/MAX_KEY_BYTES limits, timestamp clamping, and saturating arithmetic.

NEXT_SEED: Script execution pipeline â€” command injection, unsafe env var exposure, and filesystem permission assumptions in script launching and built-in command handling.
