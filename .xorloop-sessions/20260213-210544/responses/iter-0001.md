Oracle responded with a complete 4-task swarm plan. Here's the summary:

---

## SWARM TASK LIST — Key Handler Preamble DRY Extraction

### Task 1: `core-helper`

**Scope:** `src/render_prompts/arg/helpers.rs`

**Task:**
Add a shared `handle_actions_routing` helper next to the existing `key_preamble`/`check_sdk_action_shortcut` helpers. This centralizes the duplicated actions routing sequence: `route_key_to_actions_dialog` + `ActionsRoute` handling + SDK shortcut matching, with configurable "swallow vs let-through" behavior and optional `cx.stop_propagation()` (needed by Div). New types: `ActionsPreambleResult` (NotHandled/Handled/HandledButLetThrough), `SdkShortcutMode` (Swallow/LetThrough), `ActionsRoutingConfig`, `ActionsRoutingHandlers<SdkGuard, OnDialogExecute, OnSdkShortcut>`. The method `handle_actions_routing` is `pub(crate)` on `ScriptListApp`, taking generic callbacks for guard/execute/shortcut handlers.

### Task 2: `arg-form-migration`

**Scope:** `src/render_prompts/{arg,form}/render.rs`

**Task:**
Refactor arg and form key handlers to use the new `handle_actions_routing` helper. These two are nearly identical — both use `SdkShortcutMode::Swallow`, `stop_propagation_on_handled: false`, and simple `trigger_action_by_name` callbacks. Also fix the `unwrap()` in arg's `has_actions` computation.

### Task 3: `div-migration`

**Scope:** `src/render_prompts/div.rs`

**Task:**
Refactor div's key handler to use `handle_actions_routing` with `stop_propagation_on_handled: true` and `SdkShortcutMode::Swallow`. Keep the Cmd+K toggle branch with its explicit `cx.stop_propagation()`. Remove redundant stop_propagation calls from the old routing branches.

### Task 4: `editor-term-migration`

**Scope:** `src/render_prompts/{editor.rs,term.rs}`

**Task:**
Migrate editor and term to use `handle_actions_routing` with `SdkShortcutMode::LetThrough`. Editor uses `sdk_guard` to call `editor_reserved_shortcut_reason` and block SDK shortcuts for reserved bindings. Term preserves its custom Cmd+K=clear / Cmd+Shift+K=toggle semantics and its multi-step execute dispatch chain (toggle action → trigger_action_by_name → execute_term_prompt_action_by_id).

---

**NEXT_AREA:** `render_actions_backdrop` call pattern — each prompt type also duplicates a ~15-line `.when_some(render_actions_backdrop(..., ActionsBackdropConfig { ... }, cx), |d, backdrop| d.child(backdrop))` block with only the backdrop_id and close_host varying.
